---
title: Lit and VSCode Extensions
description: >
  Learn how to build a VSCode extension using a Lit web component, covering
  setup, template creation, component implementation, and extension activation.
date: '2025-01-20 02:41:17.941Z'
draft: false
tags:
  - Web Components
  - Lit
  - VSCode
  - HTML
  - Javascript
summary: >-
  Create a VSCode extension using Lit web components with Vite, TypeScript, and
  a pre-configured build process.
embedding: >-
  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
related:
  - lit-monaco-editor.md
  - codemirror-dynamic-theme.md
  - figma-and-lit.md
  - lit-rich-text-editor.md
  - html-code-sandbox.md
---

In this article I will go over how to set up a [Lit](https://lit.dev/) web component and use it to create a VSCode extension.

> **TLDR** You can find the final source [here](https://github.com/rodydavis/lit-vscode-extension).

Prerequisites 
--------------

*   Vscode
*   Node >= 16
*   Typescript

Getting Started 
----------------

We can start off by navigating in terminal to the location of the project and run the following:

```markdown
npm init @vitejs/app --template lit-ts
```

Then enter a project name `lit-vscode-extension` and now open the project in vscode and install the dependencies:

```markdown
cd lit-vscode-extension
npm i -D @types/node
code .
```

Update the `vite.config.ts` with the following:

```javascript
import { defineConfig } from "vite";
import { resolve } from "path";

export default defineConfig({
  base: "/lit-vscode-extension/",
  build: {
    outDir: "build",
    rollupOptions: {
      external: /^vscode/,
      input: {
        main: resolve(__dirname, "index.html"),
      },
      output: {
        entryFileNames: "[name].js",
      },
    },
  },
});
```

Open `package.json` and update it with the following:

```javascript
{
  "name": "lit-vscode-extension",
  "description": "Lit VSCode Extension Example",
  "version": "0.0.1",
  "publisher": "rodydavis",
  "private": true,
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/rodydavis/lit-vscode-extension"
  },
  "engines": {
    "vscode": "^1.47.0"
  },
  "categories": [
    "Other"
  ],
  "activationEvents": [
    "onCommand:lit.start",
    "onCommand:lit.reset",
    "onWebviewPanel:lit"
  ],
  "main": "./build/extension.js",
  "contributes": {
    "commands": [
      {
        "command": "lit.start",
        "title": "Open Plugin",
        "category": "lit"
      },
      {
        "command": "lit.reset",
        "title": "Reset",
        "category": "lit"
      }
    ]
  },
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "ext": "tsc src/extension.ts --outdir build --skipLibCheck --module commonjs",
    "compile": "npm run build && npm run ext",
    "serve": "vite preview"
  },
  "dependencies": {
    "lit": "^2.0.0-rc.2"
  },
  "devDependencies": {
    "@types/node": "^15.12.4",
    "@types/vscode": "^1.57.0",
    "typescript": "^4.2.3",
    "vite": "^2.3.5"
  }
}
```

After the `package.json` is updated run `npm i`.

Template 
---------

Open up the `index.html` and update it with the following:

```markup
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/src/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lit Example</title>
    <script type="module" src="/src/my-element.ts"></script>
  </head>
  <body>
    <my-element>
      <p>This is child content</p>
    </my-element>
  </body>
</html>

```

Web Component 
--------------

Open up `src/my-element.ts` and update it with the following:

```javascript
import { html, css, LitElement } from "lit";
import { customElement, property, state } from "lit/decorators.js";

@customElement("my-element")
export class MyElement extends LitElement {
  static styles = css`
    :host {
      display: block;
      border: solid 1px gray;
      padding: 16px;
      max-width: 800px;
    }
  `;

  @property() name = "World";
  @state() count = 0;

  render() {
    return html`
      <h1>Hello, ${this.name}!</h1>
      <button @click=${() => this.modify(1)} part="button">
        Click Count: ${this.count}
      </button>
      <slot></slot>
    `;
  }

  modify(val: number) {
    this.count += val;
  }

  reset() {
    this.count = 0;
  }

  async firstUpdated() {
    window.addEventListener(
      "message",
      (e: any) => {
        const message = e.data;
        const { command } = message;
        if (command === "reset") {
          this.reset();
        }
      },
      false
    );
  }
}

```

Here we are just modifying the example to include a message listener for communicating with the vscode extension, methods for updating the count, and updating the render method.

VSCode communicates with the plugin via post messages because the UI will be loaded in an `iframe`.

Now let's write the extension code in `src/extension.ts`. First start by adding top level declarations that will be referenced multiple times.

```javascript
import * as vscode from "vscode";

const WEB_DIR: string = "build";
const WEB_SCRIPT: string = "main.js";
const TITLE: string = "Lit Example";
const TAG: string = "my-element";


const possible = [
  "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
  "abcdefghijklmnopqrstuvwxyz",
  "0123456789",
].join("");

function getNonce() {
  let text = "";
  for (let i = 0; i < 32; i++) {
    const char = possible.charAt(Math.floor(Math.random() * possible.length));
    text += char;
  }
  return text;
}

```

We also are creating a `getNonce` method that will be used for making sure the scripts we load are the ones we passed in.

Now create a `Panel` that will contain the ui for our plugin:

```javascript
class Panel {
  public static currentPanel: Panel | undefined;
  public static readonly viewType = "litExample";
  private _disposables: vscode.Disposable[] = [];

  public static createOrShow(extensionUri: vscode.Uri) {
    const column = vscode.window.activeTextEditor
      ? vscode.window.activeTextEditor.viewColumn
      : undefined;
    if (Panel.currentPanel) {
      Panel.currentPanel.panel.reveal(column);
      return;
    }
    const panel = vscode.window.createWebviewPanel(
      Panel.viewType,
      TITLE,
      column || vscode.ViewColumn.One,
      getWebviewOptions(extensionUri)
    );
    Panel.currentPanel = new Panel(panel, extensionUri);
  }

  public static revive(panel: vscode.WebviewPanel, extensionUri: vscode.Uri) {
    Panel.currentPanel = new Panel(panel, extensionUri);
  }

  private constructor(
    public readonly panel: vscode.WebviewPanel,
    public readonly extensionUri: vscode.Uri
  ) {
    this._update();
    this.panel.onDidDispose(() => this.dispose(), null, this._disposables);
    this.panel.onDidChangeViewState(
      (_) => {
        if (this.panel.visible) {
          this._update();
        }
      },
      null,
      this._disposables
    );
    this.panel.webview.onDidReceiveMessage(
      (message) => {
        switch (message.command) {
          case "alert":
            vscode.window.showErrorMessage(message.text);
            return;
        }
      },
      null,
      this._disposables
    );
  }

  public sendMessage(command: string) {
    this.panel.webview.postMessage({ command: command });
  }

  public dispose() {
    Panel.currentPanel = undefined;
    this.panel.dispose();
    while (this._disposables.length) {
      const x = this._disposables.pop();
      if (x) {
        x.dispose();
      }
    }
  }

  private _update() {
    const webview = this.panel.webview;
    webview.html = this._getHtmlForWebview(webview);
  }

  private _getHtmlForWebview(webview: vscode.Webview) {
    const scriptPathOnDisk = vscode.Uri.joinPath(
      this.extensionUri,
      WEB_DIR,
      WEB_SCRIPT
    );
    const scriptUri = webview.asWebviewUri(scriptPathOnDisk);
    const nonce = getNonce();

    const slot = "<p>This is child content</p>";

    return `<!DOCTYPE html>
			<html lang="en">
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>${TITLE}</title>
        </head>
        <body class="vscode-light">
          <${TAG} nonce="${nonce}" >
            ${slot}
          </${TAG}>
          <script nonce="${nonce}" type="module" src="${scriptUri}"></script>
        </body>
			</html>`;
  }
}

```

> Notice how we are recreating the html and not using the `index.html`. This allows us to use the component for a deployed website but also the extension with separate app logic code.

Everything else is just boilerplate for managing the panel state and disposing when it is finished.

Now we can add the methods for loading our plugin and listening for the commands:

```javascript
export function activate(context: vscode.ExtensionContext) {
  context.subscriptions.push(
    vscode.commands.registerCommand("lit.start", () => {
      Panel.createOrShow(context.extensionUri);
    })
  );

  context.subscriptions.push(
    vscode.commands.registerCommand("lit.reset", () => {
      if (Panel.currentPanel) {
        Panel.currentPanel.sendMessage("reset");
      }
    })
  );

  if (vscode.window.registerWebviewPanelSerializer) {
    vscode.window.registerWebviewPanelSerializer(Panel.viewType, {
      async deserializeWebviewPanel(
        webviewPanel: vscode.WebviewPanel,
        state: any
      ) {
        console.log(`Received state: ${state}`);
        webviewPanel.webview.options = getWebviewOptions(context.extensionUri);
        Panel.revive(webviewPanel, context.extensionUri);
      },
    });
  }
}

function getWebviewOptions(extensionUri: vscode.Uri): vscode.WebviewOptions {
  return {
    enableScripts: true,
    localResourceRoots: [vscode.Uri.joinPath(extensionUri, WEB_DIR)],
  };
}

```

Here we are loading the extension and passing messages when the `lit.reset` command. We are also returning the `getWebviewOptions` options which `enableScripts` is set to `true` so we can run the injected js.

The final code should look like the follow:

```javascript
import * as vscode from "vscode";

const WEB_DIR: string = "build";
const WEB_SCRIPT: string = "main.js";
const TITLE: string = "Lit Example";
const TAG: string = "my-element";

export function activate(context: vscode.ExtensionContext) {
  context.subscriptions.push(
    vscode.commands.registerCommand("lit.start", () => {
      Panel.createOrShow(context.extensionUri);
    })
  );

  context.subscriptions.push(
    vscode.commands.registerCommand("lit.reset", () => {
      if (Panel.currentPanel) {
        Panel.currentPanel.sendMessage("reset");
      }
    })
  );

  if (vscode.window.registerWebviewPanelSerializer) {
    vscode.window.registerWebviewPanelSerializer(Panel.viewType, {
      async deserializeWebviewPanel(
        webviewPanel: vscode.WebviewPanel,
        state: any
      ) {
        console.log(`Received state: ${state}`);
        webviewPanel.webview.options = getWebviewOptions(context.extensionUri);
        Panel.revive(webviewPanel, context.extensionUri);
      },
    });
  }
}

function getWebviewOptions(extensionUri: vscode.Uri): vscode.WebviewOptions {
  return {
    enableScripts: true,
    localResourceRoots: [vscode.Uri.joinPath(extensionUri, WEB_DIR)],
  };
}

class Panel {
  public static currentPanel: Panel | undefined;
  public static readonly viewType = "litExample";
  private _disposables: vscode.Disposable[] = [];

  public static createOrShow(extensionUri: vscode.Uri) {
    const column = vscode.window.activeTextEditor
      ? vscode.window.activeTextEditor.viewColumn
      : undefined;
    if (Panel.currentPanel) {
      Panel.currentPanel.panel.reveal(column);
      return;
    }
    const panel = vscode.window.createWebviewPanel(
      Panel.viewType,
      TITLE,
      column || vscode.ViewColumn.One,
      getWebviewOptions(extensionUri)
    );
    Panel.currentPanel = new Panel(panel, extensionUri);
  }

  public static revive(panel: vscode.WebviewPanel, extensionUri: vscode.Uri) {
    Panel.currentPanel = new Panel(panel, extensionUri);
  }

  private constructor(
    public readonly panel: vscode.WebviewPanel,
    public readonly extensionUri: vscode.Uri
  ) {
    this._update();
    this.panel.onDidDispose(() => this.dispose(), null, this._disposables);
    this.panel.onDidChangeViewState(
      (_) => {
        if (this.panel.visible) {
          this._update();
        }
      },
      null,
      this._disposables
    );
    this.panel.webview.onDidReceiveMessage(
      (message) => {
        switch (message.command) {
          case "alert":
            vscode.window.showErrorMessage(message.text);
            return;
        }
      },
      null,
      this._disposables
    );
  }

  public sendMessage(command: string) {
    this.panel.webview.postMessage({ command: command });
  }

  public dispose() {
    Panel.currentPanel = undefined;
    this.panel.dispose();
    while (this._disposables.length) {
      const x = this._disposables.pop();
      if (x) {
        x.dispose();
      }
    }
  }

  private _update() {
    const webview = this.panel.webview;
    webview.html = this._getHtmlForWebview(webview);
  }

  private _getHtmlForWebview(webview: vscode.Webview) {
    const scriptPathOnDisk = vscode.Uri.joinPath(
      this.extensionUri,
      WEB_DIR,
      WEB_SCRIPT
    );
    const scriptUri = webview.asWebviewUri(scriptPathOnDisk);
    const nonce = getNonce();

    const slot = "<p>This is child content</p>";

    const htmlSource = `
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>${TITLE}</title>
      </head>
      <body class="vscode-light">
        <${TAG} nonce="${nonce}" >
          ${slot}
        </${TAG}>
        <script nonce="${nonce}" type="module" src="${scriptUri}"></script>
      </body>
    </html>`;

    return htmlSource;
  }
}

const possible = [
  "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
  "abcdefghijklmnopqrstuvwxyz",
  "0123456789",
].join("");

function getNonce() {
  let text = "";
  for (let i = 0; i < 32; i++) {
    const char = possible.charAt(Math.floor(Math.random() * possible.length));
    text += char;
  }
  return text;
}

```

Running 
--------

Make sure to install the dependencies by running `npm i`.

To build the extension run `npm run compile`.

To open the extension and debug hit `F5`.

![](../../assets/v_1_lcs00w2hlu.webp)

To run the commands to open the extension run `lit: open plugin` or `lit: reset`:

![](../../assets/v_2_g5d9uzk1if.webp)

To debug the extension when it is open run `Developer: Open Webview Developer Tools` from the command pallet.

![](../../assets/v_3_djp3kxusi7.webp)

Conclusion 
-----------

If you want to learn more about building a vscode extension you can read more [here](https://code.visualstudio.com/api) and for Lit you can read the docs [here](https://lit.dev/).
