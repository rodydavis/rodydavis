<!DOCTYPE html>
<html lang="en" class="astro-MDYSN4OI">
  <head>
    <!-- Global Metadata --><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<meta name="generator" content="Astro v2.0.4">

<!-- Canonical URL -->
<link rel="canonical" href="https://rodydavis.com/posts/static-site-file-based-routing/">

<!-- Primary Meta Tags -->
<title>File Based Routing for Static Sites</title>
<meta name="title" content="File Based Routing for Static Sites">
<meta name="description">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://rodydavis.com/posts/static-site-file-based-routing/">
<meta property="og:title" content="File Based Routing for Static Sites">
<meta property="og:description">
<meta property="og:image" content="https://rodydavis.com/placeholder-social.jpg">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://rodydavis.com/posts/static-site-file-based-routing/">
<meta property="twitter:title" content="File Based Routing for Static Sites">
<meta property="twitter:description">
<meta property="twitter:image" content="https://rodydavis.com/placeholder-social.jpg">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JQNPVBL9DR"></script>

    
  <link rel="stylesheet" href="/_astro/_...slug_.a5420181.css" />
<link rel="stylesheet" href="/_astro/_...slug_.55121d5d.css" /><script type="module">window.dataLayer=window.dataLayer||[];function a(){dataLayer.push(arguments)}a("js",new Date);a("config","G-JQNPVBL9DR");
</script></head>

  <body class="markdown-body astro-MDYSN4OI">
    <header class="astro-3EF6KSR2">
  <h2 class="astro-3EF6KSR2">
    <a href="/" class="astro-3EF6KSR2">Rody Davis</a>
  </h2>
  <nav class="astro-3EF6KSR2">
    <a href="/search?tags=app" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> Apps</div>
</a><a href="/search?tags=posts" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> Blog</div>
</a><a href="/talks" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> Talks</div>
</a><a href="/about" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> About</div>
</a>
  </nav>
</header>
    <main class="astro-MDYSN4OI">
      <style>astro-island,astro-slot{display:contents}</style><script>(self.Astro=self.Astro||{}).idle=t=>{const e=async()=>{await(await t())()};"requestIdleCallback"in window?window.requestIdleCallback(e):setTimeout(e,200)},window.dispatchEvent(new Event("astro:idle"));var l;{const c={0:t=>t,1:t=>JSON.parse(t,o),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(JSON.parse(t,o)),5:t=>new Set(JSON.parse(t,o)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(JSON.parse(t)),9:t=>new Uint16Array(JSON.parse(t)),10:t=>new Uint32Array(JSON.parse(t))},o=(t,s)=>{if(t===""||!Array.isArray(s))return s;const[e,n]=s;return e in c?c[e](n):void 0};customElements.get("astro-island")||customElements.define("astro-island",(l=class extends HTMLElement{constructor(){super(...arguments);this.hydrate=()=>{if(!this.hydrator||this.parentElement&&this.parentElement.closest("astro-island[ssr]"))return;const s=this.querySelectorAll("astro-slot"),e={},n=this.querySelectorAll("template[data-astro-template]");for(const r of n){const i=r.closest(this.tagName);!i||!i.isSameNode(this)||(e[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(const r of s){const i=r.closest(this.tagName);!i||!i.isSameNode(this)||(e[r.getAttribute("name")||"default"]=r.innerHTML)}const a=this.hasAttribute("props")?JSON.parse(this.getAttribute("props"),o):{};this.hydrator(this)(this.Component,a,e,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),window.removeEventListener("astro:hydrate",this.hydrate),window.dispatchEvent(new CustomEvent("astro:hydrate"))}}connectedCallback(){!this.hasAttribute("await-children")||this.firstChild?this.childrenConnectedCallback():new MutationObserver((s,e)=>{e.disconnect(),this.childrenConnectedCallback()}).observe(this,{childList:!0})}async childrenConnectedCallback(){window.addEventListener("astro:hydrate",this.hydrate);let s=this.getAttribute("before-hydration-url");s&&await import(s),this.start()}start(){const s=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(Astro[e]===void 0){window.addEventListener(`astro:${e}`,()=>this.start(),{once:!0});return}Astro[e](async()=>{const n=this.getAttribute("renderer-url"),[a,{default:r}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),i=this.getAttribute("component-export")||"default";if(!i.includes("."))this.Component=a[i];else{this.Component=a;for(const d of i.split("."))this.Component=this.Component[d]}return this.hydrator=r,this.hydrate},s,this)}attributeChangedCallback(){this.hydrator&&this.hydrate()}},l.observedAttributes=["props"],l))}</script><main class="astro-BVZIHDZO">
    <article class="astro-BVZIHDZO">
      <!-- {
        image !== undefined && (
          <img width={720} height={360} src={image} alt="" />
        )
      } -->
      <h1 class="title astro-BVZIHDZO">File Based Routing for Static Sites</h1>
      <time class="astro-BVZIHDZO">September 28, 2022</time>
      
      <div class="tags astro-BVZIHDZO">
        <astro-island uid="Z13Ahbp" component-url="/_astro/TagChip.aa70bafd.js" component-export="default" renderer-url="/_astro/client.15ddb572.js" props="{&quot;tag&quot;:[0,&quot;posts&quot;],&quot;active&quot;:[0,false],&quot;onClick&quot;:[0,null],&quot;class&quot;:[0,&quot;astro-BVZIHDZO&quot;]}" ssr="" client="idle" opts="{&quot;name&quot;:&quot;TagChip&quot;,&quot;value&quot;:true}" await-children=""><div style="padding: 0.25rem 0.5rem; border-radius: 0.25rem; background-color: var(--tag-background); color: var(--tag-color); cursor: pointer; white-space: nowrap; display: flex; flex-direction: row; align-items: center; gap: 0.25rem;">posts</div></astro-island><astro-island uid="iexiM" component-url="/_astro/TagChip.aa70bafd.js" component-export="default" renderer-url="/_astro/client.15ddb572.js" props="{&quot;tag&quot;:[0,&quot;static-site&quot;],&quot;active&quot;:[0,false],&quot;onClick&quot;:[0,null],&quot;class&quot;:[0,&quot;astro-BVZIHDZO&quot;]}" ssr="" client="idle" opts="{&quot;name&quot;:&quot;TagChip&quot;,&quot;value&quot;:true}" await-children=""><div style="padding: 0.25rem 0.5rem; border-radius: 0.25rem; background-color: var(--tag-background); color: var(--tag-color); cursor: pointer; white-space: nowrap; display: flex; flex-direction: row; align-items: center; gap: 0.25rem;">static-site</div></astro-island><astro-island uid="ZAAKMN" component-url="/_astro/TagChip.aa70bafd.js" component-export="default" renderer-url="/_astro/client.15ddb572.js" props="{&quot;tag&quot;:[0,&quot;file-based-routing&quot;],&quot;active&quot;:[0,false],&quot;onClick&quot;:[0,null],&quot;class&quot;:[0,&quot;astro-BVZIHDZO&quot;]}" ssr="" client="idle" opts="{&quot;name&quot;:&quot;TagChip&quot;,&quot;value&quot;:true}" await-children=""><div style="padding: 0.25rem 0.5rem; border-radius: 0.25rem; background-color: var(--tag-background); color: var(--tag-color); cursor: pointer; white-space: nowrap; display: flex; flex-direction: row; align-items: center; gap: 0.25rem;">file-based-routing</div></astro-island><astro-island uid="24gBXR" component-url="/_astro/TagChip.aa70bafd.js" component-export="default" renderer-url="/_astro/client.15ddb572.js" props="{&quot;tag&quot;:[0,&quot;multi-page-application&quot;],&quot;active&quot;:[0,false],&quot;onClick&quot;:[0,null],&quot;class&quot;:[0,&quot;astro-BVZIHDZO&quot;]}" ssr="" client="idle" opts="{&quot;name&quot;:&quot;TagChip&quot;,&quot;value&quot;:true}" await-children=""><div style="padding: 0.25rem 0.5rem; border-radius: 0.25rem; background-color: var(--tag-background); color: var(--tag-color); cursor: pointer; white-space: nowrap; display: flex; flex-direction: row; align-items: center; gap: 0.25rem;">multi-page-application</div></astro-island><astro-island uid="ZdX9iC" component-url="/_astro/TagChip.aa70bafd.js" component-export="default" renderer-url="/_astro/client.15ddb572.js" props="{&quot;tag&quot;:[0,&quot;web&quot;],&quot;active&quot;:[0,false],&quot;onClick&quot;:[0,null],&quot;class&quot;:[0,&quot;astro-BVZIHDZO&quot;]}" ssr="" client="idle" opts="{&quot;name&quot;:&quot;TagChip&quot;,&quot;value&quot;:true}" await-children=""><div style="padding: 0.25rem 0.5rem; border-radius: 0.25rem; background-color: var(--tag-background); color: var(--tag-color); cursor: pointer; white-space: nowrap; display: flex; flex-direction: row; align-items: center; gap: 0.25rem;">web</div></astro-island><astro-island uid="ZyACRo" component-url="/_astro/TagChip.aa70bafd.js" component-export="default" renderer-url="/_astro/client.15ddb572.js" props="{&quot;tag&quot;:[0,&quot;css&quot;],&quot;active&quot;:[0,false],&quot;onClick&quot;:[0,null],&quot;class&quot;:[0,&quot;astro-BVZIHDZO&quot;]}" ssr="" client="idle" opts="{&quot;name&quot;:&quot;TagChip&quot;,&quot;value&quot;:true}" await-children=""><div style="padding: 0.25rem 0.5rem; border-radius: 0.25rem; background-color: var(--tag-background); color: var(--tag-color); cursor: pointer; white-space: nowrap; display: flex; flex-direction: row; align-items: center; gap: 0.25rem;">css</div></astro-island>
      </div>
      <div class="headings astro-BVZIHDZO">
            <details class="astro-XVRFUPWN">
  <summary class="astro-XVRFUPWN">Table of Contents</summary>
  <ul class="astro-XVRFUPWN">
    <li class="astro-XVRFUPWN">
          <a href="#" class="heading-depth-2 astro-XVRFUPWN">
            Step 1
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-1" class="heading-depth-2 astro-XVRFUPWN">
            Step 2
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-2" class="heading-depth-2 astro-XVRFUPWN">
            Step 3
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-3" class="heading-depth-2 astro-XVRFUPWN">
            Step 4
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#srcbuildts" class="heading-depth-3 astro-XVRFUPWN">
            src/build.ts
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#srccompilets" class="heading-depth-3 astro-XVRFUPWN">
            src/compile.ts
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#srcstaticts" class="heading-depth-3 astro-XVRFUPWN">
            src/static.ts
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#srcmaints" class="heading-depth-3 astro-XVRFUPWN">
            src/main.ts
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-4" class="heading-depth-2 astro-XVRFUPWN">
            Step 5
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-5" class="heading-depth-2 astro-XVRFUPWN">
            Step 6
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#exampleindexmd" class="heading-depth-3 astro-XVRFUPWN">
            example/index.md
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#examplestylecss" class="heading-depth-3 astro-XVRFUPWN">
            example/style.css
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#examplelayouthtml" class="heading-depth-3 astro-XVRFUPWN">
            example/layout.html
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-6" class="heading-depth-2 astro-XVRFUPWN">
            Step 7
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-7" class="heading-depth-2 astro-XVRFUPWN">
            Conclusion
          </a>
        </li>
  </ul>
</details>
          </div>
      <p>In this article I will go over how to use file based routing to output as a static site multi page application.</p>
<blockquote>
<p><strong>TLDR</strong> The final source <a href="https://github.com/rodydavis/static-site-file-based-routing">here</a> and an online <a href="https://rodydavis.github.io/static-site-file-based-routing/">demo</a>.</p>
</blockquote>
<h2 id=""><a aria-hidden="true" tabindex="-1" href="#"><span class="icon icon-link"></span></a>Step 1</h2>
<p>Create a new folder called “static-site-file-based-routing” and open it up in VSCode.</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">mkdir static-site-file-based-routing</span></span>
<span class="line"><span style="color: #79C0FF">cd</span><span style="color: #C9D1D9"> static-site-file-based-routing</span></span>
<span class="line"><span style="color: #C9D1D9">code </span><span style="color: #79C0FF">.</span></span></code></pre>
<h2 id="-1"><a aria-hidden="true" tabindex="-1" href="#-1"><span class="icon icon-link"></span></a>Step 2</h2>
<p>Create a <code>tsconfig.json</code> and replace it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">{</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">"compilerOptions"</span><span style="color: #C9D1D9">: {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"incremental"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"target"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"es5"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"module"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"es2020"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"outDir"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"dist"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"strict"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"moduleResolution"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"node"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"esModuleInterop"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"skipLibCheck"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"forceConsistentCasingInFileNames"</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"typeRoots"</span><span style="color: #C9D1D9">: [</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #A5D6FF">"node_modules/@types"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #A5D6FF">"src/@types"</span></span>
<span class="line"><span style="color: #C9D1D9">    ]</span></span>
<span class="line"><span style="color: #C9D1D9">  },</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">"include"</span><span style="color: #C9D1D9">: [</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #A5D6FF">"src/**/*"</span></span>
<span class="line"><span style="color: #C9D1D9">  ],</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">"exclude"</span><span style="color: #C9D1D9">: [</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #A5D6FF">"node_modules"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #A5D6FF">"dist"</span></span>
<span class="line"><span style="color: #C9D1D9">  ]</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<h2 id="-2"><a aria-hidden="true" tabindex="-1" href="#-2"><span class="icon icon-link"></span></a>Step 3</h2>
<p>Create a <code>package.json</code> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">{</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">"name"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"static-site-file-based-routing"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">"version"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"1.0.0"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">"description"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"File based routing for HTML MPA"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">"type"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"module"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">"scripts"</span><span style="color: #C9D1D9">: {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"start"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"wds --node-resolve --root-dir build --base-path /static-site-file-based-routing --open --watch"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"postinstall"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"npm run tsc"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"build"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"node dist/main.js --inputDir ./example --outputDir ./build"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"dev"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"node dist/main.js --inputDir ./example --outputDir ./build -w"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"tsc"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"tsc"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"tsc:watch"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"tsc -w"</span></span>
<span class="line"><span style="color: #C9D1D9">  },</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">"devDependencies"</span><span style="color: #C9D1D9">: {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"@pkgjs/parseargs"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"^0.10.0"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"@types/markdown-it"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"^12.2.3"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"@types/node"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"^18.7.23"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"@web/dev-server"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"^0.1.34"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"chokidar"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"^3.5.3"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"highlight.js"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"^11.6.0"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"html-format"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"^1.0.2"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"markdown-it"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"^13.0.1"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"parse5"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"^7.1.1"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"typescript"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"^4.8.4"</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>Then run <code>npm install</code> to install all the dependencies.</p>
<blockquote>
<p>Note: I am using <code>@web/dev-server</code> to serve the site locally. You can use any server you want.</p>
</blockquote>
<p>These dependencies are used for various file transformations such as markdown to HTML, HTML formatting, and file watching.</p>
<h2 id="-3"><a aria-hidden="true" tabindex="-1" href="#-3"><span class="icon icon-link"></span></a>Step 4</h2>
<p>Create a <code>src</code> folder and add 4 files:</p>
<h3 id="srcbuildts"><a aria-hidden="true" tabindex="-1" href="#srcbuildts"><span class="icon icon-link"></span></a><code>src/build.ts</code></h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> fs </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"fs"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> { compileDir, compileTarget } </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"./compile.js"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> path </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"path"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> chokidar </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"chokidar"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> { publicDirectory } </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"./static.js"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">interface</span><span style="color: #C9D1D9"> </span><span style="color: #FFA657">Options</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FFA657">inputDir</span><span style="color: #FF7B72">?:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FFA657">outputDir</span><span style="color: #FF7B72">?:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FFA657">publicDir</span><span style="color: #FF7B72">?:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FFA657">watch</span><span style="color: #FF7B72">?:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">boolean</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FFA657">clean</span><span style="color: #FF7B72">?:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">boolean</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">export</span><span style="color: #FFA657"> </span><span style="color: #FF7B72">default</span><span style="color: #FFA657"> </span><span style="color: #FF7B72">async</span><span style="color: #FFA657"> </span><span style="color: #FF7B72">function</span><span style="color: #FFA657"> </span><span style="color: #D2A8FF">build</span><span style="color: #FFA657">(options</span><span style="color: #FF7B72">:</span><span style="color: #FFA657"> Options) </span><span style="color: #C9D1D9">{</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">inputDir</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> options.inputDir </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"www"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">outputDir</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> options.outputDir </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"build"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">publicDir</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> options.publicDir </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"public"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">watch</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> options.watch </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">clean</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> options.clean </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(inputDir)) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">throw</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">Error</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">`Input directory ${</span><span style="color: #C9D1D9">inputDir</span><span style="color: #A5D6FF">} does not exist`</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (clean) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(outputDir)) {</span></span>
<span class="line"><span style="color: #C9D1D9">            fs.</span><span style="color: #D2A8FF">rmdirSync</span><span style="color: #C9D1D9">(outputDir, { recursive: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9"> });</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(outputDir)) {</span></span>
<span class="line"><span style="color: #C9D1D9">        fs.</span><span style="color: #D2A8FF">mkdirSync</span><span style="color: #C9D1D9">(outputDir, { recursive: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9"> });</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (watch) {</span></span>
<span class="line"><span style="color: #C9D1D9">        console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Watching for changes..."</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        chokidar.</span><span style="color: #D2A8FF">watch</span><span style="color: #C9D1D9">(inputDir).</span><span style="color: #D2A8FF">on</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"all"</span><span style="color: #C9D1D9">, </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">event</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">inputFile</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">            console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(event, inputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(inputFile)) {</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">relativePath</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">relative</span><span style="color: #C9D1D9">(inputDir, inputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">outputFile</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">`${</span><span style="color: #C9D1D9">outputDir</span><span style="color: #A5D6FF">}/${</span><span style="color: #C9D1D9">relativePath</span><span style="color: #A5D6FF">}`</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">stat</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fs.</span><span style="color: #D2A8FF">statSync</span><span style="color: #C9D1D9">(inputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (stat.</span><span style="color: #D2A8FF">isDirectory</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">                    </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compileDir</span><span style="color: #C9D1D9">(inputFile, outputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">                } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (stat.</span><span style="color: #D2A8FF">isFile</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">                    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">filename</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">basename</span><span style="color: #C9D1D9">(inputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">                    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (filename </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"layout.html"</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #8B949E">// Rebuild all related directories</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">dir</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">dirname</span><span style="color: #C9D1D9">(inputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">inDir</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">relative</span><span style="color: #C9D1D9">(inputDir, dir);</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">outDir</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">`${</span><span style="color: #C9D1D9">outputDir</span><span style="color: #A5D6FF">}/${</span><span style="color: #C9D1D9">inDir</span><span style="color: #A5D6FF">}`</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compileDir</span><span style="color: #C9D1D9">(dir, outDir);</span></span>
<span class="line"><span style="color: #C9D1D9">                    } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compileTarget</span><span style="color: #C9D1D9">(inputFile, outputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">                    }</span></span>
<span class="line"><span style="color: #C9D1D9">                }</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"><span style="color: #C9D1D9">        });</span></span>
<span class="line"><span style="color: #C9D1D9">    } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compileDir</span><span style="color: #C9D1D9">(inputDir, outputDir);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (publicDir.</span><span style="color: #D2A8FF">split</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">','</span><span style="color: #C9D1D9">).</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">dir</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">of</span><span style="color: #C9D1D9"> publicDir.</span><span style="color: #D2A8FF">split</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">','</span><span style="color: #C9D1D9">)) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">publicDirectory</span><span style="color: #C9D1D9">(dir, outputDir, watch);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">publicDirectory</span><span style="color: #C9D1D9">(publicDir, outputDir, watch);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span></code></pre>
<h3 id="srccompilets"><a aria-hidden="true" tabindex="-1" href="#srccompilets"><span class="icon icon-link"></span></a><code>src/compile.ts</code></h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> fs </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"fs"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> path </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"path"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> MarkdownIt </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"markdown-it"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> hljs </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"highlight.js"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> parse5 </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"parse5"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">type</span><span style="color: #C9D1D9"> { Document } </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"parse5/dist/tree-adapters/default.js"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> format </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'html-format'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compile</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">file</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">raw</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fs.</span><span style="color: #D2A8FF">readFileSync</span><span style="color: #C9D1D9">(file, </span><span style="color: #A5D6FF">"utf-8"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ext</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">extname</span><span style="color: #C9D1D9">(file);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">switch</span><span style="color: #C9D1D9"> (ext) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">case</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">".md"</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">case</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">".markdown"</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">md</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">MarkdownIt</span><span style="color: #C9D1D9">({</span></span>
<span class="line"><span style="color: #C9D1D9">                html: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">                linkify: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">                typographer: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #D2A8FF">highlight</span><span style="color: #C9D1D9">: </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">str</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">lang</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (lang </span><span style="color: #FF7B72">&#x26;&#x26;</span><span style="color: #C9D1D9"> hljs.</span><span style="color: #D2A8FF">getLanguage</span><span style="color: #C9D1D9">(lang)) {</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #FF7B72">try</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">                            </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> (</span></span>
<span class="line"><span style="color: #C9D1D9">                                </span><span style="color: #A5D6FF">'&#x3C;pre class="hljs">&#x3C;code>'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">+</span></span>
<span class="line"><span style="color: #C9D1D9">                                hljs.</span><span style="color: #D2A8FF">highlight</span><span style="color: #C9D1D9">(str, { language: lang, ignoreIllegals: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9"> })</span></span>
<span class="line"><span style="color: #C9D1D9">                                    .value </span><span style="color: #FF7B72">+</span></span>
<span class="line"><span style="color: #C9D1D9">                                </span><span style="color: #A5D6FF">"&#x3C;/code>&#x3C;/pre>"</span></span>
<span class="line"><span style="color: #C9D1D9">                            );</span></span>
<span class="line"><span style="color: #C9D1D9">                        } </span><span style="color: #FF7B72">catch</span><span style="color: #C9D1D9"> (__) {</span></span>
<span class="line"><span style="color: #C9D1D9">                            console.</span><span style="color: #D2A8FF">error</span><span style="color: #C9D1D9">(__);</span></span>
<span class="line"><span style="color: #C9D1D9">                        }</span></span>
<span class="line"><span style="color: #C9D1D9">                    }</span></span>
<span class="line"><span style="color: #C9D1D9">                    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">                },</span></span>
<span class="line"><span style="color: #C9D1D9">            });</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> parse5.</span><span style="color: #D2A8FF">parse</span><span style="color: #C9D1D9">(md.</span><span style="color: #D2A8FF">render</span><span style="color: #C9D1D9">(raw));</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">case</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">".html"</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> parse5.</span><span style="color: #D2A8FF">parse</span><span style="color: #C9D1D9">(raw);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">default</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">break</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> raw;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">createHtml</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">options</span><span style="color: #FF7B72">?:</span><span style="color: #C9D1D9"> { </span><span style="color: #FFA657">head</span><span style="color: #FF7B72">?:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">; </span><span style="color: #FFA657">body</span><span style="color: #FF7B72">?:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">; }) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">`</span></span>
<span class="line"><span style="color: #A5D6FF">&#x3C;!DOCTYPE html></span></span>
<span class="line"><span style="color: #A5D6FF">&#x3C;html lang="en"></span></span>
<span class="line"><span style="color: #A5D6FF">&#x3C;head></span></span>
<span class="line"><span style="color: #A5D6FF">${</span><span style="color: #C9D1D9">options</span><span style="color: #A5D6FF">?.</span><span style="color: #C9D1D9">head</span><span style="color: #A5D6FF"> </span><span style="color: #FF7B72">??</span><span style="color: #A5D6FF"> </span><span style="color: #A5D6FF">""}</span></span>
<span class="line"><span style="color: #A5D6FF">&#x3C;/head></span></span>
<span class="line"><span style="color: #A5D6FF">&#x3C;body></span></span>
<span class="line"><span style="color: #A5D6FF">${</span><span style="color: #C9D1D9">options</span><span style="color: #A5D6FF">?.</span><span style="color: #C9D1D9">body</span><span style="color: #A5D6FF"> </span><span style="color: #FF7B72">??</span><span style="color: #A5D6FF"> </span><span style="color: #A5D6FF">"&#x3C;slot>&#x3C;/slot>"}</span></span>
<span class="line"><span style="color: #A5D6FF">&#x3C;/body></span></span>
<span class="line"><span style="color: #A5D6FF">&#x3C;/html></span></span>
<span class="line"><span style="color: #A5D6FF">`</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">export</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compileFile</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">file</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">target</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Use regex to check if ends with index.*</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">isIndex</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #A5D6FF"> /index</span><span style="color: #7EE787; font-style: italic">\.</span><span style="color: #A5D6FF">(</span><span style="color: #79C0FF">[a-z]</span><span style="color: #FF7B72">+</span><span style="color: #A5D6FF">)</span><span style="color: #FF7B72">$</span><span style="color: #A5D6FF">/</span><span style="color: #FF7B72">i</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">test</span><span style="color: #C9D1D9">(file);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">isIndex </span><span style="color: #FF7B72">&#x26;&#x26;</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">fs.</span><span style="color: #D2A8FF">statSync</span><span style="color: #C9D1D9">(file).</span><span style="color: #D2A8FF">isDirectory</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">// Skipping for nested layouts</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">parent</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">dirname</span><span style="color: #C9D1D9">(target);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Render up the directory tree until we hit the root directory</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">files</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">[] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> [file];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">let</span><span style="color: #C9D1D9"> filePath </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> file;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">while</span><span style="color: #C9D1D9"> (filePath </span><span style="color: #FF7B72">!==</span><span style="color: #C9D1D9"> parent) {</span></span>
<span class="line"><span style="color: #C9D1D9">        filePath </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">dirname</span><span style="color: #C9D1D9">(filePath);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">// Check for root level layout</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">layout</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">join</span><span style="color: #C9D1D9">(filePath, </span><span style="color: #A5D6FF">"layout.html"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(layout)) {</span></span>
<span class="line"><span style="color: #C9D1D9">            files.</span><span style="color: #D2A8FF">unshift</span><span style="color: #C9D1D9">(layout);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (filePath </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"."</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">break</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Check for root level index markdown or html</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">layout</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">join</span><span style="color: #C9D1D9">(parent, </span><span style="color: #A5D6FF">"layout.html"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(layout)) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span></span>
<span class="line"><span style="color: #C9D1D9">            fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(path.</span><span style="color: #D2A8FF">join</span><span style="color: #C9D1D9">(parent, </span><span style="color: #A5D6FF">"index.html"</span><span style="color: #C9D1D9">)) </span><span style="color: #FF7B72">||</span></span>
<span class="line"><span style="color: #C9D1D9">            fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(path.</span><span style="color: #D2A8FF">join</span><span style="color: #C9D1D9">(parent, </span><span style="color: #A5D6FF">"index.md"</span><span style="color: #C9D1D9">)) </span><span style="color: #FF7B72">||</span></span>
<span class="line"><span style="color: #C9D1D9">            fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(path.</span><span style="color: #D2A8FF">join</span><span style="color: #C9D1D9">(parent, </span><span style="color: #A5D6FF">"index.markdown"</span><span style="color: #C9D1D9">))</span></span>
<span class="line"><span style="color: #C9D1D9">        ) {</span></span>
<span class="line"><span style="color: #C9D1D9">            files.</span><span style="color: #D2A8FF">unshift</span><span style="color: #C9D1D9">(layout);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">let</span><span style="color: #C9D1D9"> output </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">createHtml</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">item</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">of</span><span style="color: #C9D1D9"> files) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">doc</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compile</span><span style="color: #C9D1D9">(item);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">typeof</span><span style="color: #C9D1D9"> doc </span><span style="color: #FF7B72">!==</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'string'</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">content</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> parse5.</span><span style="color: #D2A8FF">serialize</span><span style="color: #C9D1D9">(doc);</span></span>
<span class="line"><span style="color: #C9D1D9">            output </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">mergeDocuments</span><span style="color: #C9D1D9">(output, content);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Replace extension</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ext</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">extname</span><span style="color: #C9D1D9">(file);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">newFile</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> target.</span><span style="color: #D2A8FF">replace</span><span style="color: #C9D1D9">(ext, </span><span style="color: #A5D6FF">'.html'</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Check if parent directory exists</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">parentDir</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">dirname</span><span style="color: #C9D1D9">(newFile);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(parentDir)) {</span></span>
<span class="line"><span style="color: #C9D1D9">        fs.</span><span style="color: #D2A8FF">mkdirSync</span><span style="color: #C9D1D9">(parentDir, { recursive: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9"> });</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    fs.</span><span style="color: #D2A8FF">writeFileSync</span><span style="color: #C9D1D9">(newFile, output);</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">`--> ${</span><span style="color: #C9D1D9">newFile</span><span style="color: #A5D6FF">}`</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">mergeDocuments</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">current</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">source</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">let</span><span style="color: #C9D1D9"> raw </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> current;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Merge body</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">html</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">extractDoc</span><span style="color: #C9D1D9">(parse5.</span><span style="color: #D2A8FF">parse</span><span style="color: #C9D1D9">(source));</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Check for &#x3C;slot>&#x3C;/slot></span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">hasSlot</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">includes</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"&#x3C;slot>&#x3C;/slot>"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (hasSlot) {</span></span>
<span class="line"><span style="color: #C9D1D9">        raw </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">replace</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"&#x3C;slot>&#x3C;/slot>"</span><span style="color: #C9D1D9">, parse5.</span><span style="color: #D2A8FF">serialize</span><span style="color: #C9D1D9">(html.body));</span></span>
<span class="line"><span style="color: #C9D1D9">    } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">// Append to body</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">endBodyIdx</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">lastIndexOf</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"&#x3C;/body>"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">start</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">slice</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, endBodyIdx);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">end</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">slice</span><span style="color: #C9D1D9">(endBodyIdx);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">body</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> parse5.</span><span style="color: #D2A8FF">serialize</span><span style="color: #C9D1D9">(html.body);</span></span>
<span class="line"><span style="color: #C9D1D9">        raw </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> start </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> body </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> end;</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Merge head</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">endHeadIdx</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">lastIndexOf</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"&#x3C;/head>"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">start</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">slice</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">, endHeadIdx);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">end</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">slice</span><span style="color: #C9D1D9">(endHeadIdx);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">head</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> parse5.</span><span style="color: #D2A8FF">serialize</span><span style="color: #C9D1D9">(html.head);</span></span>
<span class="line"><span style="color: #C9D1D9">    raw </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> start </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> head </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> end;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Format</span></span>
<span class="line"><span style="color: #C9D1D9">    raw </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">format</span><span style="color: #C9D1D9">(raw);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Remove duplicate title tags</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">lastTitle</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">lastIndexOf</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"&#x3C;title>"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">lastTitleEnd</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">lastIndexOf</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"&#x3C;/title>"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">title</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">slice</span><span style="color: #C9D1D9">(lastTitle, lastTitleEnd </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">8</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    raw </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">replace</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">/&#x3C;title></span><span style="color: #79C0FF">.</span><span style="color: #FF7B72">*</span><span style="color: #A5D6FF">&#x3C;</span><span style="color: #7EE787; font-style: italic">\/</span><span style="color: #A5D6FF">title>/</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">""</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    raw </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> raw.</span><span style="color: #D2A8FF">replace</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"&#x3C;/head>"</span><span style="color: #C9D1D9">, title </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"&#x3C;/head>"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> raw;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">extractDoc</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">doc</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #FFA657">Document</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">html</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (doc.childNodes[</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">??</span><span style="color: #C9D1D9"> doc.childNodes[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">]) </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">unknown</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #FFA657">Document</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">head</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> html.childNodes.</span><span style="color: #D2A8FF">find</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        (</span><span style="color: #FFA657">node</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> node.nodeName </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"head"</span></span>
<span class="line"><span style="color: #C9D1D9">    ) </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">unknown</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #FFA657">Document</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">body</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> html.childNodes.</span><span style="color: #D2A8FF">find</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        (</span><span style="color: #FFA657">node</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> node.nodeName </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"body"</span></span>
<span class="line"><span style="color: #C9D1D9">    ) </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">unknown</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #FFA657">Document</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> { head, body };</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">export</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compileDir</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">inputDir</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">outputDir</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">files</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fs.</span><span style="color: #D2A8FF">readdirSync</span><span style="color: #C9D1D9">(inputDir);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">file</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">of</span><span style="color: #C9D1D9"> files) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">inputFile</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">`${</span><span style="color: #C9D1D9">inputDir</span><span style="color: #A5D6FF">}/${</span><span style="color: #C9D1D9">file</span><span style="color: #A5D6FF">}`</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">outputFile</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">`${</span><span style="color: #C9D1D9">outputDir</span><span style="color: #A5D6FF">}/${</span><span style="color: #C9D1D9">file</span><span style="color: #A5D6FF">}`</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compileTarget</span><span style="color: #C9D1D9">(inputFile, outputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">export</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compileTarget</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">input</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">output</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">stat</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fs.</span><span style="color: #D2A8FF">statSync</span><span style="color: #C9D1D9">(input);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (stat.</span><span style="color: #D2A8FF">isDirectory</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(output)) {</span></span>
<span class="line"><span style="color: #C9D1D9">            fs.</span><span style="color: #D2A8FF">mkdirSync</span><span style="color: #C9D1D9">(output, { recursive: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9"> });</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compileDir</span><span style="color: #C9D1D9">(input, output);</span></span>
<span class="line"><span style="color: #C9D1D9">    } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (stat.</span><span style="color: #D2A8FF">isFile</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ext</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">extname</span><span style="color: #C9D1D9">(input);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> ([</span><span style="color: #A5D6FF">'.html'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">'.md'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">'.markdown'</span><span style="color: #C9D1D9">].</span><span style="color: #D2A8FF">includes</span><span style="color: #C9D1D9">(ext)) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">compileFile</span><span style="color: #C9D1D9">(input, output);</span></span>
<span class="line"><span style="color: #C9D1D9">        } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">current</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fs.</span><span style="color: #D2A8FF">readFileSync</span><span style="color: #C9D1D9">(input);</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">parentDir</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">dirname</span><span style="color: #C9D1D9">(output);</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(parentDir)) {</span></span>
<span class="line"><span style="color: #C9D1D9">                fs.</span><span style="color: #D2A8FF">mkdirSync</span><span style="color: #C9D1D9">(parentDir, { recursive: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9"> });</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(output)) {</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #8B949E">// Check if content is the same</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">previous</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fs.</span><span style="color: #D2A8FF">readFileSync</span><span style="color: #C9D1D9">(output);</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (Buffer.</span><span style="color: #D2A8FF">compare</span><span style="color: #C9D1D9">(current, previous) </span><span style="color: #FF7B72">!==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">                    fs.</span><span style="color: #D2A8FF">writeFileSync</span><span style="color: #C9D1D9">(output, current);</span></span>
<span class="line"><span style="color: #C9D1D9">                }</span></span>
<span class="line"><span style="color: #C9D1D9">            } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #8B949E">// Copy the file</span></span>
<span class="line"><span style="color: #C9D1D9">                fs.</span><span style="color: #D2A8FF">copyFileSync</span><span style="color: #C9D1D9">(input, output);</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span></code></pre>
<h3 id="srcstaticts"><a aria-hidden="true" tabindex="-1" href="#srcstaticts"><span class="icon icon-link"></span></a><code>src/static.ts</code></h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> fs </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"fs"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> path </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"path"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> chokidar </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"chokidar"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">export</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">publicDirectory</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">publicDir</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">outputDir</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">watch</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">boolean</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (watch) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(publicDir)) {</span></span>
<span class="line"><span style="color: #C9D1D9">            chokidar.</span><span style="color: #D2A8FF">watch</span><span style="color: #C9D1D9">(publicDir).</span><span style="color: #D2A8FF">on</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"all"</span><span style="color: #C9D1D9">, (</span><span style="color: #FFA657">event</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">inputFile</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">                console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(event, inputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(inputFile)) {</span></span>
<span class="line"><span style="color: #C9D1D9">                    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">relativePath</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> path.</span><span style="color: #D2A8FF">relative</span><span style="color: #C9D1D9">(publicDir, inputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">                    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">outputFile</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">`${</span><span style="color: #C9D1D9">outputDir</span><span style="color: #A5D6FF">}/${</span><span style="color: #C9D1D9">relativePath</span><span style="color: #A5D6FF">}`</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">                    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">stat</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fs.</span><span style="color: #D2A8FF">statSync</span><span style="color: #C9D1D9">(inputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">                    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (stat.</span><span style="color: #D2A8FF">isDirectory</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">                        </span><span style="color: #D2A8FF">copyStaticFiles</span><span style="color: #C9D1D9">(inputFile, outputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">                    } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (stat.</span><span style="color: #D2A8FF">isFile</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">                        fs.</span><span style="color: #D2A8FF">copyFileSync</span><span style="color: #C9D1D9">(inputFile, outputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">                    }</span></span>
<span class="line"><span style="color: #C9D1D9">                }</span></span>
<span class="line"><span style="color: #C9D1D9">            });</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">// Copy static files</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(publicDir)) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">copyStaticFiles</span><span style="color: #C9D1D9">(publicDir, outputDir);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">copyStaticFiles</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">inDir</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">outDir</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">files</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fs.</span><span style="color: #D2A8FF">readdirSync</span><span style="color: #C9D1D9">(inDir);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">file</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">of</span><span style="color: #C9D1D9"> files) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">inputFile</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">`${</span><span style="color: #C9D1D9">inDir</span><span style="color: #A5D6FF">}/${</span><span style="color: #C9D1D9">file</span><span style="color: #A5D6FF">}`</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">outputFile</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">`${</span><span style="color: #C9D1D9">outDir</span><span style="color: #A5D6FF">}/${</span><span style="color: #C9D1D9">file</span><span style="color: #A5D6FF">}`</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">stat</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> fs.</span><span style="color: #D2A8FF">statSync</span><span style="color: #C9D1D9">(inputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (stat.</span><span style="color: #D2A8FF">isDirectory</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">fs.</span><span style="color: #D2A8FF">existsSync</span><span style="color: #C9D1D9">(outputFile)) {</span></span>
<span class="line"><span style="color: #C9D1D9">                fs.</span><span style="color: #D2A8FF">mkdirSync</span><span style="color: #C9D1D9">(outputFile, { recursive: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9"> });</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">copyStaticFiles</span><span style="color: #C9D1D9">(inputFile, outputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">        } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (stat.</span><span style="color: #D2A8FF">isFile</span><span style="color: #C9D1D9">()) {</span></span>
<span class="line"><span style="color: #C9D1D9">            fs.</span><span style="color: #D2A8FF">copyFileSync</span><span style="color: #C9D1D9">(inputFile, outputFile);</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span></code></pre>
<h3 id="srcmaints"><a aria-hidden="true" tabindex="-1" href="#srcmaints"><span class="icon icon-link"></span></a><code>src/main.ts</code></h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E">#!/usr/bin/env node</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// @ts-ignore</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> { parseArgs } </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"@pkgjs/parseargs"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> build </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"./build.js"</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">export</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">main</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FFA657">values</span><span style="color: #C9D1D9">: { </span><span style="color: #79C0FF">inputDir</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">outputDir</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">watch</span><span style="color: #C9D1D9"> },</span></span>
<span class="line"><span style="color: #C9D1D9">  } </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">parseArgs</span><span style="color: #C9D1D9">({</span></span>
<span class="line"><span style="color: #C9D1D9">    options: {</span></span>
<span class="line"><span style="color: #C9D1D9">      inputDir: {</span></span>
<span class="line"><span style="color: #C9D1D9">        type: </span><span style="color: #A5D6FF">"string"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        short: </span><span style="color: #A5D6FF">"i"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      },</span></span>
<span class="line"><span style="color: #C9D1D9">      outputDir: {</span></span>
<span class="line"><span style="color: #C9D1D9">        type: </span><span style="color: #A5D6FF">"string"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        short: </span><span style="color: #A5D6FF">"o"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      },</span></span>
<span class="line"><span style="color: #C9D1D9">      watch: {</span></span>
<span class="line"><span style="color: #C9D1D9">        type: </span><span style="color: #A5D6FF">"boolean"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        short: </span><span style="color: #A5D6FF">"w"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      },</span></span>
<span class="line"><span style="color: #C9D1D9">    },</span></span>
<span class="line"><span style="color: #C9D1D9">    allowPositional: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (inputDir </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">undefined</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> outputDir </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">undefined</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">"Usage: build -i &#x3C;inputDir> -o &#x3C;outputDir> [-w]"</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">build</span><span style="color: #C9D1D9">({</span></span>
<span class="line"><span style="color: #C9D1D9">    inputDir,</span></span>
<span class="line"><span style="color: #C9D1D9">    outputDir,</span></span>
<span class="line"><span style="color: #C9D1D9">    watch,</span></span>
<span class="line"><span style="color: #C9D1D9">  });</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D2A8FF">main</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span></code></pre>
<h2 id="-4"><a aria-hidden="true" tabindex="-1" href="#-4"><span class="icon icon-link"></span></a>Step 5</h2>
<p>Now that the project is setup we can start the typescript compiler in watch mode.</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">npm run ts:watch</span></span></code></pre>
<h2 id="-5"><a aria-hidden="true" tabindex="-1" href="#-5"><span class="icon icon-link"></span></a>Step 6</h2>
<p>Now create a folder that will contain the source files for the website.</p>
<h3 id="exampleindexmd"><a aria-hidden="true" tabindex="-1" href="#exampleindexmd"><span class="icon icon-link"></span></a><code>example/index.md</code></h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #79C0FF; font-style: italic"># Hello World</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">This is a test</span></span></code></pre>
<h3 id="examplestylecss"><a aria-hidden="true" tabindex="-1" href="#examplestylecss"><span class="icon icon-link"></span></a><code>example/style.css</code></h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #7EE787">body</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">background-color</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">#000</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">color</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">#fff</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<h3 id="examplelayouthtml"><a aria-hidden="true" tabindex="-1" href="#examplelayouthtml"><span class="icon icon-link"></span></a><code>example/layout.html</code></h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">&#x3C;!</span><span style="color: #7EE787">DOCTYPE</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">html</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">&#x3C;</span><span style="color: #7EE787">html</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">lang</span><span style="color: #C9D1D9">=</span><span style="color: #A5D6FF">"en"</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">&#x3C;</span><span style="color: #7EE787">head</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">    &#x3C;</span><span style="color: #7EE787">meta</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">charset</span><span style="color: #C9D1D9">=</span><span style="color: #A5D6FF">"UTF-8"</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">    &#x3C;</span><span style="color: #7EE787">meta</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">http-equiv</span><span style="color: #C9D1D9">=</span><span style="color: #A5D6FF">"X-UA-Compatible"</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">content</span><span style="color: #C9D1D9">=</span><span style="color: #A5D6FF">"IE=edge"</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">    &#x3C;</span><span style="color: #7EE787">meta</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">name</span><span style="color: #C9D1D9">=</span><span style="color: #A5D6FF">"viewport"</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">content</span><span style="color: #C9D1D9">=</span><span style="color: #A5D6FF">"width=device-width, initial-scale=1.0"</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">    &#x3C;</span><span style="color: #7EE787">title</span><span style="color: #C9D1D9">>Example&#x3C;/</span><span style="color: #7EE787">title</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">    &#x3C;</span><span style="color: #7EE787">link</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">rel</span><span style="color: #C9D1D9">=</span><span style="color: #A5D6FF">"stylesheet"</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">href</span><span style="color: #C9D1D9">=</span><span style="color: #A5D6FF">"style.css"</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">&#x3C;/</span><span style="color: #7EE787">head</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">&#x3C;</span><span style="color: #7EE787">body</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">    &#x3C;</span><span style="color: #7EE787">slot</span><span style="color: #C9D1D9">>&#x3C;/</span><span style="color: #7EE787">slot</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">&#x3C;/</span><span style="color: #7EE787">body</span><span style="color: #C9D1D9">></span></span>
<span class="line"><span style="color: #C9D1D9">&#x3C;/</span><span style="color: #7EE787">html</span><span style="color: #C9D1D9">></span></span></code></pre>
<h2 id="-6"><a aria-hidden="true" tabindex="-1" href="#-6"><span class="icon icon-link"></span></a>Step 7</h2>
<p>With the source files created we can now run the build script.</p>
<p>For a one time build run:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">npm run build</span></span></code></pre>
<p>For a watch mode run:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">npm run dev</span></span></code></pre>
<p>Now start the http server:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">npm run start</span></span></code></pre>
<h2 id="-7"><a aria-hidden="true" tabindex="-1" href="#-7"><span class="icon icon-link"></span></a>Conclusion</h2>
<p>As you make changes it will only update affected files and be very fast to update.</p>
<blockquote>
<p>Note that this does not bundle the javascript and will be up to you if you are using <code>node_modules</code> in any files (for the example in the repo I show how to use <strong>UNPKG</strong>).</p>
</blockquote>
<p>If you want to find the source code you can check it out <a href="https://github.com/rodydavis/static-site-file-based-routing">here</a> otherwise thanks for reading and let me know if you have any questions!</p>
    </article>
  </main>
    </main>
    <footer class="astro-SZ7XMLTE">
  <div class="links astro-AUSHCPD5">
  <a class="social-icon astro-AUSHCPD5" href="https://github.com/rodydavis" target="_blank" rel="noopener">
            <img src="/social/github.svg" alt="github" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://twitter.com/rodydavis" target="_blank" rel="noopener">
            <img src="/social/twitter.svg" alt="twitter" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://facebook.com/rodydavisjr" target="_blank" rel="noopener">
            <img src="/social/facebook.svg" alt="facebook" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://instagram.com/rodydavisjr" target="_blank" rel="noopener">
            <img src="/social/instagram.svg" alt="instagram" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://youtube.com/rodydavis" target="_blank" rel="noopener">
            <img src="/social/youtube.svg" alt="youtube" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://tiktok.com/@rodydavisjr" target="_blank" rel="noopener">
            <img src="/social/tiktok.svg" alt="tiktok" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://linkedin.com/in/rodydavis" target="_blank" rel="noopener">
            <img src="/social/linkedin.svg" alt="linkedin" class="astro-AUSHCPD5">
          </a>
</div>

  <div class="copyright astro-SZ7XMLTE">
    &copy; 2023
    Rody Davis. All rights reserved.
  </div>
</footer>
  </body></html>