<!DOCTYPE html>
<html lang="en" class="astro-MDYSN4OI">
  <head>
    <!-- Global Metadata --><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<meta name="generator" content="Astro v2.0.4">

<!-- Canonical URL -->
<link rel="canonical" href="https://rodydavis.com/posts/host-flutter-rest-api/">

<!-- Primary Meta Tags -->
<title>Host your Flutter Project as a REST API</title>
<meta name="title" content="Host your Flutter Project as a REST API">
<meta name="description">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://rodydavis.com/posts/host-flutter-rest-api/">
<meta property="og:title" content="Host your Flutter Project as a REST API">
<meta property="og:description">
<meta property="og:image" content="https://rodydavis.com/placeholder-social.jpg">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://rodydavis.com/posts/host-flutter-rest-api/">
<meta property="twitter:title" content="Host your Flutter Project as a REST API">
<meta property="twitter:description">
<meta property="twitter:image" content="https://rodydavis.com/placeholder-social.jpg">
    
  <link rel="stylesheet" href="/_astro/_...slug_.b1abaa8d.css" />
<link rel="stylesheet" href="/_astro/_...slug_.7a06253d.css" /></head>

  <body class="markdown-body astro-MDYSN4OI">
    <header class="astro-3EF6KSR2">
  <h2 class="astro-3EF6KSR2">
    <a href="/" class="astro-3EF6KSR2">Rody Davis</a>
  </h2>
  <nav class="astro-3EF6KSR2">
    <a href="/search?tags=app" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> Apps</div>
</a><a href="/search?tags=posts" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> Blog</div>
</a><a href="/talks" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> Talks</div>
</a><a href="/about" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> About</div>
</a>
  </nav>
</header>
    <main class="astro-MDYSN4OI">
      <style>
	@media (min-width: 860px) {
		main {
			display: flex;
			flex-direction: row;
			justify-content: space-between;
		}
		article {
			flex: 1;
		}
		aside {
			display: block;
			position: sticky;
			top: 0;
			right: 0;
			max-height: 100vh;
			overflow-y: auto;
		}
	}
	</style><main class="astro-BVZIHDZO">
    <article class="astro-BVZIHDZO">
      
      <h1 class="title astro-BVZIHDZO">Host your Flutter Project as a REST API</h1>
      
      
      <hr class="astro-BVZIHDZO">
      <p>After you build your flutter project you may want to reuse the models and business logic from your lib folder. I will show you how to go about setting up the project to have iOS, Android, Web, Windows, MacOS, Linux and a REST API interface with one project. The REST API can also be deploy to Google Cloud Run for Dart everywhere.</p>
<p><img src="/attachments/gifs_mind_blown.gif" alt=""></p>
<blockquote>
<p>One Codebase for Client and Sever.</p>
</blockquote>
<p>This will allow you to expose your Dart models as a REST API and run your business logic from your lib folder while the application runs the models as they are. <a href="https://github.com/rodydavis/shared_dart">Here</a> is the final project.</p>
<h2 id=""><a aria-hidden="true" tabindex="-1" href="#"><span class="icon icon-link"></span></a>Setting Up</h2>
<p>As with any Flutter project I am going to assume that you already have <a href="https://flutter.dev/">Flutter</a> installed on your machine and that you can create a project. This is a intermediate level difficulty so read on if you are up to the challenge. You will also need to know the basics of <a href="https://www.docker.com/">Docker</a>.</p>
<h2 id="-1"><a aria-hidden="true" tabindex="-1" href="#-1"><span class="icon icon-link"></span></a>Why one project?</h2>
<p>It may not be obvious but when building complex applications you will at some point have a server and an application that calls that server. <a href="https://firebase.google.com/">Firebase</a> is an excellent option for doing this and I use it in almost all my projects. <a href="https://firebase.google.com/products/functions/">Firebase Functions</a> are really powerful but you are limited by Javascript or Typescript. What if you could use the same packages that you are using in the Flutter project, or better yet what if they both used the same?</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*1xVIzjzgJnmuWTJoaG3kAQ.gif" alt=""></p>
<p>When you have a server project and a client project that communicate over a rest api or client sdk like Firebase then you will run into the problem that the server has models of objects stored and the client has models of the objects that are stored. This can lead to a serious mismatch when it changed without you knowing. GraphQL helps a lot with this since you define the model that you recieve. This approach allows your business logic to be always up to date for both the client and server.</p>
<h2 id="-2"><a aria-hidden="true" tabindex="-1" href="#-2"><span class="icon icon-link"></span></a>Client Setup</h2>
<p>The first step is to just build your application. The only difference that we will make is keeping the UI and business logic separate. When starting out with Flutter it can be very easy to throw all the logic into the screen and calling setState when the data changes. Even the application when creating a new Flutter project does this. That’s why <a href="https://flutter.dev/docs/development/data-and-backend/state-mgmt/options">choosing a state management solution </a>is so important.</p>
<p>To make things clean and concise we will make 2 folders in our lib folder.</p>
<ul>
<li>
<p>ui for all Flutter Widgets and Screens</p>
</li>
<li>
<p>src for all business logic, classes, models and utility functions</p>
</li>
</ul>
<p>This will leave us with main.dart being only the entry point into our client application.</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:flutter/material.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'plugins/desktop/desktop.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'ui/home/screen.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">main</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">runApp</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">MyApp</span><span style="color: #C9D1D9">());</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">MyApp</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">extends</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">StatelessWidget</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Widget</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">build</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">BuildContext</span><span style="color: #C9D1D9"> context) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">MaterialApp</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">      title</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'Flutter Demo'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      theme</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ThemeData</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">light</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">      darkTheme</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ThemeData</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">dark</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">      home</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">HomeScreen</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">    );</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>Let’s Start by making a tab bar for the 2 screens. Create a file in the folder ui/home/screen.dart and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:flutter/material.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'../counter/screen.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'../todo/screen.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">HomeScreen</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">extends</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">StatefulWidget</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">_HomeScreenState</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">createState</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">_HomeScreenState</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">_HomeScreenState</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">extends</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">State</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">HomeScreen</span><span style="color: #C9D1D9">> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">int</span><span style="color: #C9D1D9"> _currentIndex </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Widget</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">build</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">BuildContext</span><span style="color: #C9D1D9"> context) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Scaffold</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">      body</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">IndexedStack</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        index</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> _currentIndex,</span></span>
<span class="line"><span style="color: #C9D1D9">        children</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #79C0FF">Widget</span><span style="color: #FF7B72">></span><span style="color: #C9D1D9">[</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #79C0FF">CounterScreen</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #79C0FF">TodosScreen</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">        ],</span></span>
<span class="line"><span style="color: #C9D1D9">      ),</span></span>
<span class="line"><span style="color: #C9D1D9">      bottomNavigationBar</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">BottomNavigationBar</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        currentIndex</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> _currentIndex,</span></span>
<span class="line"><span style="color: #C9D1D9">        onTap</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> (val) {</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (mounted)</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #D2A8FF">setState</span><span style="color: #C9D1D9">(() {</span></span>
<span class="line"><span style="color: #C9D1D9">              _currentIndex </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> val;</span></span>
<span class="line"><span style="color: #C9D1D9">            });</span></span>
<span class="line"><span style="color: #C9D1D9">        },</span></span>
<span class="line"><span style="color: #C9D1D9">        type</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">BottomNavigationBarType</span><span style="color: #C9D1D9">.fixed,</span></span>
<span class="line"><span style="color: #C9D1D9">        items</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> [</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #79C0FF">BottomNavigationBarItem</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">            icon</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Icon</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Icons</span><span style="color: #C9D1D9">.add),</span></span>
<span class="line"><span style="color: #C9D1D9">            title</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Text</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Counter'</span><span style="color: #C9D1D9">),</span></span>
<span class="line"><span style="color: #C9D1D9">          ),</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #79C0FF">BottomNavigationBarItem</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">            icon</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Icon</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Icons</span><span style="color: #C9D1D9">.list),</span></span>
<span class="line"><span style="color: #C9D1D9">            title</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Text</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Todos'</span><span style="color: #C9D1D9">),</span></span>
<span class="line"><span style="color: #C9D1D9">          ),</span></span>
<span class="line"><span style="color: #C9D1D9">        ],</span></span>
<span class="line"><span style="color: #C9D1D9">      ),</span></span>
<span class="line"><span style="color: #C9D1D9">    );</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>This is just a basic screen and should look very normal.</p>
<h3 id="-3"><a aria-hidden="true" tabindex="-1" href="#-3"><span class="icon icon-link"></span></a>Counter Example</h3>
<p><img src="https://cdn-images-1.medium.com/max/2336/1*qFZepZBtk0RhEojjGsI85g.png" alt=""></p>
<p>Now create a file ui/counter/screen.dart and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:flutter/material.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:shared_dart/src/models/counter.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">CounterScreen</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">extends</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">StatefulWidget</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">_CounterScreenState</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">createState</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">_CounterScreenState</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">_CounterScreenState</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">extends</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">State</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">CounterScreen</span><span style="color: #C9D1D9">> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">CounterModel</span><span style="color: #C9D1D9"> _counterModel </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">CounterModel</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">_incrementCounter</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">setState</span><span style="color: #C9D1D9">(() {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #8B949E">// This call to setState tells the Flutter framework that something has</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #8B949E">// changed in this State, which causes it to rerun the build method below</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #8B949E">// so that the display can reflect the updated values. If we changed</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #8B949E">// _counter without calling setState(), then the build method would not be</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #8B949E">// called again, and so nothing would appear to happen.</span></span>
<span class="line"><span style="color: #C9D1D9">      _counterModel.</span><span style="color: #D2A8FF">add</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    });</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Widget</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">build</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">BuildContext</span><span style="color: #C9D1D9"> context) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// This method is rerun every time setState is called, for instance as done</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// by the _incrementCounter method above.</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">//</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// The Flutter framework has been optimized to make rerunning build methods</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// fast, so that you can just rebuild anything that needs updating rather</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// than having to individually change instances of widgets.</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Scaffold</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">      appBar</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">AppBar</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">// Here we take the value from the MyCounterPage object that was created by</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">// the App.build method, and use it to set our appbar title.</span></span>
<span class="line"><span style="color: #C9D1D9">        title</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Text</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Counter Screen'</span><span style="color: #C9D1D9">),</span></span>
<span class="line"><span style="color: #C9D1D9">      ),</span></span>
<span class="line"><span style="color: #C9D1D9">      body</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Center</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">// Center is a layout widget. It takes a single child and positions it</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">// in the middle of the parent.</span></span>
<span class="line"><span style="color: #C9D1D9">        child</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Column</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// Column is also a layout widget. It takes a list of children and</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// arranges them vertically. By default, it sizes itself to fit its</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// children horizontally, and tries to be as tall as its parent.</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">//</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// Invoke "debug painting" (press "p" in the console, choose the</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// "Toggle Debug Paint" action from the Flutter Inspector in Android</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// Studio, or the "Toggle Debug Paint" command in Visual Studio Code)</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// to see the wireframe for each widget.</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">//</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// Column has various properties to control how it sizes itself and</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// how it positions its children. Here we use mainAxisAlignment to</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// center the children vertically; the main axis here is the vertical</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// axis because Columns are vertical (the cross axis would be</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #8B949E">// horizontal).</span></span>
<span class="line"><span style="color: #C9D1D9">          mainAxisAlignment</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">MainAxisAlignment</span><span style="color: #C9D1D9">.center,</span></span>
<span class="line"><span style="color: #C9D1D9">          children</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #79C0FF">Widget</span><span style="color: #FF7B72">></span><span style="color: #C9D1D9">[</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #79C0FF">Text</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">              </span><span style="color: #A5D6FF">'You have pushed the button this many times:'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">            ),</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #79C0FF">Text</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">              </span><span style="color: #A5D6FF">'${</span><span style="color: #79C0FF">_counterModel</span><span style="color: #A5D6FF">.</span><span style="color: #79C0FF">count</span><span style="color: #A5D6FF">}'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">              style</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Theme</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">of</span><span style="color: #C9D1D9">(context).textTheme.display1,</span></span>
<span class="line"><span style="color: #C9D1D9">            ),</span></span>
<span class="line"><span style="color: #C9D1D9">          ],</span></span>
<span class="line"><span style="color: #C9D1D9">        ),</span></span>
<span class="line"><span style="color: #C9D1D9">      ),</span></span>
<span class="line"><span style="color: #C9D1D9">      floatingActionButton</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">FloatingActionButton</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        onPressed</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> _incrementCounter,</span></span>
<span class="line"><span style="color: #C9D1D9">        tooltip</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'Increment'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        child</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Icon</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Icons</span><span style="color: #C9D1D9">.add),</span></span>
<span class="line"><span style="color: #C9D1D9">      ), </span><span style="color: #8B949E">// This trailing comma makes auto-formatting nicer for build methods.</span></span>
<span class="line"><span style="color: #C9D1D9">    );</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>This is the default counter app you get when you create a Flutter application but with one change, it uses <code>CounterModel</code> to hold the logic.</p>
<p>Create the counter model at src/models/counter.dart and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">CounterModel</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">CounterModel</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">int</span><span style="color: #C9D1D9"> _count </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">int</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">get</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">count</span><span style="color: #C9D1D9"> => _count;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">add</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> _count</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">subtract</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> _count</span><span style="color: #FF7B72">--</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">set</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">int</span><span style="color: #C9D1D9"> val) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> _count </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> val;</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>As you can see it is really easy to expose only what we want to while still having complete flexibility. You could use provider here if you choose, or even bloc and/or streams.</p>
<h3 id="-4"><a aria-hidden="true" tabindex="-1" href="#-4"><span class="icon icon-link"></span></a>Todo Example</h3>
<p><img src="https://cdn-images-1.medium.com/max/2336/1*47x4TDkyWCo8-qMCfYaeng.png" alt=""></p>
<p>Lets create a file at ui/todos/screen.dart and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:flutter/material.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'../../src/classes/todo.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'../../src/models/todos.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">TodosScreen</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">extends</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">StatefulWidget</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">_TodosScreenState</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">createState</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">_TodosScreenState</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">_TodosScreenState</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">extends</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">State</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">TodosScreen</span><span style="color: #C9D1D9">> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _model </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">TodosModel</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">List</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">ToDo</span><span style="color: #C9D1D9">> _todos;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">initState</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    _model.</span><span style="color: #D2A8FF">getList</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">then</span><span style="color: #C9D1D9">((val) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (mounted)</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">setState</span><span style="color: #C9D1D9">(() {</span></span>
<span class="line"><span style="color: #C9D1D9">          _todos </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> val;</span></span>
<span class="line"><span style="color: #C9D1D9">        });</span></span>
<span class="line"><span style="color: #C9D1D9">    });</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">super</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">initState</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Widget</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">build</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">BuildContext</span><span style="color: #C9D1D9"> context) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Scaffold</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">      appBar</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">AppBar</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        title</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Text</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Todos Screen'</span><span style="color: #C9D1D9">),</span></span>
<span class="line"><span style="color: #C9D1D9">      ),</span></span>
<span class="line"><span style="color: #C9D1D9">      body</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Builder</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        builder</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> (_) {</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (_todos </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ListView</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">builder</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">              itemCount</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> _todos.length,</span></span>
<span class="line"><span style="color: #C9D1D9">              itemBuilder</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> (context, index) {</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _item </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> _todos[index];</span></span>
<span class="line"><span style="color: #C9D1D9">                </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ListTile</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">                  title</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Text</span><span style="color: #C9D1D9">(_item.title),</span></span>
<span class="line"><span style="color: #C9D1D9">                  subtitle</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Text</span><span style="color: #C9D1D9">(_item.completed </span><span style="color: #FF7B72">?</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'Completed'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'Pending'</span><span style="color: #C9D1D9">),</span></span>
<span class="line"><span style="color: #C9D1D9">                );</span></span>
<span class="line"><span style="color: #C9D1D9">              },</span></span>
<span class="line"><span style="color: #C9D1D9">            );</span></span>
<span class="line"><span style="color: #C9D1D9">          }</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Center</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">            child</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">CircularProgressIndicator</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">          );</span></span>
<span class="line"><span style="color: #C9D1D9">        },</span></span>
<span class="line"><span style="color: #C9D1D9">      ),</span></span>
<span class="line"><span style="color: #C9D1D9">    );</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>You will see that we have the logic in TodosModel and uses the class ToDo for toJson and fromJson.</p>
<p>Create a file at the location src/classes/todo.dart and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E">// To parse this JSON data, do</span></span>
<span class="line"><span style="color: #8B949E">//</span></span>
<span class="line"><span style="color: #8B949E">//     final toDo = toDoFromJson(jsonString);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dart:convert'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">List</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">ToDo</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">toDoFromJson</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9"> str) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">List</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">ToDo</span><span style="color: #C9D1D9">>.</span><span style="color: #D2A8FF">from</span><span style="color: #C9D1D9">(json.</span><span style="color: #D2A8FF">decode</span><span style="color: #C9D1D9">(str).</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">((x) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ToDo</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">fromJson</span><span style="color: #C9D1D9">(x)));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">String</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">toDoToJson</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">List</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">ToDo</span><span style="color: #C9D1D9">> data) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> json.</span><span style="color: #D2A8FF">encode</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">List</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">dynamic</span><span style="color: #C9D1D9">>.</span><span style="color: #D2A8FF">from</span><span style="color: #C9D1D9">(data.</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">((x) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> x.</span><span style="color: #D2A8FF">toJson</span><span style="color: #C9D1D9">())));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ToDo</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">int</span><span style="color: #C9D1D9"> userId;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">int</span><span style="color: #C9D1D9"> id;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9"> title;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> completed;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">ToDo</span><span style="color: #C9D1D9">({</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.userId,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.id,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.title,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.completed,</span></span>
<span class="line"><span style="color: #C9D1D9">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">factory</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ToDo</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">fromJson</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Map</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">dynamic</span><span style="color: #C9D1D9">> json) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ToDo</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        userId</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> json[</span><span style="color: #A5D6FF">"userId"</span><span style="color: #C9D1D9">],</span></span>
<span class="line"><span style="color: #C9D1D9">        id</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> json[</span><span style="color: #A5D6FF">"id"</span><span style="color: #C9D1D9">],</span></span>
<span class="line"><span style="color: #C9D1D9">        title</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> json[</span><span style="color: #A5D6FF">"title"</span><span style="color: #C9D1D9">],</span></span>
<span class="line"><span style="color: #C9D1D9">        completed</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> json[</span><span style="color: #A5D6FF">"completed"</span><span style="color: #C9D1D9">],</span></span>
<span class="line"><span style="color: #C9D1D9">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">Map</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">dynamic</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">toJson</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"userId"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> userId,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"id"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> id,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"title"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> title,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"completed"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> completed,</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>and create the model src/models/todo.dart and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dart:convert'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:http/http.dart'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> http;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:shared_dart/src/classes/todo.dart'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> t;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">TodosModel</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> kTodosUrl </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'[https://jsonplaceholder.typicode.com/todos'</span><span style="color: #C9D1D9">](https</span><span style="color: #FF7B72">:</span><span style="color: #8B949E">//jsonplaceholder.typicode.com/todos');</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">Future</span><span style="color: #FF7B72">&#x3C;</span><span style="color: #79C0FF">List</span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9">t.</span><span style="color: #79C0FF">ToDo</span><span style="color: #FF7B72">>></span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getList</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _response </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> http.</span><span style="color: #FF7B72">get</span><span style="color: #C9D1D9">(kTodosUrl);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (_response </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _todos </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> t.</span><span style="color: #D2A8FF">toDoFromJson</span><span style="color: #C9D1D9">(_response.body);</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (_todos </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> _todos;</span></span>
<span class="line"><span style="color: #C9D1D9">      }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> [];</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">Future</span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9">t.</span><span style="color: #79C0FF">ToDo</span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getItem</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">int</span><span style="color: #C9D1D9"> id) </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _response </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> http.</span><span style="color: #FF7B72">get</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'$</span><span style="color: #79C0FF">kTodosUrl</span><span style="color: #A5D6FF">/$</span><span style="color: #79C0FF">id</span><span style="color: #A5D6FF">'</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (_response </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _todo </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> t.</span><span style="color: #79C0FF">ToDo</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">fromJson</span><span style="color: #C9D1D9">(json.</span><span style="color: #D2A8FF">decode</span><span style="color: #C9D1D9">(_response.body));</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (_todo </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> _todo;</span></span>
<span class="line"><span style="color: #C9D1D9">      }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>Here we just get dummy data from a url that emits json and convert them to our classes. This is an example I want to show with networking. There is only one place that fetches the data.</p>
<h3 id="-5"><a aria-hidden="true" tabindex="-1" href="#-5"><span class="icon icon-link"></span></a>Run the Project (Web)</h3>
<p><img src="https://cdn-images-1.medium.com/max/5248/1*et2kG6_skauXJ6rogFy_ZQ.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/5248/1*za20ru3G18DUFob07Cjv2A.png" alt=""></p>
<p>As you can see when you run your project on chrome you will get the same application that you got on mobile. Even the networking is working in the web. You can call the model and retrieve the list just like you would expect.</p>
<h2 id="-6"><a aria-hidden="true" tabindex="-1" href="#-6"><span class="icon icon-link"></span></a>Server Setup</h2>
<blockquote>
<p>Now time for the magic..</p>
</blockquote>
<p>In the root of the project folder create a file Dockerfile and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E"># Use Google's official Dart image.</span></span>
<span class="line"><span style="color: #8B949E"># [https://hub.docker.com/r/google/dart-runtime/](https://hub.docker.com/r/google/dart-runtime/)</span></span>
<span class="line"><span style="color: #A5D6FF">FROM google/dart-runtime</span></span></code></pre>
<p>Create another file at the root called service.yaml and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #7EE787">apiVersion</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">serving.knative.dev/v1</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">kind</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">Service</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">metadata</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #7EE787">name</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">PROJECT_NAME</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #7EE787">namespace</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">default</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">spec</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #7EE787">template</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #7EE787">spec</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #7EE787">containers</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">            - </span><span style="color: #7EE787">image</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">docker.io/YOUR_DOCKER_NAME/PROJECT_NAME</span></span>
<span class="line"><span style="color: #C9D1D9">              </span><span style="color: #7EE787">env</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">                - </span><span style="color: #7EE787">name</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">TARGET</span></span>
<span class="line"><span style="color: #C9D1D9">                  </span><span style="color: #7EE787">value</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"PROJECT_NAME v1"</span></span></code></pre>
<p>Replace PROJECT_NAME with your project name, mine is shared-dart for this example.</p>
<p>You will also need to replace YOUR_DOCKER_NAME with your docker username so the container can be deployed correctly.</p>
<p>Update your pubspec.yaml with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #7EE787">name</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">shared_dart</span></span>
<span class="line"><span style="color: #7EE787">description</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">A new Flutter project.</span></span>
<span class="line"><span style="color: #7EE787">publish_to</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">none</span></span>
<span class="line"><span style="color: #7EE787">version</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">1.0.0+1</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7EE787">environment</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">sdk</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">">=2.1.0 &#x3C;3.0.0"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7EE787">dependencies</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">flutter</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">sdk</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">flutter</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">shelf</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^0.7.3</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">cupertino_icons</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^0.1.2</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">http</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^0.12.0+2</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7EE787">dev_dependencies</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">flutter_test</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">sdk</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">flutter</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7EE787">flutter</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">uses-material-design</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">true</span></span></code></pre>
<p>The important package here is shelf as it allows us to run a http server with dart.</p>
<p>Create a folder in the root of the project called bin then add a file server.dart and replace it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dart:io'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:shelf/shelf.dart'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> shelf;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:shelf/shelf_io.dart'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> io;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'src/routing.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">main</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> handler </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> shelf.</span><span style="color: #79C0FF">Pipeline</span><span style="color: #C9D1D9">()</span></span>
<span class="line"><span style="color: #C9D1D9">      .</span><span style="color: #D2A8FF">addMiddleware</span><span style="color: #C9D1D9">(shelf.</span><span style="color: #D2A8FF">logRequests</span><span style="color: #C9D1D9">())</span></span>
<span class="line"><span style="color: #C9D1D9">      .</span><span style="color: #D2A8FF">addHandler</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">RouteUtils</span><span style="color: #C9D1D9">.handler);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> port </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">int</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">tryParse</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Platform</span><span style="color: #C9D1D9">.environment[</span><span style="color: #A5D6FF">'PORT'</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">??</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'8080'</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> address </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">InternetAddress</span><span style="color: #C9D1D9">.anyIPv4;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">io.</span><span style="color: #D2A8FF">serve</span><span style="color: #C9D1D9">(handler, address, port).</span><span style="color: #D2A8FF">then</span><span style="color: #C9D1D9">((server) {</span></span>
<span class="line"><span style="color: #C9D1D9">    server.autoCompress </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">print</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Serving at [http://${</span><span style="color: #79C0FF">server</span><span style="color: #A5D6FF">.</span><span style="color: #79C0FF">address</span><span style="color: #A5D6FF">.</span><span style="color: #79C0FF">host</span><span style="color: #A5D6FF">}:${</span><span style="color: #79C0FF">server</span><span style="color: #A5D6FF">.</span><span style="color: #79C0FF">port</span><span style="color: #A5D6FF">}'</span><span style="color: #C9D1D9">](http</span><span style="color: #FF7B72">:</span><span style="color: #8B949E">//${server.address.host}:${server.port}'));</span></span>
<span class="line"><span style="color: #C9D1D9">  });</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>This will tell the container what port to listen for and how to handle the requests.</p>
<p>Create a folder src in the bin folder and add a file routing.dart and replace the contents with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dart:async'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:shelf/shelf.dart'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> shelf;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'controllers/index.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'result.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">RouteUtils</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">static</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">FutureOr</span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9">shelf.</span><span style="color: #79C0FF">Response</span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">handler</span><span style="color: #C9D1D9">(shelf.</span><span style="color: #79C0FF">Request</span><span style="color: #C9D1D9"> request) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> component </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> request.url.pathSegments.first;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">var</span><span style="color: #C9D1D9"> handler </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">_handlers</span><span style="color: #C9D1D9">(request)[component];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (handler </span><span style="color: #FF7B72">==</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> shelf.</span><span style="color: #79C0FF">Response</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">notFound</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> handler;</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">static</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Map</span><span style="color: #FF7B72">&#x3C;</span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">FutureOr</span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9">shelf.</span><span style="color: #79C0FF">Response</span><span style="color: #FF7B72">>></span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">_handlers</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">      shelf.</span><span style="color: #79C0FF">Request</span><span style="color: #C9D1D9"> request) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #A5D6FF">'info'</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ServerResponse</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Info'</span><span style="color: #C9D1D9">, body</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"version"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'v1.0.0'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"status"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"ok"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      }).</span><span style="color: #D2A8FF">ok</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #A5D6FF">'counter'</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">CounterController</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">result</span><span style="color: #C9D1D9">(request),</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #A5D6FF">'todos'</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">TodoController</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">result</span><span style="color: #C9D1D9">(request),</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>There is still nothing imported from our main project but you will start to see some similarities. Here we specify controllers for todos and counter url paths.</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #A5D6FF">'counter'</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">CounterController</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">result</span><span style="color: #C9D1D9">(request),</span></span>
<span class="line"><span style="color: #A5D6FF">'todos'</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">TodoController</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">result</span><span style="color: #C9D1D9">(request),</span></span></code></pre>
<p>that means any url with the following:<a href="https://mydomain.com/todos">https://mydomain.com/todos</a> , <a href="https://mydomain.com/todos">https://mydomain.com/todos</a>/1</p>
<p>will get routed to the TodoController to handle the request.</p>
<blockquote>
<p>This is also the first time I found out about FutureOr. It allows you to return a sync or async function.</p>
</blockquote>
<p>And important part about build a REST API is having a consistent response body, so here we can create a wrapper that adds fields we always want to return, like the status of the call, a message and the body.</p>
<p>Create a file at src/result.dart and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dart:convert'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:shelf/shelf.dart'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> shelf;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ServerResponse</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9"> message;</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">dynamic</span><span style="color: #C9D1D9"> body;</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">StatusType</span><span style="color: #C9D1D9"> type;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">ServerResponse</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.message, {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.type </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">StatusType</span><span style="color: #C9D1D9">.success,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.body,</span></span>
<span class="line"><span style="color: #C9D1D9">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">Map</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">dynamic</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">toJson</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #A5D6FF">"status"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> type.</span><span style="color: #D2A8FF">toString</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">replaceAll</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'StatusType.'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">''</span><span style="color: #C9D1D9">),</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #A5D6FF">"message"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> message,</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #A5D6FF">"body"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> body </span><span style="color: #FF7B72">??</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">''</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">String</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">toJsonString</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> json.</span><span style="color: #D2A8FF">encode</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">toJson</span><span style="color: #C9D1D9">());</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">shelf.</span><span style="color: #79C0FF">Response</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">ok</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> shelf.</span><span style="color: #79C0FF">Response</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">ok</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #D2A8FF">toJsonString</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">      headers</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">'Content-Type'</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'application/json'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      },</span></span>
<span class="line"><span style="color: #C9D1D9">    );</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">enum</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">StatusType</span><span style="color: #C9D1D9"> { success, error }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">abstract</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ResponseImpl</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Future</span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9">shelf.</span><span style="color: #79C0FF">Response</span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">result</span><span style="color: #C9D1D9">(shelf.</span><span style="color: #79C0FF">Request</span><span style="color: #C9D1D9"> request);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>This will always return json and the fields that we want to show. You could also include your paging meta data here.</p>
<p>Create a file in at the location src/controllers/counter.dart and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:shared_dart/src/models/counter.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:shelf/shelf.dart'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> shelf;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'../result.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">CounterController</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">implements</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ResponseImpl</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">CounterController</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Future</span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9">shelf.</span><span style="color: #79C0FF">Response</span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">result</span><span style="color: #C9D1D9">(shelf.</span><span style="color: #79C0FF">Request</span><span style="color: #C9D1D9"> request) </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _model </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">CounterModel</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _params </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> request.url.queryParameters;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (_params </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _val </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">int</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">tryParse</span><span style="color: #C9D1D9">(_params[</span><span style="color: #A5D6FF">'count'</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">??</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'0'</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">      _model.</span><span style="color: #FF7B72">set</span><span style="color: #C9D1D9">(_val);</span></span>
<span class="line"><span style="color: #C9D1D9">    } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">      _model.</span><span style="color: #D2A8FF">add</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ServerResponse</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Info'</span><span style="color: #C9D1D9">, body</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #A5D6FF">"counter"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> _model.count,</span></span>
<span class="line"><span style="color: #C9D1D9">    }).</span><span style="color: #D2A8FF">ok</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>You will see the import to the lib folder of the root project. Since it shares the pubspec.yaml all the packages can be shared. You can import the CounterModel that we created earlier.</p>
<p>Create a file in at the location src/controllers/todos.dart and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:shared_dart/src/models/todos.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:shelf/src/request.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:shelf/src/response.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'../result.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">TodoController</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">implements</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ResponseImpl</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Future</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">Response</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">result</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Request</span><span style="color: #C9D1D9"> request) </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _model </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">TodosModel</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (request.url.pathSegments.length </span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _id </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">int</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">tryParse</span><span style="color: #C9D1D9">(request.url.pathSegments[</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">??</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'1'</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _todo </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> _model.</span><span style="color: #D2A8FF">getItem</span><span style="color: #C9D1D9">(_id);</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ServerResponse</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Todo Item'</span><span style="color: #C9D1D9">, body</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> _todo).</span><span style="color: #D2A8FF">ok</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> _todos </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> _model.</span><span style="color: #D2A8FF">getList</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ServerResponse</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #A5D6FF">'List Todos'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      body</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> _todos.</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">((t) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> t.</span><span style="color: #D2A8FF">toJson</span><span style="color: #C9D1D9">()).</span><span style="color: #D2A8FF">toList</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">    ).</span><span style="color: #D2A8FF">ok</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>Just like before we are importing the TodosModel model from the lib folder.</p>
<p>For convenience add a file at the location src/controllers/index.dart and add the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">export</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'counter.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">export</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'todo.dart'</span><span style="color: #C9D1D9">;</span></span></code></pre>
<p>This will make it easier to import all the controllers.</p>
<h2 id="-7"><a aria-hidden="true" tabindex="-1" href="#-7"><span class="icon icon-link"></span></a>Run the Project (Server)</h2>
<p>If you are using <a href="https://code.visualstudio.com/">VSCode</a> then you will need to update your launch.json with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">{</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Use IntelliSense to learn about possible attributes.</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Hover to view descriptions of existing attributes.</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// For more information, visit: [https://go.microsoft.com/fwlink/?linkid=830387](https://go.microsoft.com/fwlink/?linkid=830387)</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"version"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"0.2.0"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">"configurations"</span><span style="color: #C9D1D9">: [</span></span>
<span class="line"><span style="color: #C9D1D9">        {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #7EE787">"name"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"Client"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #7EE787">"request"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"launch"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #7EE787">"type"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"dart"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #7EE787">"program"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"lib/main.dart"</span></span>
<span class="line"><span style="color: #C9D1D9">        }, </span></span>
<span class="line"><span style="color: #C9D1D9">          {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #7EE787">"name"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"Server"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #7EE787">"request"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"launch"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #7EE787">"type"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"dart"</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #7EE787">"program"</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"bin/server.dart"</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">    ]</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>Now when you hit run with Server selected you will see the output:</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*akfcrkLuxit4vZdtHJty_Q.png" alt=""></p>
<p>You can navigate to this in a browser but you can also work with this in <a href="https://www.getpostman.com/">Postman</a>.</p>
<p><img src="https://cdn-images-1.medium.com/max/4796/1*zJR2ZNZfCmvLg3y5wByLNA.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/4788/1*Z2vnHjHEfYe8yWajGWVLOw.png" alt=""></p>
<p>Just by adding to the url todos and todos/1 it will return different responses.</p>
<p>For the counter model we can use query parameters too!</p>
<p><img src="https://cdn-images-1.medium.com/max/4768/1*YMwQEOoaCjngYpidKBbADg.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/4760/1*vPYs9780bcVrlIPBMjF4eQ.png" alt=""></p>
<p>Just by adding ?count=22 it will update the model with the input.</p>
<blockquote>
<p>Keep in mind this is running your Dart code from you lib folder in your Flutter project without needing the Flutter widgets!</p>
</blockquote>
<p>As a side benefit we can also run this project on Desktop. Check out the final project for the desktop folders needed from <a href="https://github.com/google/flutter-desktop-embedding">Flutter Desktop Embedding</a>.</p>
<p><img src="https://cdn-images-1.medium.com/max/3648/1*Mk_6Rlq2qMbpk79OPo_QBw.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/3648/1*hWirIWGRQjN8hVvUZsB2Nw.png" alt=""></p>
<h2 id="-8"><a aria-hidden="true" tabindex="-1" href="#-8"><span class="icon icon-link"></span></a>Conclusion</h2>
<p>Now if you wanted to deploy the container to Cloud Run you could with the following command:</p>
<p>gcloud builds submit — tag gcr.io/YOUR_GOOGLE_PROJECT_ID/PROJECT_NAME .</p>
<p>Replace PROJECT_NAME with your project name, mine is shared-dart for this example.</p>
<p>You will also need to replace YOUR_GOOGLE_PROJECT_ID with your Google Cloud Project ID. You can create one <a href="https://cloud.google.com/cloud-build/docs/quickstart-docker">here</a>.</p>
<p>Again the final project source code is <a href="https://github.com/rodydavis/shared_dart">here</a>. Let me know your thoughts!</p>
    </article>
    <aside class="astro-BVZIHDZO">
      <nav class="astro-XVRFUPWN">
  <h2 class="astro-XVRFUPWN">Table of Contents</h2>
  <ul class="astro-XVRFUPWN">
    <li class="astro-XVRFUPWN">
          <a href="#" class="heading-depth-2 astro-XVRFUPWN">
            Setting Up
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-1" class="heading-depth-2 astro-XVRFUPWN">
            Why one project?
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-2" class="heading-depth-2 astro-XVRFUPWN">
            Client Setup
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-3" class="heading-depth-3 astro-XVRFUPWN">
            Counter Example
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-4" class="heading-depth-3 astro-XVRFUPWN">
            Todo Example
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-5" class="heading-depth-3 astro-XVRFUPWN">
            Run the Project (Web)
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-6" class="heading-depth-2 astro-XVRFUPWN">
            Server Setup
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-7" class="heading-depth-2 astro-XVRFUPWN">
            Run the Project (Server)
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-8" class="heading-depth-2 astro-XVRFUPWN">
            Conclusion
          </a>
        </li>
  </ul>
</nav>
    </aside>
  </main>
    </main>
    <footer class="astro-SZ7XMLTE">
  <div class="links astro-AUSHCPD5">
  <a class="social-icon astro-AUSHCPD5" href="https://github.com/rodydavis" target="_blank" rel="noopener">
            <img src="/social/github.svg" alt="github" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://twitter.com/rodydavis" target="_blank" rel="noopener">
            <img src="/social/twitter.svg" alt="twitter" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://facebook.com/rodydavisjr" target="_blank" rel="noopener">
            <img src="/social/facebook.svg" alt="facebook" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://instagram.com/rodydavisjr" target="_blank" rel="noopener">
            <img src="/social/instagram.svg" alt="instagram" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://youtube.com/rodydavis" target="_blank" rel="noopener">
            <img src="/social/youtube.svg" alt="youtube" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://tiktok.com/@rodydavisjr" target="_blank" rel="noopener">
            <img src="/social/tiktok.svg" alt="tiktok" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://linkedin.com/in/rodydavis" target="_blank" rel="noopener">
            <img src="/social/linkedin.svg" alt="linkedin" class="astro-AUSHCPD5">
          </a>
</div>

  <div class="copyright astro-SZ7XMLTE">
    &copy; 2023
    Rody Davis. All rights reserved.
  </div>
</footer>
  </body></html>