<!DOCTYPE html><html domain=rodydavis.com ga-id=G-JQNPVBL9DR lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href="/img/favicon/favicon-32x32.png?hash=3df5885280" rel=icon type=image/png><meta content=#f9c412 name=theme-color><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name=robots><title>CSS Canvas with Lit</title><meta content="CSS Canvas with Lit" property=og:title><meta content="In this article I will go over how to set up a Lit web component and use it to create a interactive canvas with CSS transforms and slots...." name=description><meta content="In this article I will go over how to set up a Lit web component and use it to create a interactive canvas with CSS transforms and slots...." property=og:description><meta content=summary_large_image name=twitter:card><meta content=@rodydavis name=twitter:site><meta content=@rodydavis name=twitter:creator><meta content=https://rodydavis.com/img/remote/Z25Mpu0.png property=og:image><link href=https://rodydavis.com/posts/lit-css-canvas/ rel=canonical><meta content=no-referrer-when-downgrade name=referrer><link href=/feed/feed.xml rel=alternate type=application/atom+xml title="Rody Davis"><link href=/ rel=preconnect crossorigin=""><script src="/js/min.js?hash=c372ec6a84" async defer></script><script src="/js/cached.js?hash=9030142fbb" async defer></script><script csp-hash="">if (/Mac OS X/.test(navigator.userAgent)) 
        document
          .documentElement
          .classList
          .add('apple')</script><script type=text/javascript>function getCode(repo, path, branch) {
        const url = `https://raw.githubusercontent.com/rodydavis/${repo}/${branch}/${path}`;
        return fetch(url).then((res) => res.text());
      }
      async function addFiles(tag, path, branch = "main") {
          const ide = document.querySelector('playground-ide');
          const ui = await getCode(tag, 'index.html', branch);
          const code = await getCode(tag, `src/${path}`, branch);
          const name = path.split('.ts').join('.js');
          const config = { files: {} };
          config.files['index.html'] = { content:  ui.split(`/src/${path}`).join(`./${name}`) };
          config.files[path] = { content: code };
          ide.config = config;
          ide.id = 'playground';
          ide.className = 'playground-theme-tomorrow-night-eighties'
      }</script><script src=https://unpkg.com/playground-elements@0.10.0/playground-ide.js?module type=module></script><style>playground-ide {
        height: 500px;
        width: 100%;
        --playground-preview-width: 40%;
        --playground-code-background: var(--background);
        --playground-tab-bar-background: var(--background);
        --playground-tab-bar-foreground-color: var(--on-background);
        --playground-border: var(--on-background);
        --playground-preview-toolbar-background: var(--background);
        --playground-preview-toolbar-foreground-color: var(--on-background);
        --playground-highlight-color: var(--primary);
        --playground-code-default-color: var(--primary);
        --playground-code-font-family: var(--default-font);
      }</style><style>@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css);@import url(https://unpkg.com/playground-elements@0.10.0/themes/tomorrow-night-eighties.css);:root{--primary: #f9c412;--on-primary: #181818;--secondary: #e7bf60;--background: #181818;--on-background: #eee}.tags{display:wrap}.click{cursor:pointer;text-decoration:none}.chip{display:inline-block;padding:0 15px;border-radius:25px;margin:4px;background-color:var(--primary);color:var(--on-primary)}main img{content-visibility:auto}article *{scroll-margin-top:50px}header nav{z-index:1;position:fixed;top:0;left:0;width:100vw;padding:.375em 1.5em;background:rgba(255,255,255,.9);font-weight:200;text-align:right}:root{--main-width: calc(100vw - 3em)}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}dialog,share-widget{position:fixed;opacity:.9}share-widget{right:20px;bottom:20px}share-widget div{width:30px;height:30px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center}.apple share-widget div{background-image:url(/img/share-apple.svg)}body,share-widget button{margin:0}share-widget button:active{transform:scale(1.2)}dialog{background-color:#8dff80;z-index:1000}header aside{font-style:italic}#nav{z-index:2;position:relative}#reading-progress{z-index:1;background-color:var(--primary);width:100vw;position:absolute;left:0;top:0;bottom:0;transform:translate(-100vw,0);will-change:transform;pointer-events:none}#posts li{margin-bottom:.5em}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:100;src:url(/fonts/Inter-Thin.woff2) format("woff2"),url(/fonts/Inter-Thin.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:100;src:url(/fonts/Inter-ThinItalic.woff2) format("woff2"),url(/fonts/Inter-ThinItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:200;src:url(/fonts/Inter-ExtraLight.woff2) format("woff2"),url(/fonts/Inter-ExtraLight.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:200;src:url(/fonts/Inter-ExtraLightItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraLightItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:300;src:url(/fonts/Inter-Light.woff2) format("woff2"),url(/fonts/Inter-Light.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:300;src:url(/fonts/Inter-LightItalic.woff2) format("woff2"),url(/fonts/Inter-LightItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:400;src:url(/fonts/Inter-Regular.woff2) format("woff2"),url(/fonts/Inter-Regular.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:400;src:url(/fonts/Inter-Italic.woff2) format("woff2"),url(/fonts/Inter-Italic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:500;src:url(/fonts/Inter-Medium.woff2) format("woff2"),url(/fonts/Inter-Medium.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:500;src:url(/fonts/Inter-MediumItalic.woff2) format("woff2"),url(/fonts/Inter-MediumItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:600;src:url(/fonts/Inter-SemiBold.woff2) format("woff2"),url(/fonts/Inter-SemiBold.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:600;src:url(/fonts/Inter-SemiBoldItalic.woff2) format("woff2"),url(/fonts/Inter-SemiBoldItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:700;src:url(/fonts/Inter-Bold.woff2) format("woff2"),url(/fonts/Inter-Bold.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:700;src:url(/fonts/Inter-BoldItalic.woff2) format("woff2"),url(/fonts/Inter-BoldItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:800;src:url(/fonts/Inter-ExtraBold.woff2) format("woff2"),url(/fonts/Inter-ExtraBold.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:800;src:url(/fonts/Inter-ExtraBoldItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraBoldItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:900;src:url(/fonts/Inter-Black.woff2) format("woff2"),url(/fonts/Inter-Black.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:900;src:url(/fonts/Inter-BlackItalic.woff2) format("woff2"),url(/fonts/Inter-BlackItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI var alt";font-weight:100 900;font-style:normal;font-named-instance:"Regular";src:url(/fonts/Inter-roman.var.woff2) format("woff2")}@font-face{font-display:optional;font-family:"Inter UI var alt";font-weight:100 900;font-style:italic;font-named-instance:"Italic";src:url(/fonts/Inter-italic.var.woff2) format("woff2")}html{line-height:1.15;-webkit-text-size-adjust:100%;font-family:Inter UI,sans-serif;--font-family: Inter UI, sans-serif}h1{font-size:3em;line-height:1.25;margin:.67em 0 .5em;font-size:2.074rem}a{background-color:transparent;color:#f9c412;text-decoration:none;color:var(--primary)}b,strong{font-weight:700}img{border-style:none;max-width:100%;height:auto;margin:0 auto}button,input{font-family:inherit;font-size:100%;line-height:1.15;overflow:visible}button{text-transform:none}input{margin:0}[type=button],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[hidden],template{display:none}h2{font-size:2.5em;line-height:1.2;margin-bottom:.6em}body,p,pre,ul{font-size:1em}p,pre,ul{margin-bottom:1.5em}h1,h2{line-height:2.4rem;margin-bottom:1.36rem}h2{font-size:1.728rem}body,p,pre,ul{font-size:1rem;line-height:1.6}p,pre,ul{margin-bottom:1.36rem}@media (min-width:600px){h1{font-size:4.3978rem;line-height:4.4rem}h2{font-size:3.1097rem;line-height:3.52rem}body,p,pre,ul{font-size:1.1rem;line-height:1.6}h1,h2,p,pre,ul{margin-bottom:1.496rem}}@media (min-width:1200px){h1{font-size:6.0756rem;line-height:6.72rem}h2{font-size:4.05rem;line-height:4.8rem}body,p,pre,ul{font-size:1.2rem;line-height:1.6}h1,h2,p,pre,ul{margin-bottom:1.632rem}}code,pre{overflow-x:auto}pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace}pre code:not([class]){padding:1.5em;overflow-x:scroll}code{border-radius:.3em;color:#e2777a;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:90%;background:#2d2d2d;padding:0}h1,h2{font-family:var(--font-family)}h2{font-style:italic}a:hover{text-decoration:underline}dt{font-weight:600;padding-top:.75em;padding-left:.75em}@media (max-width:767px){x:-moz-any-link{display:table-cell}}@supports (font-variation-settings:normal){html{font-family:Inter UI var alt,sans-serif;--font-family: Inter UI var alt, sans-serif}}button,input{border-radius:.3em;max-width:100%}button{background:#f2f2f2;color:#191919;cursor:pointer;display:inline-block;padding:.75em 1.5em;text-align:center;margin:0 .75em 1.5em 0}input{padding:.75em;margin-bottom:1.5em;display:inline}button:hover{background:#d9d9d9;color:var(--surface)}button:not([disabled]){background:#f9c412;color:#181818;background:var(--primary)}button:not([disabled]):hover{background:#ba9005;color:#000;background:var(--secondary)}input[type=datetime],input[type=number],input[type=text],input[type=time],input[type=url]{border:1px solid #595959;padding:.75em}*{border:0;box-sizing:border-box}body,header nav a{font-family:var(--font-family)}body{background:var(--background);color:var(--on-background)}header{padding:4.5em 1.5em 3em;width:37.5em;margin:0 auto;text-align:center;max-width:100%;display:flex;align-items:center;flex-direction:column}header p,ul{margin-top:0}header nav h1{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav a{font-weight:700;text-decoration:none;color:#181818;margin-left:1.5em}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}main{max-width:70rem;margin:0 auto;border-top:.5px solid #ccc}footer{background:var(--background);color:var(--on-background);text-align:center;padding:2em 2em 100px}footer>*{margin:.6em}footer nav a img{vertical-align:middle}footer nav,footer p{font-size:90%}article{max-width:100%;padding:1.5em;width:37.5em;margin:0 auto}li ul{margin-bottom:0}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;background:#2d2d2d}.token.comment,.token.doctype{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.tag{color:#e2777a}.token.function,.token.number{color:#f08d49}.token.class-name,.token.property{color:#f8c555}.token.builtin,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.string{color:#7ec699}.token.operator,.token.url{color:#67cdcc}.token.inserted{color:green}</style><header><nav><div id=nav><h1><a href=/ title=Homepage>Rody Davis</a></h1><a href=/about/ >About</a> <a href=/talks/ >Talks</a> <a href=/apps/ >Apps</a></div><div id=reading-progress aria-hidden=true></div></nav><h1>CSS Canvas with Lit</h1><aside>9 min read.</aside><dialog id=message></dialog><noscript><img src="/.netlify/functions/ga?v=1&_v=j83&t=pageview&dr=https%3A%2F%2Fno-script.com&_s=1&dh=rodydavis.com&dp=%2Fposts%2Flit-css-canvas%2F&ul=en-us&de=UTF-8&dt=CSS%20Canvas%20with%20Lit&tid=G-JQNPVBL9DR" style=display:none width=1 alt="" height=1></noscript></header><main><article><div class=tags><a href=/tags/web/ class=click><div class=chip>web</div></a><a href=/tags/lit/ class=click><div class=chip>lit</div></a><a href=/tags/css/ class=click><div class=chip>css</div></a><a href=/tags/canvas/ class=click><div class=chip>canvas</div></a><a href=/tags/playground/ class=click><div class=chip>playground</div></a></div><p>In this article I will go over how to set up a <a href=https://lit.dev>Lit</a> web component and use it to create a interactive canvas with CSS transforms and slots.<p><strong>TLDR</strong> The final source <a href=https://github.com/rodydavis/lit-css-canvas>here</a> and an online <a href=https://rodydavis.github.io/lit-css-canvas/ >demo</a>.<p><playground-ide editable-file-system="" line-numbers="" resizable=""></playground-ide></p><script>addFiles('lit-css-canvas', 'css-canvas.ts')</script><h2 id=prerequisites>Prerequisites <a href=#prerequisites class=direct-link>#</a></h2><ul><li>Vscode<li>Node >= 12<li>Typescript</ul><h2 id=getting-started>Getting Started <a href=#getting-started class=direct-link>#</a></h2><p>We can start off by navigating in terminal to the location of the project and run the following:<pre class=language-bash><code class=language-bash><span class="token function">npm</span> init @vitejs/app --template lit-element-ts</code></pre><p>Then enter a project name <code>lit-css-canvas</code> and now open the project in vscode and install the dependencies:<pre class=language-bash><code class=language-bash><span class="token class-name builtin">cd</span> lit-css-canvas<br><span class="token function">npm</span> i lit<br><span class="token function">npm</span> i -D @types/node<br>code <span class="token class-name builtin">.</span></code></pre><p>Update the <code>vite.config.ts</code> with the following:<pre class=language-js><code class=language-js><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vite"</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> resolve <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"path"</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  base<span class="token operator">:</span> <span class="token string">"/lit-css-canvas/"</span><span class="token punctuation">,</span><br>  build<span class="token operator">:</span> <span class="token punctuation">{</span><br>    rollupOptions<span class="token operator">:</span> <span class="token punctuation">{</span><br>      input<span class="token operator">:</span> <span class="token punctuation">{</span><br>        main<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"index.html"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>      <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></code></pre><h2 id=template>Template <a href=#template class=direct-link>#</a></h2><p>Open up the <code>index.html</code> and update it with the following:<pre class=language-html><code class=language-html><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>image/svg+xml<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/src/favicon.svg<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Lit CSS Canvas<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"><br>      <span class="token selector">body</span> <span class="token punctuation">{</span><br>        <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span><br>        <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span><br>        <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span><br>        <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/src/css-canvas.ts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>css-canvas</span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span><br>        <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://lit.dev/images/logo.svg<span class="token punctuation">"</span></span><br>        <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Lit Logo<span class="token punctuation">"</span></span><br>        <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span><br>        <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>333<span class="token punctuation">"</span></span><br>        <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token language-css style"><span class="token property">--dx</span><span class="token punctuation">:</span> 59.4909px<span class="token punctuation">;</span> <span class="token property">--dy</span><span class="token punctuation">:</span> 32.8429px</span><span class="token punctuation">"</span></span></span><br>      <span class="token punctuation">/></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>110<span class="token punctuation">"</span></span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token language-css style"><span class="token property">--dx</span><span class="token punctuation">:</span> 230.057px<span class="token punctuation">;</span> <span class="token property">--dy</span><span class="token punctuation">:</span> 33.6257px</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span><br>          <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span><br>          <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><br>          <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token language-css style"><span class="token property">fill</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 255<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token property">stroke-width</span><span class="token punctuation">:</span> 3<span class="token punctuation">;</span> <span class="token property">stroke</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><br>        <span class="token punctuation">/></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span><br>          <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span><br>          <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span><br>          <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span><br>          <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>black<span class="token punctuation">"</span></span><br>          <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span><br>          <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span><br>        <span class="token punctuation">/></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>css-canvas</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><br></code></pre><p>We are setting up the <code>css-element</code> to have a few slots which can be any valid HTML or SVG Elements.<p>It is optional to set the <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/--*>css custom properties</a> <code>--dx</code> and <code>--dy</code> as this is just the initial positions on the canvas.<h2 id=web-component>Web Component <a href=#web-component class=direct-link>#</a></h2><p>Before we update our component we need to rename <code>my-element.ts</code> to <code>css-canvas.ts</code><p>Open up <code>css-canvas.ts</code> and update it with the following:<pre class=language-js><code class=language-js><span class="token keyword">import</span> <span class="token punctuation">{</span> html<span class="token punctuation">,</span> css<span class="token punctuation">,</span> LitElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"lit"</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> customElement<span class="token punctuation">,</span> query <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"lit/decorators.js"</span><span class="token punctuation">;</span><br><br>type DragType <span class="token operator">=</span> <span class="token string">"none"</span> <span class="token operator">|</span> <span class="token string">"canvas"</span> <span class="token operator">|</span> <span class="token string">"element"</span><span class="token punctuation">;</span><br>type SupportedNode <span class="token operator">=</span> HTMLElement <span class="token operator">|</span> SVGElement<span class="token punctuation">;</span><br><br>@<span class="token function">customElement</span><span class="token punctuation">(</span><span class="token string">"css-canvas"</span><span class="token punctuation">)</span><br><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CSSCanvas</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span><br>  @<span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"main"</span><span class="token punctuation">)</span> root<span class="token operator">!</span><span class="token operator">:</span> HTMLElement<span class="token punctuation">;</span><br>  @<span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"#children"</span><span class="token punctuation">)</span> container<span class="token operator">!</span><span class="token operator">:</span> HTMLElement<span class="token punctuation">;</span><br>  @<span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span> canvas<span class="token operator">!</span><span class="token operator">:</span> HTMLCanvasElement<span class="token punctuation">;</span><br>  dragType<span class="token operator">:</span> DragType <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span><br>  offset<span class="token operator">:</span> Offset <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>  pointerMap<span class="token operator">:</span> Map<span class="token operator">&lt;</span>number<span class="token punctuation">,</span> PointerData<span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> styles <span class="token operator">=</span> css<span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string"><br>    :host {<br>      --offset-x: 0;<br>      --offset-y: 0;<br>      --grid-background-color: white;<br>      --grid-color: black;<br>      --grid-size: 40px;<br>      --grid-dot-size: 1px;<br>    }<br>    main {<br>      overflow: hidden;<br>    }<br>    canvas {<br>      background-size: var(--grid-size) var(--grid-size);<br>      background-image: radial-gradient(<br>        circle,<br>        var(--grid-color) var(--grid-dot-size),<br>        var(--grid-background-color) var(--grid-dot-size)<br>      );<br>      background-position: var(--offset-x) var(--offset-y);<br>      z-index: 0;<br>    }<br>    .full-size {<br>      width: 100%;<br>      height: 100%;<br>      position: fixed;<br>    }<br>    .child {<br>      --dx: 0px;<br>      --dy: 0px;<br>      position: fixed;<br>      flex-shrink: 1;<br>      z-index: var(--layer, 0);<br>      transform: translate(var(--dx), var(--dy));<br>    }<br>    @media (prefers-color-scheme: dark) {<br>      main {<br>        --grid-background-color: black;<br>        --grid-color: grey;<br>      }<br>    }<br>  </span><span class="token string template-punctuation">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> html<span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string"><br>      &lt;main class="full-size"><br>        &lt;canvas class="full-size">&lt;/canvas><br>        &lt;div id="children" class="full-size">&lt;/div><br>      &lt;/main><br>    </span><span class="token string template-punctuation">`</span></span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">interface</span> <span class="token class-name">Offset</span> <span class="token punctuation">{</span><br>  x<span class="token operator">:</span> number<span class="token punctuation">;</span><br>  y<span class="token operator">:</span> number<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">interface</span> <span class="token class-name">PointerData</span> <span class="token punctuation">{</span><br>  id<span class="token operator">:</span> number<span class="token punctuation">;</span><br>  startPos<span class="token operator">:</span> Offset<span class="token punctuation">;</span><br>  currentPos<span class="token operator">:</span> Offset<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br></code></pre><p>Here we are just setting up some boilerplate to render a <code>main</code> element with a <code>canvas</code> element as a background and the <code>div</code> element to contain the canvas elements.<p>We are also making sure to clip and only render what is visible.<p>The <code>Offset</code> and <code>PointerData</code> interfaces will be used for storing the location of each pointer interacting with the screen.<p>When the user has dark mode enabled for the system it will change the colors of the canvas grid.<p>Now let's add the slot children to the canvas by adding the following to the class:<pre class=language-js><code class=language-js><span class="token keyword">async</span> <span class="token function">firstUpdated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> items <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>childNodes<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> node <span class="token keyword">of</span> items<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token keyword">instanceof</span> <span class="token class-name">SVGElement</span> <span class="token operator">||</span> node <span class="token keyword">instanceof</span> <span class="token class-name">HTMLElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">const</span> child <span class="token operator">=</span> node <span class="token keyword">as</span> SupportedNode<span class="token punctuation">;</span><br>            child<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"child"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            child<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--layer"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>i<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span><br>            child<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>                <span class="token comment">// Pointer Down for Child</span><br>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            child<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>                <span class="token comment">// Pointer Move for Child</span><br>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            i<span class="token operator">++</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">requestUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token comment">// Pointer Down for Canvas</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token comment">// Pointer Move for Canvas</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token comment">// Pointer Up for Canvas</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>The order of the slots defines what renders on top of each other. For each item in the slot it sets<code>--layer</code> and <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/z-index><code>z-index</code></a> to the current index.<p>Currently nothing is happening when we interact with the elements but things should be rendering.</p><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/css-canvas/canvas-1920w.avif 1920w, /img/css-canvas/canvas-1280w.avif 1280w, /img/css-canvas/canvas-640w.avif 640w, /img/css-canvas/canvas-320w.avif 320w" type=image/avif><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/css-canvas/canvas-1920w.webp 1920w, /img/css-canvas/canvas-1280w.webp 1280w, /img/css-canvas/canvas-640w.webp 640w, /img/css-canvas/canvas-320w.webp 320w" type=image/webp><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/css-canvas/canvas-1920w.jpg 1920w, /img/css-canvas/canvas-1280w.jpg 1280w, /img/css-canvas/canvas-640w.jpg 640w, /img/css-canvas/canvas-320w.jpg 320w" type=image/jpeg><img src=/img/css-canvas/canvas-1920w.jpg style="background-size:cover;background-image:url(&#34;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 862 535'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' preserveAspectRatio='none' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAu0lEQVQI112PPQrCQBCFcxnvYC3GwiPkADap09l4BC9gJ5ZBEQ1eIPgDor0oiAoSUVRcTDL7uSvBwgevmflm3oyjtUZeCskyQBtL4byw6YvGsaVLs4msF2xOUKsqXDejXs8ol1O63TdWTm5o3k/CgWLQPxMEikbjge8/8LwrUVSAdvXpAKX2nkprZ4burNYjZrMh02n4hdI0tyDcEkVnm9DbQnJ8MY4mxPGC+Xz5BUXE3GijfxL+ZSH78AfkQNbd9Ck3NQAAAABJRU5ErkJggg=='%3E%3C/image%3E%3C/svg%3E&#34;)" width=100% decoding=async loading=lazy></picture><p>Now let's add the event handlers for the <a href=https://developer.mozilla.org/en-US/docs/Web/API/Pointer_events>pointer events</a> by appending the following to the class:<pre class=language-js><code class=language-js><span class="token function">handleDown</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> PointerEvent<span class="token punctuation">,</span> type<span class="token operator">:</span> DragType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dragType <span class="token operator">===</span> <span class="token string">"none"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>dragType <span class="token operator">=</span> type<span class="token punctuation">;</span><br>        <span class="token punctuation">(</span>event<span class="token punctuation">.</span>target <span class="token keyword">as</span> Element<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pointerId<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>pointerMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pointerId<span class="token punctuation">,</span> <span class="token punctuation">{</span><br>            id<span class="token operator">:</span> event<span class="token punctuation">.</span>pointerId<span class="token punctuation">,</span><br>            startPos<span class="token operator">:</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span> y<span class="token operator">:</span> event<span class="token punctuation">.</span>clientY <span class="token punctuation">}</span><span class="token punctuation">,</span><br>            currentPos<span class="token operator">:</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span> y<span class="token operator">:</span> event<span class="token punctuation">.</span>clientY <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token function">handleMove</span><span class="token punctuation">(</span><br>    event<span class="token operator">:</span> PointerEvent<span class="token punctuation">,</span><br>    type<span class="token operator">:</span> DragType<span class="token punctuation">,</span><br>    <span class="token function function-variable">onMove</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">delta<span class="token operator">:</span> Offset</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><br><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dragType <span class="token operator">===</span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">const</span> saved <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pointerMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pointerId<span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span><br>        <span class="token keyword">const</span> current <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>saved<span class="token punctuation">.</span>currentPos <span class="token punctuation">}</span><span class="token punctuation">;</span><br>        saved<span class="token punctuation">.</span>currentPos <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span> y<span class="token operator">:</span> event<span class="token punctuation">.</span>clientY <span class="token punctuation">}</span><span class="token punctuation">;</span><br>        <span class="token keyword">const</span> delta <span class="token operator">=</span> <span class="token punctuation">{</span><br>            x<span class="token operator">:</span> saved<span class="token punctuation">.</span>currentPos<span class="token punctuation">.</span>x <span class="token operator">-</span> current<span class="token punctuation">.</span>x<span class="token punctuation">,</span><br>            y<span class="token operator">:</span> saved<span class="token punctuation">.</span>currentPos<span class="token punctuation">.</span>y <span class="token operator">-</span> current<span class="token punctuation">.</span>y<span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><span class="token punctuation">;</span><br>        <span class="token function">onMove</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token function">handleUp</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> PointerEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>dragType <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span><br>    <span class="token punctuation">(</span>event<span class="token punctuation">.</span>target <span class="token keyword">as</span> Element<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">releasePointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pointerId<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>For each event we want to check if the current event <code>canvas</code> or <code>element</code> so if we start moving an element it doesn't move the canvas and vice versa.<p>When we have a pointer interact with the screen we will add it to the pointer map (since it can be multi touch) and start tracking the offset.<p>The delta is calculated to move the elements but a global offset is used for the canvas background.<p>We are setting the pointer capture events so if the mouse is not perfectly on the item it won't lose tracking.<p>Now let's add methods for moving the canvas and elements by appending the following to the class:<pre class=language-js><code class=language-js><span class="token function">moveCanvas</span><span class="token punctuation">(</span><span class="token parameter">delta<span class="token operator">:</span> Offset</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>offset<span class="token punctuation">.</span>x <span class="token operator">+=</span> delta<span class="token punctuation">.</span>x<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>offset<span class="token punctuation">.</span>y <span class="token operator">+=</span> delta<span class="token punctuation">.</span>y<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--offset-x"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>offset<span class="token punctuation">.</span>x<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--offset-y"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>offset<span class="token punctuation">.</span>y<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">moveElement</span><span class="token punctuation">(</span><span class="token parameter">child<span class="token operator">:</span> SupportedNode<span class="token punctuation">,</span> delta<span class="token operator">:</span> Offset</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> getNumber <span class="token operator">=</span> <span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token string">"--dx"</span> <span class="token operator">|</span> <span class="token string">"--dy"</span><span class="token punctuation">,</span> fallback<span class="token operator">:</span> number<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> saved <span class="token operator">=</span> child<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">getPropertyValue</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>saved<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>saved<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"px"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>      <span class="token keyword">return</span> fallback<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dx <span class="token operator">=</span> <span class="token function">getNumber</span><span class="token punctuation">(</span><span class="token string">"--dx"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> delta<span class="token punctuation">.</span>x<span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dy <span class="token operator">=</span> <span class="token function">getNumber</span><span class="token punctuation">(</span><span class="token string">"--dy"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> delta<span class="token punctuation">.</span>y<span class="token punctuation">;</span><br>    child<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>dx<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px, </span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>dy<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px)</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">;</span><br>    child<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--dx"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>dx<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    child<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--dy"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>dy<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>For the canvas it will set a global offset for the CSS <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/background-position><code>background-position</code></a> and update the saved offset.<p>For the element we want to transform by the delta so the animation is smooth thanks to hardware acceleration. After the transform it will store the offset as CSS custom properties.<p>Now let's add the event handlers to the canvas and elements by adjusting the following:<pre class=language-js><code class=language-js><span class="token keyword">async</span> <span class="token function">firstUpdated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> items <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>childNodes<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> node <span class="token keyword">of</span> items<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token keyword">instanceof</span> <span class="token class-name">SVGElement</span> <span class="token operator">||</span> node <span class="token keyword">instanceof</span> <span class="token class-name">HTMLElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> child <span class="token operator">=</span> node <span class="token keyword">as</span> SupportedNode<span class="token punctuation">;</span><br>        child<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"child"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        child<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--layer"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>i<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        child<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleDown</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">"element"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        child<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleMove</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">"element"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">delta</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveElement</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> delta<span class="token punctuation">)</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        i<span class="token operator">++</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">requestUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleDown</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleMove</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">"canvas"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">delta</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveCanvas</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> node <span class="token keyword">of</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token keyword">instanceof</span> <span class="token class-name">SVGElement</span> <span class="token operator">||</span> node <span class="token keyword">instanceof</span> <span class="token class-name">HTMLElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveElement</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> delta<span class="token punctuation">)</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleUp</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Everything should work as expected now and the final code should look like the following:<pre class=language-js><code class=language-js><span class="token keyword">import</span> <span class="token punctuation">{</span> html<span class="token punctuation">,</span> css<span class="token punctuation">,</span> LitElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"lit"</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> customElement<span class="token punctuation">,</span> query <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"lit/decorators.js"</span><span class="token punctuation">;</span><br><br>type DragType <span class="token operator">=</span> <span class="token string">"none"</span> <span class="token operator">|</span> <span class="token string">"canvas"</span> <span class="token operator">|</span> <span class="token string">"element"</span><span class="token punctuation">;</span><br>type SupportedNode <span class="token operator">=</span> HTMLElement <span class="token operator">|</span> SVGElement<span class="token punctuation">;</span><br><br>@<span class="token function">customElement</span><span class="token punctuation">(</span><span class="token string">"css-canvas"</span><span class="token punctuation">)</span><br><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CSSCanvas</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span><br>  @<span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"main"</span><span class="token punctuation">)</span> root<span class="token operator">!</span><span class="token operator">:</span> HTMLElement<span class="token punctuation">;</span><br>  @<span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"#children"</span><span class="token punctuation">)</span> container<span class="token operator">!</span><span class="token operator">:</span> HTMLElement<span class="token punctuation">;</span><br>  @<span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span> canvas<span class="token operator">!</span><span class="token operator">:</span> HTMLCanvasElement<span class="token punctuation">;</span><br>  dragType<span class="token operator">:</span> DragType <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span><br>  offset<span class="token operator">:</span> Offset <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>  pointerMap<span class="token operator">:</span> Map<span class="token operator">&lt;</span>number<span class="token punctuation">,</span> PointerData<span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> styles <span class="token operator">=</span> css<span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string"><br>    :host {<br>      --offset-x: 0;<br>      --offset-y: 0;<br>      --grid-background-color: white;<br>      --grid-color: black;<br>      --grid-size: 40px;<br>      --grid-dot-size: 1px;<br>    }<br>    main {<br>      overflow: hidden;<br>    }<br>    canvas {<br>      background-size: var(--grid-size) var(--grid-size);<br>      background-image: radial-gradient(<br>        circle,<br>        var(--grid-color) var(--grid-dot-size),<br>        var(--grid-background-color) var(--grid-dot-size)<br>      );<br>      background-position: var(--offset-x) var(--offset-y);<br>      z-index: 0;<br>    }<br>    .full-size {<br>      width: 100%;<br>      height: 100%;<br>      position: fixed;<br>    }<br>    .child {<br>      --dx: 0px;<br>      --dy: 0px;<br>      position: fixed;<br>      flex-shrink: 1;<br>      z-index: var(--layer, 0);<br>      transform: translate(var(--dx), var(--dy));<br>    }<br>    @media (prefers-color-scheme: dark) {<br>      main {<br>        --grid-background-color: black;<br>        --grid-color: grey;<br>      }<br>    }<br>  </span><span class="token string template-punctuation">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"render"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> html<span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string"><br>      &lt;main class="full-size"><br>        &lt;canvas class="full-size">&lt;/canvas><br>        &lt;div id="children" class="full-size">&lt;/div><br>      &lt;/main><br>    </span><span class="token string template-punctuation">`</span></span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">handleDown</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> PointerEvent<span class="token punctuation">,</span> type<span class="token operator">:</span> DragType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dragType <span class="token operator">===</span> <span class="token string">"none"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>dragType <span class="token operator">=</span> type<span class="token punctuation">;</span><br>      <span class="token punctuation">(</span>event<span class="token punctuation">.</span>target <span class="token keyword">as</span> Element<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pointerId<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>pointerMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pointerId<span class="token punctuation">,</span> <span class="token punctuation">{</span><br>        id<span class="token operator">:</span> event<span class="token punctuation">.</span>pointerId<span class="token punctuation">,</span><br>        startPos<span class="token operator">:</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span> y<span class="token operator">:</span> event<span class="token punctuation">.</span>clientY <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        currentPos<span class="token operator">:</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span> y<span class="token operator">:</span> event<span class="token punctuation">.</span>clientY <span class="token punctuation">}</span><span class="token punctuation">,</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">handleMove</span><span class="token punctuation">(</span><br>    event<span class="token operator">:</span> PointerEvent<span class="token punctuation">,</span><br>    type<span class="token operator">:</span> DragType<span class="token punctuation">,</span><br>    <span class="token function function-variable">onMove</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">delta<span class="token operator">:</span> Offset</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><br>  <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dragType <span class="token operator">===</span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">const</span> saved <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pointerMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pointerId<span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span><br>      <span class="token keyword">const</span> current <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>saved<span class="token punctuation">.</span>currentPos <span class="token punctuation">}</span><span class="token punctuation">;</span><br>      saved<span class="token punctuation">.</span>currentPos <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span> y<span class="token operator">:</span> event<span class="token punctuation">.</span>clientY <span class="token punctuation">}</span><span class="token punctuation">;</span><br>      <span class="token keyword">const</span> delta <span class="token operator">=</span> <span class="token punctuation">{</span><br>        x<span class="token operator">:</span> saved<span class="token punctuation">.</span>currentPos<span class="token punctuation">.</span>x <span class="token operator">-</span> current<span class="token punctuation">.</span>x<span class="token punctuation">,</span><br>        y<span class="token operator">:</span> saved<span class="token punctuation">.</span>currentPos<span class="token punctuation">.</span>y <span class="token operator">-</span> current<span class="token punctuation">.</span>y<span class="token punctuation">,</span><br>      <span class="token punctuation">}</span><span class="token punctuation">;</span><br>      <span class="token function">onMove</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">handleUp</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> PointerEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>dragType <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span><br>    <span class="token punctuation">(</span>event<span class="token punctuation">.</span>target <span class="token keyword">as</span> Element<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">releasePointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pointerId<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">moveCanvas</span><span class="token punctuation">(</span><span class="token parameter">delta<span class="token operator">:</span> Offset</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>offset<span class="token punctuation">.</span>x <span class="token operator">+=</span> delta<span class="token punctuation">.</span>x<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>offset<span class="token punctuation">.</span>y <span class="token operator">+=</span> delta<span class="token punctuation">.</span>y<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--offset-x"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>offset<span class="token punctuation">.</span>x<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--offset-y"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>offset<span class="token punctuation">.</span>y<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">moveElement</span><span class="token punctuation">(</span><span class="token parameter">child<span class="token operator">:</span> SupportedNode<span class="token punctuation">,</span> delta<span class="token operator">:</span> Offset</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> getNumber <span class="token operator">=</span> <span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token string">"--dx"</span> <span class="token operator">|</span> <span class="token string">"--dy"</span><span class="token punctuation">,</span> fallback<span class="token operator">:</span> number<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> saved <span class="token operator">=</span> child<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">getPropertyValue</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>saved<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>saved<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"px"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>      <span class="token keyword">return</span> fallback<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dx <span class="token operator">=</span> <span class="token function">getNumber</span><span class="token punctuation">(</span><span class="token string">"--dx"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> delta<span class="token punctuation">.</span>x<span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dy <span class="token operator">=</span> <span class="token function">getNumber</span><span class="token punctuation">(</span><span class="token string">"--dy"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> delta<span class="token punctuation">.</span>y<span class="token punctuation">;</span><br>    child<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>dx<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px, </span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>dy<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px)</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">;</span><br>    child<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--dx"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>dx<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    child<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--dy"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>dy<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">px</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">async</span> <span class="token function">firstUpdated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> items <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>childNodes<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> node <span class="token keyword">of</span> items<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token keyword">instanceof</span> <span class="token class-name">SVGElement</span> <span class="token operator">||</span> node <span class="token keyword">instanceof</span> <span class="token class-name">HTMLElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> child <span class="token operator">=</span> node <span class="token keyword">as</span> SupportedNode<span class="token punctuation">;</span><br>        child<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"child"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        child<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"--layer"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>i<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        child<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleDown</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">"element"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        child<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleMove</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">"element"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">delta</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveElement</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> delta<span class="token punctuation">)</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        child<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"draggable"</span><span class="token punctuation">,</span> <span class="token string">"false"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        i<span class="token operator">++</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">requestUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleDown</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleMove</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">"canvas"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">delta</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveCanvas</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> node <span class="token keyword">of</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token keyword">instanceof</span> <span class="token class-name">SVGElement</span> <span class="token operator">||</span> node <span class="token keyword">instanceof</span> <span class="token class-name">HTMLElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">moveElement</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> delta<span class="token punctuation">)</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleUp</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">interface</span> <span class="token class-name">Offset</span> <span class="token punctuation">{</span><br>  x<span class="token operator">:</span> number<span class="token punctuation">;</span><br>  y<span class="token operator">:</span> number<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">interface</span> <span class="token class-name">PointerData</span> <span class="token punctuation">{</span><br>  id<span class="token operator">:</span> number<span class="token punctuation">;</span><br>  startPos<span class="token operator">:</span> Offset<span class="token punctuation">;</span><br>  currentPos<span class="token operator">:</span> Offset<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br></code></pre><h2 id=conclusion>Conclusion <a href=#conclusion class=direct-link>#</a></h2><p>If you want to learn more about building with Lit you can read the docs <a href=https://lit.dev>here</a>. There is also an example on the Lit playground <a href="https://lit.dev/playground/#project=W3sibmFtZSI6ImxpdC1jc3MtY2FudmFzLnRzIiwiY29udGVudCI6ImltcG9ydCB7IGh0bWwsIGNzcywgTGl0RWxlbWVudCB9IGZyb20gXCJsaXRcIjtcbmltcG9ydCB7IGN1c3RvbUVsZW1lbnQsIHF1ZXJ5IH0gZnJvbSBcImxpdC9kZWNvcmF0b3JzLmpzXCI7XG5cbnR5cGUgRHJhZ1R5cGUgPSBcIm5vbmVcIiB8IFwiY2FudmFzXCIgfCBcImVsZW1lbnRcIjtcbnR5cGUgU3VwcG9ydGVkTm9kZSA9IEhUTUxFbGVtZW50IHwgU1ZHRWxlbWVudDtcblxuQGN1c3RvbUVsZW1lbnQoXCJjc3MtY2FudmFzXCIpXG5leHBvcnQgY2xhc3MgQ1NTQ2FudmFzIGV4dGVuZHMgTGl0RWxlbWVudCB7XG4gIEBxdWVyeShcIm1haW5cIikgcm9vdCE6IEhUTUxFbGVtZW50O1xuICBAcXVlcnkoXCIjY2hpbGRyZW5cIikgY29udGFpbmVyITogSFRNTEVsZW1lbnQ7XG4gIEBxdWVyeShcImNhbnZhc1wiKSBjYW52YXMhOiBIVE1MQ2FudmFzRWxlbWVudDtcbiAgZHJhZ1R5cGU6IERyYWdUeXBlID0gXCJub25lXCI7XG4gIG9mZnNldDogT2Zmc2V0ID0geyB4OiAwLCB5OiAwIH07XG4gIHBvaW50ZXJNYXA6IE1hcDxudW1iZXIsIFBvaW50ZXJEYXRhPiA9IG5ldyBNYXAoKTtcblxuICBzdGF0aWMgc3R5bGVzID0gY3NzYFxuICAgIDpob3N0IHtcbiAgICAgIC0tb2Zmc2V0LXg6IDA7XG4gICAgICAtLW9mZnNldC15OiAwO1xuICAgICAgLS1ncmlkLWJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xuICAgICAgLS1ncmlkLWNvbG9yOiBibGFjaztcbiAgICAgIC0tZ3JpZC1zaXplOiA0MHB4O1xuICAgICAgLS1ncmlkLWRvdC1zaXplOiAxcHg7XG4gICAgfVxuICAgIG1haW4ge1xuICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICB9XG4gICAgY2FudmFzIHtcbiAgICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tZ3JpZC1zaXplKSB2YXIoLS1ncmlkLXNpemUpO1xuICAgICAgYmFja2dyb3VuZC1pbWFnZTogcmFkaWFsLWdyYWRpZW50KFxuICAgICAgICBjaXJjbGUsXG4gICAgICAgIHZhcigtLWdyaWQtY29sb3IpIHZhcigtLWdyaWQtZG90LXNpemUpLFxuICAgICAgICB2YXIoLS1ncmlkLWJhY2tncm91bmQtY29sb3IpIHZhcigtLWdyaWQtZG90LXNpemUpXG4gICAgICApO1xuICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogdmFyKC0tb2Zmc2V0LXgpIHZhcigtLW9mZnNldC15KTtcbiAgICAgIHotaW5kZXg6IDA7XG4gICAgfVxuICAgIC5mdWxsLXNpemUge1xuICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgfVxuICAgIC5jaGlsZCB7XG4gICAgICAtLWR4OiAwcHg7XG4gICAgICAtLWR5OiAwcHg7XG4gICAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgICBmbGV4LXNocmluazogMTtcbiAgICAgIHotaW5kZXg6IHZhcigtLWxheWVyLCAwKTtcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKHZhcigtLWR4KSwgdmFyKC0tZHkpKTtcbiAgICB9XG4gICAgQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaykge1xuICAgICAgbWFpbiB7XG4gICAgICAgIC0tZ3JpZC1iYWNrZ3JvdW5kLWNvbG9yOiBibGFjaztcbiAgICAgICAgLS1ncmlkLWNvbG9yOiBncmV5O1xuICAgICAgfVxuICAgIH1cbiAgYDtcblxuICByZW5kZXIoKSB7XG4gICAgY29uc29sZS5sb2coXCJyZW5kZXJcIik7XG4gICAgcmV0dXJuIGh0bWxgXG4gICAgICA8bWFpbiBjbGFzcz1cImZ1bGwtc2l6ZVwiPlxuICAgICAgICA8Y2FudmFzIGNsYXNzPVwiZnVsbC1zaXplXCI-PC9jYW52YXM-XG4gICAgICAgIDxkaXYgaWQ9XCJjaGlsZHJlblwiIGNsYXNzPVwiZnVsbC1zaXplXCI-PC9kaXY-XG4gICAgICA8L21haW4-XG4gICAgYDtcbiAgfVxuXG4gIGhhbmRsZURvd24oZXZlbnQ6IFBvaW50ZXJFdmVudCwgdHlwZTogRHJhZ1R5cGUpIHtcbiAgICBpZiAodGhpcy5kcmFnVHlwZSA9PT0gXCJub25lXCIpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmRyYWdUeXBlID0gdHlwZTtcbiAgICAgIChldmVudC50YXJnZXQgYXMgRWxlbWVudCkuc2V0UG9pbnRlckNhcHR1cmUoZXZlbnQucG9pbnRlcklkKTtcbiAgICAgIHRoaXMucG9pbnRlck1hcC5zZXQoZXZlbnQucG9pbnRlcklkLCB7XG4gICAgICAgIGlkOiBldmVudC5wb2ludGVySWQsXG4gICAgICAgIHN0YXJ0UG9zOiB7IHg6IGV2ZW50LmNsaWVudFgsIHk6IGV2ZW50LmNsaWVudFkgfSxcbiAgICAgICAgY3VycmVudFBvczogeyB4OiBldmVudC5jbGllbnRYLCB5OiBldmVudC5jbGllbnRZIH0sXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVNb3ZlKFxuICAgIGV2ZW50OiBQb2ludGVyRXZlbnQsXG4gICAgdHlwZTogRHJhZ1R5cGUsXG4gICAgb25Nb3ZlOiAoZGVsdGE6IE9mZnNldCkgPT4gdm9pZFxuICApIHtcbiAgICBpZiAodGhpcy5kcmFnVHlwZSA9PT0gdHlwZSkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGNvbnN0IHNhdmVkID0gdGhpcy5wb2ludGVyTWFwLmdldChldmVudC5wb2ludGVySWQpITtcbiAgICAgIGNvbnN0IGN1cnJlbnQgPSB7IC4uLnNhdmVkLmN1cnJlbnRQb3MgfTtcbiAgICAgIHNhdmVkLmN1cnJlbnRQb3MgPSB7IHg6IGV2ZW50LmNsaWVudFgsIHk6IGV2ZW50LmNsaWVudFkgfTtcbiAgICAgIGNvbnN0IGRlbHRhID0ge1xuICAgICAgICB4OiBzYXZlZC5jdXJyZW50UG9zLnggLSBjdXJyZW50LngsXG4gICAgICAgIHk6IHNhdmVkLmN1cnJlbnRQb3MueSAtIGN1cnJlbnQueSxcbiAgICAgIH07XG4gICAgICBvbk1vdmUoZGVsdGEpO1xuICAgIH1cbiAgfVxuXG4gIGhhbmRsZVVwKGV2ZW50OiBQb2ludGVyRXZlbnQpIHtcbiAgICB0aGlzLmRyYWdUeXBlID0gXCJub25lXCI7XG4gICAgKGV2ZW50LnRhcmdldCBhcyBFbGVtZW50KS5yZWxlYXNlUG9pbnRlckNhcHR1cmUoZXZlbnQucG9pbnRlcklkKTtcbiAgfVxuXG4gIG1vdmVDYW52YXMoZGVsdGE6IE9mZnNldCkge1xuICAgIHRoaXMub2Zmc2V0LnggKz0gZGVsdGEueDtcbiAgICB0aGlzLm9mZnNldC55ICs9IGRlbHRhLnk7XG4gICAgdGhpcy5yb290LnN0eWxlLnNldFByb3BlcnR5KFwiLS1vZmZzZXQteFwiLCBgJHt0aGlzLm9mZnNldC54fXB4YCk7XG4gICAgdGhpcy5yb290LnN0eWxlLnNldFByb3BlcnR5KFwiLS1vZmZzZXQteVwiLCBgJHt0aGlzLm9mZnNldC55fXB4YCk7XG4gIH1cblxuICBtb3ZlRWxlbWVudChjaGlsZDogU3VwcG9ydGVkTm9kZSwgZGVsdGE6IE9mZnNldCkge1xuICAgIGNvbnN0IGdldE51bWJlciA9IChrZXk6IFwiLS1keFwiIHwgXCItLWR5XCIsIGZhbGxiYWNrOiBudW1iZXIpID0-IHtcbiAgICAgIGNvbnN0IHNhdmVkID0gY2hpbGQuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShrZXkpO1xuICAgICAgaWYgKHNhdmVkLmxlbmd0aCA-IDApIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoc2F2ZWQucmVwbGFjZShcInB4XCIsIFwiXCIpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxsYmFjaztcbiAgICB9O1xuICAgIGNvbnN0IGR4ID0gZ2V0TnVtYmVyKFwiLS1keFwiLCAwKSArIGRlbHRhLng7XG4gICAgY29uc3QgZHkgPSBnZXROdW1iZXIoXCItLWR5XCIsIDApICsgZGVsdGEueTtcbiAgICBjaGlsZC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCR7ZHh9cHgsICR7ZHl9cHgpYDtcbiAgICBjaGlsZC5zdHlsZS5zZXRQcm9wZXJ0eShcIi0tZHhcIiwgYCR7ZHh9cHhgKTtcbiAgICBjaGlsZC5zdHlsZS5zZXRQcm9wZXJ0eShcIi0tZHlcIiwgYCR7ZHl9cHhgKTtcbiAgfVxuXG4gIGFzeW5jIGZpcnN0VXBkYXRlZCgpIHtcbiAgICBjb25zdCBpdGVtcyA9IEFycmF5LmZyb20odGhpcy5jaGlsZE5vZGVzKTtcbiAgICBsZXQgaSA9IDA7XG4gICAgZm9yIChjb25zdCBub2RlIG9mIGl0ZW1zKSB7XG4gICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIFNWR0VsZW1lbnQgfHwgbm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGNoaWxkID0gbm9kZSBhcyBTdXBwb3J0ZWROb2RlO1xuICAgICAgICBjaGlsZC5jbGFzc0xpc3QuYWRkKFwiY2hpbGRcIik7XG4gICAgICAgIGNoaWxkLnN0eWxlLnNldFByb3BlcnR5KFwiLS1sYXllclwiLCBgJHtpfWApO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmQoY2hpbGQpO1xuICAgICAgICBjaGlsZC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIiwgKGU6IGFueSkgPT4ge1xuICAgICAgICAgIHRoaXMuaGFuZGxlRG93bihlLCBcImVsZW1lbnRcIik7XG4gICAgICAgIH0pO1xuICAgICAgICBjaGlsZC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIiwgKGU6IGFueSkgPT4ge1xuICAgICAgICAgIHRoaXMuaGFuZGxlTW92ZShlLCBcImVsZW1lbnRcIiwgKGRlbHRhKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm1vdmVFbGVtZW50KGNoaWxkLCBkZWx0YSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpKys7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMucmVxdWVzdFVwZGF0ZSgpO1xuICAgIHRoaXMucm9vdC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIiwgKGU6IGFueSkgPT4ge1xuICAgICAgdGhpcy5oYW5kbGVEb3duKGUsIFwiY2FudmFzXCIpO1xuICAgIH0pO1xuICAgIHRoaXMucm9vdC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIiwgKGU6IGFueSkgPT4ge1xuICAgICAgdGhpcy5oYW5kbGVNb3ZlKGUsIFwiY2FudmFzXCIsIChkZWx0YSkgPT4ge1xuICAgICAgICB0aGlzLm1vdmVDYW52YXMoZGVsdGEpO1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgQXJyYXkuZnJvbSh0aGlzLmNvbnRhaW5lci5jaGlsZHJlbikpIHtcbiAgICAgICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIFNWR0VsZW1lbnQgfHwgbm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLm1vdmVFbGVtZW50KG5vZGUsIGRlbHRhKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHRoaXMucm9vdC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsIChlOiBhbnkpID0-IHtcbiAgICAgIHRoaXMuaGFuZGxlVXAoZSk7XG4gICAgfSk7XG4gIH1cbn1cblxuaW50ZXJmYWNlIE9mZnNldCB7XG4gIHg6IG51bWJlcjtcbiAgeTogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgUG9pbnRlckRhdGEge1xuICBpZDogbnVtYmVyO1xuICBzdGFydFBvczogT2Zmc2V0O1xuICBjdXJyZW50UG9zOiBPZmZzZXQ7XG59XG4ifSx7Im5hbWUiOiJpbmRleC5odG1sIiwiY29udGVudCI6IjwhRE9DVFlQRSBodG1sPlxuPGh0bWwgbGFuZz1cImVuXCI-XG4gIDxoZWFkPlxuICAgIDxtZXRhIGNoYXJzZXQ9XCJVVEYtOFwiIC8-XG4gICAgPGxpbmsgcmVsPVwiaWNvblwiIHR5cGU9XCJpbWFnZS9zdmcreG1sXCIgaHJlZj1cIi9zcmMvZmF2aWNvbi5zdmdcIiAvPlxuICAgIDxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wXCIgLz5cbiAgICA8dGl0bGU-TGl0IENTUyBDYW52YXM8L3RpdGxlPlxuICAgIDxzdHlsZT5cbiAgICAgIGJvZHkge1xuICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICBoZWlnaHQ6IDEwMHZoO1xuICAgICAgfVxuICAgIDwvc3R5bGU-XG4gICAgPHNjcmlwdCB0eXBlPVwibW9kdWxlXCIgc3JjPVwiLi9saXQtY3NzLWNhbnZhcy5qc1wiPjwvc2NyaXB0PlxuICA8L2hlYWQ-XG4gIDxib2R5PlxuICAgIDxjc3MtY2FudmFzPlxuICAgICAgPGltZ1xuICAgICAgICBzcmM9XCJodHRwczovL2xpdC5kZXYvaW1hZ2VzL2xvZ28uc3ZnXCJcbiAgICAgICAgYWx0PVwiTGl0IExvZ29cIlxuICAgICAgICB3aWR0aD1cIjUwMFwiXG4gICAgICAgIGhlaWdodD1cIjMzM1wiXG4gICAgICAgIHN0eWxlPVwiLS1keDogNTkuNDkwOXB4OyAtLWR5OiAzMi44NDI5cHhcIlxuICAgICAgLz5cbiAgICAgIDxzdmcgd2lkdGg9XCI0MDBcIiBoZWlnaHQ9XCIxMTBcIiBzdHlsZT1cIi0tZHg6IDIzMC4wNTdweDsgLS1keTogMzMuNjI1N3B4XCI-XG4gICAgICAgIDxyZWN0XG4gICAgICAgICAgd2lkdGg9XCI0MDBcIlxuICAgICAgICAgIGhlaWdodD1cIjEwMFwiXG4gICAgICAgICAgc3R5bGU9XCJmaWxsOiByZ2IoMCwgMCwgMjU1KTsgc3Ryb2tlLXdpZHRoOiAzOyBzdHJva2U6IHJnYigwLCAwLCAwKVwiXG4gICAgICAgIC8-XG4gICAgICA8L3N2Zz5cbiAgICAgIDxzdmcgaGVpZ2h0PVwiMTAwXCIgd2lkdGg9XCIxMDBcIj5cbiAgICAgICAgPGNpcmNsZVxuICAgICAgICAgIGN4PVwiNTBcIlxuICAgICAgICAgIGN5PVwiNTBcIlxuICAgICAgICAgIHI9XCI0MFwiXG4gICAgICAgICAgc3Ryb2tlPVwiYmxhY2tcIlxuICAgICAgICAgIHN0cm9rZS13aWR0aD1cIjNcIlxuICAgICAgICAgIGZpbGw9XCJyZWRcIlxuICAgICAgICAvPlxuICAgICAgPC9zdmc-XG4gICAgPC9jc3MtY2FudmFzPlxuICA8L2JvZHk-XG48L2h0bWw-XG4ifV0">here</a>.<p>The source for this example can be found <a href=https://github.com/rodydavis/lit-css-canvas>here</a>.<h1></h1><p>Since you've made it this far, <a href=https://rodydavis.com/posts/lit-css-canvas/ on-click=share>sharing</a> this article on your favorite social media network would be highly appreciated ! For feedback, please <a href=https://twitter.com/rodydavis rel=noopener target=_blank>ping me on Twitter.</a></p><share-widget><button aria-label=Share href=https://rodydavis.com/posts/lit-css-canvas/ on-click=share><div></div></button></share-widget><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","headline":"CSS Canvas with Lit","image":["https://rodydavis.com/img/css-canvas/canvas-1920w.jpg"],"author":"Rody Davis","genre":"https://schema.org/Code","publisher":{"@type":"Organization","name":"Rody Davis","logo":{"@type":"ImageObject","url":"/img/favicon/favicon-32x32.png?hash=3df5885280"}},"url":"https://rodydavis.com/posts/lit-css-canvas/","mainEntityOfPage":"https://rodydavis.com/posts/lit-css-canvas/","datePublished":"2021-06-23","dateModified":"2021-07-08","description":"In this article I will go over how to set up a Lit web component and use it to create a interactive canvas with CSS transforms and slots...."}</script><p>Published <time datetime=2021-06-23>23 Jun 2021</time></article></main><footer><a href=https://twitter.com/rodydavis class="fab fa-twitter" rel="noopener noreferrer" target=_blank></a> <a href=https://facebook.com/rodydavisjr class="fab fa-facebook" rel="noopener noreferrer" target=_blank></a> <a href=https://www.linkedin.com/in/rodydavis class="fab fa-linkedin" rel="noopener noreferrer" target=_blank></a> <a href=https://www.youtube.com/rodydavis class="fab fa-youtube" rel="noopener noreferrer" target=_blank></a> <a href=https://www.instagram.com/rodydavisjr class="fab fa-instagram" rel="noopener noreferrer" target=_blank></a> <a href=https://www.github.com/rodydavis class="fab fa-github" rel="noopener noreferrer" target=_blank></a> <a href=https://www.tiktok.com/@rodydavisjr class="fab fa-tiktok" rel="noopener noreferrer" target=_blank></a></footer><script src="https://www.googletagmanager.com/gtag/js?id=G-JQNPVBL9DR" async></script><script>window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'G-JQNPVBL9DR');</script>