<!DOCTYPE html>
<html lang="en" class="astro-MDYSN4OI">
  <head>
    <!-- Global Metadata --><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<meta name="generator" content="Astro v2.0.4">

<!-- Canonical URL -->
<link rel="canonical" href="https://rodydavis.com/posts/flutter-graph-database/">

<!-- Primary Meta Tags -->
<title>How to build a graph database with Flutter</title>
<meta name="title" content="How to build a graph database with Flutter">
<meta name="description">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://rodydavis.com/posts/flutter-graph-database/">
<meta property="og:title" content="How to build a graph database with Flutter">
<meta property="og:description">
<meta property="og:image" content="https://rodydavis.com/placeholder-social.jpg">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://rodydavis.com/posts/flutter-graph-database/">
<meta property="twitter:title" content="How to build a graph database with Flutter">
<meta property="twitter:description">
<meta property="twitter:image" content="https://rodydavis.com/placeholder-social.jpg">
    
  <link rel="stylesheet" href="/_astro/_...slug_.b1abaa8d.css" />
<link rel="stylesheet" href="/_astro/_...slug_.7a06253d.css" /></head>

  <body class="markdown-body astro-MDYSN4OI">
    <header class="astro-3EF6KSR2">
  <h2 class="astro-3EF6KSR2">
    <a href="/" class="astro-3EF6KSR2">Rody Davis</a>
  </h2>
  <nav class="astro-3EF6KSR2">
    <a href="/search?tags=app" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> Apps</div>
</a><a href="/search?tags=posts" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> Blog</div>
</a><a href="/talks" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> Talks</div>
</a><a href="/about" class="astro-3EF6KSR2 astro-EIMMU3LG" style="display:flex;flex-direction:row;align-items:center">
  
  <div class="astro-EIMMU3LG"> About</div>
</a>
  </nav>
</header>
    <main class="astro-MDYSN4OI">
      <style>
	@media (min-width: 860px) {
		main {
			display: flex;
			flex-direction: row;
			justify-content: space-between;
		}
		article {
			flex: 1;
		}
		aside {
			display: block;
			position: sticky;
			top: 0;
			right: 0;
			max-height: 100vh;
			overflow-y: auto;
		}
	}
	</style><main class="astro-BVZIHDZO">
    <article class="astro-BVZIHDZO">
      
      <h1 class="title astro-BVZIHDZO">How to build a graph database with Flutter</h1>
      
      
      <hr class="astro-BVZIHDZO">
      <p>In this article I will go over how to create and use a graph database with <a href="https://flutter.dev">Flutter</a>.</p>
<p><strong>TLDR</strong> The final source <a href="https://github.com/rodydavis/flutter_graph_database">here</a> and an online <a href="https://rodydavis.github.io/flutter_graph_database/">demo</a>.</p>
<h2 id=""><a aria-hidden="true" tabindex="-1" href="#"><span class="icon icon-link"></span></a>Prerequisites</h2>
<p>Flutter installed and setup (Refer to this <a href="https://rodydavis.com/posts/first-flutter-project/">article</a> if you need help).</p>
<p>Basic knowledge of <a href="https://www.sqlite.org/index.html">SQLite</a>.</p>
<p>Basic knowledge of Graph Databases (Refer to this <a href="https://www.youtube.com/watch?v=GekQqFZm7mA">video</a> if you need to learn more).</p>
<h2 id="-1"><a aria-hidden="true" tabindex="-1" href="#-1"><span class="icon icon-link"></span></a>Overview</h2>
<p>First of all, why do we need a graph database when other storage options exist?</p>
<p>Why not use key value stores, document stores, or relational databases?</p>
<p>Well, the answer is that it depends on the problem you are trying to solve.</p>
<p>Graph databases are great for modeling relationships between data.</p>
<p>A couple examples:</p>
<ul>
<li>A social network app can model the relationships between users and posts</li>
<li>A game can model the relationships between players and items</li>
<li>A blog can model the relationships between posts and comments</li>
</ul>
<p>The possibilities are endless.</p>
<p>Instead of storing data in a table for each collection we store the data as a graph in a nodes and edges table with some additional extensions in SQLite to make it easier.</p>
<p>Here is a <a href="https://www.hytradboi.com/2022/simple-graph-sqlite-as-probably-the-only-graph-database-youll-ever-need">page</a> that goes in to detail about it and showcases what we are trying to build.</p>
<h2 id="-2"><a aria-hidden="true" tabindex="-1" href="#-2"><span class="icon icon-link"></span></a>Getting Started</h2>
<p>First we need to create a new Flutter project.</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">mkdir flutter_graph_database</span></span>
<span class="line"><span style="color: #79C0FF">cd</span><span style="color: #C9D1D9"> flutter_graph_database</span></span>
<span class="line"><span style="color: #C9D1D9">flutter create </span><span style="color: #79C0FF">.</span></span></code></pre>
<p>After the project is created open it in your favorite code editor.</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">code </span><span style="color: #79C0FF">.</span></span></code></pre>
<h2 id="-3"><a aria-hidden="true" tabindex="-1" href="#-3"><span class="icon icon-link"></span></a>Creating the Database</h2>
<p>We are going to use the <a href="hhttps://pub.dev/packages/drift">drift</a> package to create the database.</p>
<p>Update the <strong>pubspec.yaml</strong> file with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #7EE787">name</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">flutter_graph_database</span></span>
<span class="line"><span style="color: #7EE787">description</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">A new Flutter package project.</span></span>
<span class="line"><span style="color: #7EE787">version</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">0.0.1</span></span>
<span class="line"><span style="color: #7EE787">publish_to</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">none</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7EE787">environment</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">sdk</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">">=2.19.0-238.0.dev &#x3C;3.0.0"</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">flutter</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">">=1.17.0"</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7EE787">dependencies</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">flutter</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">sdk</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">flutter</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">drift</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^2.1.0</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">sqlite3_flutter_libs</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^0.5.5</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">http</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^0.13.5</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">path_provider</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^2.0.0</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">path</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^1.8.2</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">sqlite3</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^1.7.0</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7EE787">dev_dependencies</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">flutter_test</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">sdk</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">flutter</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">flutter_lints</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^2.0.0</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">build_runner</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^2.2.0</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">drift_dev</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">^2.1.0</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7EE787">flutter</span><span style="color: #C9D1D9">:</span></span>
<span class="line"></span></code></pre>
<h3 id="-4"><a aria-hidden="true" tabindex="-1" href="#-4"><span class="icon icon-link"></span></a>Database Connection</h3>
<p>Next we need to create the database.</p>
<p>Create a new file at <strong>lib/database/connection/unsupported.dart</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:drift/drift.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:drift/native.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">DatabaseConnection</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">connect</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9"> dbName, {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> useWebWorker </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> logStatements </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">}) {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">DatabaseConnection</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">NativeDatabase</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">memory</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">    logStatements</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> logStatements,</span></span>
<span class="line"><span style="color: #C9D1D9">  ));</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span></code></pre>
<p>Create a new file at <strong>lib/database/connection/native.dart</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dart:io'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dart:isolate'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:drift/drift.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:drift/isolate.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:drift/native.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:path_provider/path_provider.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:path/path.dart'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> p;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">DatabaseConnection</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">connect</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9"> dbName, {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> useWebWorker </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> logStatements </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">}) {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">DatabaseConnection</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">delayed</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Future</span><span style="color: #C9D1D9">.</span><span style="color: #FF7B72">sync</span><span style="color: #C9D1D9">(() </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> appDir </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getApplicationDocumentsDirectory</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> dbPath </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> p.</span><span style="color: #D2A8FF">join</span><span style="color: #C9D1D9">(appDir.path, dbName);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> receiveDriftIsolate </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ReceivePort</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Isolate</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">spawn</span><span style="color: #C9D1D9">(_entrypointForDriftIsolate,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #79C0FF">_IsolateStartRequest</span><span style="color: #C9D1D9">(receiveDriftIsolate.sendPort, dbPath));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> driftIsolate </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> receiveDriftIsolate.first </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">DriftIsolate</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> driftIsolate.</span><span style="color: #D2A8FF">connect</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">  }));</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">_IsolateStartRequest</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">SendPort</span><span style="color: #C9D1D9"> talkToMain;</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9"> databasePath;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">_IsolateStartRequest</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.talkToMain, </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.databasePath);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">_entrypointForDriftIsolate</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">_IsolateStartRequest</span><span style="color: #C9D1D9"> request) {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> databaseImpl </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">NativeDatabase</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">File</span><span style="color: #C9D1D9">(request.databasePath),</span></span>
<span class="line"><span style="color: #C9D1D9">    logStatements</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  );</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> driftServer </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">DriftIsolate</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">inCurrent</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">    () </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">DatabaseConnection</span><span style="color: #C9D1D9">(databaseImpl),</span></span>
<span class="line"><span style="color: #C9D1D9">  );</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  request.talkToMain.</span><span style="color: #D2A8FF">send</span><span style="color: #C9D1D9">(driftServer);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span></code></pre>
<p>Create a new file at <strong>lib/database/connection/web.dart</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dart:async'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// ignore: avoid_web_libraries_in_flutter</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dart:html'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:drift/drift.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:drift/remote.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:drift/web.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:drift/wasm.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:http/http.dart'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> http;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:sqlite3/wasm.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #79C0FF">DatabaseConnection</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">connect</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9"> dbName, {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> useWebWorker </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> logStatements </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">}) {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (useWebWorker) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> worker </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">SharedWorker</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'shared_worker.dart.js'</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">remote</span><span style="color: #C9D1D9">(worker.port</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">channel</span><span style="color: #C9D1D9">());</span></span>
<span class="line"><span style="color: #C9D1D9">  } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">DatabaseConnection</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">delayed</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Future</span><span style="color: #C9D1D9">.</span><span style="color: #FF7B72">sync</span><span style="color: #C9D1D9">(() </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> response </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> http.</span><span style="color: #FF7B72">get</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Uri</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">parse</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'sqlite3.wasm'</span><span style="color: #C9D1D9">));</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> fs </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">IndexedDbFileSystem</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">open</span><span style="color: #C9D1D9">(dbName</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'/db/'</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> path </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'/drift/db/$</span><span style="color: #79C0FF">dbName</span><span style="color: #A5D6FF">'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> sqlite3 </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">WasmSqlite3</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">load</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        response.bodyBytes,</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #79C0FF">SqliteEnvironment</span><span style="color: #C9D1D9">(fileSystem</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> fs),</span></span>
<span class="line"><span style="color: #C9D1D9">      );</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> databaseImpl </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">WasmDatabase</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        sqlite3</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> sqlite3,</span></span>
<span class="line"><span style="color: #C9D1D9">        path</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> path,</span></span>
<span class="line"><span style="color: #C9D1D9">        fileSystem</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> fs, </span><span style="color: #8B949E">// &#x3C;- this is required but not documented</span></span>
<span class="line"><span style="color: #C9D1D9">        logStatements</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> logStatements,</span></span>
<span class="line"><span style="color: #C9D1D9">      );</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">DatabaseConnection</span><span style="color: #C9D1D9">(databaseImpl);</span></span>
<span class="line"><span style="color: #C9D1D9">    }));</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span></code></pre>
<p>Create a new file at <strong>lib/database/connection/connection.dart</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">export</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'unsupported.dart'</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (dart.library.js) </span><span style="color: #A5D6FF">'web.dart'</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (dart.library.ffi) </span><span style="color: #A5D6FF">'native.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span></code></pre>
<h3 id="-5"><a aria-hidden="true" tabindex="-1" href="#-5"><span class="icon icon-link"></span></a>Database SQL Files</h3>
<h4 id="-6"><a aria-hidden="true" tabindex="-1" href="#-6"><span class="icon icon-link"></span></a>Schema</h4>
<p>Create a new file at <strong>lib/database/sql/schema.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">CREATE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TABLE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">IF</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">NOT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">EXISTS</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> (</span></span>
<span class="line"><span style="color: #C9D1D9">    body </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    id   </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">GENERATED</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">ALWAYS</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> (json_extract(body, </span><span style="color: #A5D6FF">'$.id'</span><span style="color: #C9D1D9">)) VIRTUAL </span><span style="color: #FF7B72">NOT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">NULL</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">UNIQUE</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">CREATE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">INDEX</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">IF</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">NOT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">EXISTS</span><span style="color: #C9D1D9"> id_idx </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9">(id);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">CREATE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TABLE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">IF</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">NOT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">EXISTS</span><span style="color: #C9D1D9"> edges (</span></span>
<span class="line"><span style="color: #C9D1D9">    source     </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9">     </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    properties </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">UNIQUE</span><span style="color: #C9D1D9">(source, </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9">, properties) </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> CONFLICT </span><span style="color: #79C0FF">REPLACE</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">FOREIGN KEY</span><span style="color: #C9D1D9">(source) </span><span style="color: #FF7B72">REFERENCES</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9">(id),</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">FOREIGN KEY</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">REFERENCES</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9">(id)</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">CREATE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">INDEX</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">IF</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">NOT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">EXISTS</span><span style="color: #C9D1D9"> source_idx </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> edges(source);</span></span>
<span class="line"><span style="color: #FF7B72">CREATE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">INDEX</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">IF</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">NOT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">EXISTS</span><span style="color: #C9D1D9"> target_idx </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> edges(</span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9">);</span></span></code></pre>
<blockquote>
<p>The ID column is a virtual column that is generated from the body column. This is done so that we can query the database by ID without having to parse the JSON body column.</p>
</blockquote>
<h4 id="-7"><a aria-hidden="true" tabindex="-1" href="#-7"><span class="icon icon-link"></span></a>Queries</h4>
<p>Create a new file at <strong>lib/database/sql/queries.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">getAllNodes: </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">getAllEdges: </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges;</span></span></code></pre>
<h4 id="-8"><a aria-hidden="true" tabindex="-1" href="#-8"><span class="icon icon-link"></span></a>Delete Edge</h4>
<p>Create a new file at <strong>lib/database/sql/delete-edge.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">deleteEdge:</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">DELETE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">WHERE</span><span style="color: #C9D1D9"> source </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ? </span><span style="color: #FF7B72">OR</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ?;</span></span></code></pre>
<h4 id="-9"><a aria-hidden="true" tabindex="-1" href="#-9"><span class="icon icon-link"></span></a>Delete Node</h4>
<p>Create a new file at <strong>lib/database/sql/delete-node.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">deleteNode: </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">DELETE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">WHERE</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ?;</span></span></code></pre>
<h4 id="-10"><a aria-hidden="true" tabindex="-1" href="#-10"><span class="icon icon-link"></span></a>Insert Edge</h4>
<p>Create a new file at <strong>lib/database/sql/insert-edge.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">insertEdge(:source </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">, :</span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">, :body </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">): </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">INSERT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">INTO</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">VALUES</span><span style="color: #C9D1D9">(:source, :</span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9">, </span><span style="color: #FF7B72">json</span><span style="color: #C9D1D9">(:body));</span></span></code></pre>
<h4 id="-11"><a aria-hidden="true" tabindex="-1" href="#-11"><span class="icon icon-link"></span></a>Insert Node</h4>
<p>Create a new file at <strong>lib/database/sql/insert-node.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">insertNode(:body </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">): </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">INSERT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">INTO</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">VALUES</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">json</span><span style="color: #C9D1D9">(:</span><span style="color: #FF7B72">text</span><span style="color: #C9D1D9">));</span></span></code></pre>
<h4 id="-12"><a aria-hidden="true" tabindex="-1" href="#-12"><span class="icon icon-link"></span></a>Search Edges Inbound</h4>
<p>Create a new file at <strong>lib/database/sql/search-edges-inbound.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">searchEdgesInbound: </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">WHERE</span><span style="color: #C9D1D9"> source </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ?;</span></span></code></pre>
<h4 id="-13"><a aria-hidden="true" tabindex="-1" href="#-13"><span class="icon icon-link"></span></a>Search Edges Outbound</h4>
<p>Create a new file at <strong>lib/database/sql/search-edges-outbound.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">searchEdgesOutbound: </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">WHERE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ?;</span></span></code></pre>
<h4 id="-14"><a aria-hidden="true" tabindex="-1" href="#-14"><span class="icon icon-link"></span></a>Search Edges</h4>
<p>Create a new file at <strong>lib/database/sql/search-edges.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">searchEdges: </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">WHERE</span><span style="color: #C9D1D9"> source </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ? </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">UNION</span><span style="color: #C9D1D9"> </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">WHERE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ?;</span></span></code></pre>
<h4 id="-15"><a aria-hidden="true" tabindex="-1" href="#-15"><span class="icon icon-link"></span></a>Search Node By ID</h4>
<p>Create a new file at <strong>lib/database/sql/search-node-by-id.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">searchNodeById: </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> body </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">WHERE</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ?;</span></span></code></pre>
<h4 id="-16"><a aria-hidden="true" tabindex="-1" href="#-16"><span class="icon icon-link"></span></a>Search Node</h4>
<p>Create a new file at <strong>lib/database/sql/search-node.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">-- Create a text index of entries, see https://www.sqlite.org/fts5.html#external_content_tables</span></span>
<span class="line"><span style="color: #FF7B72">CREATE</span><span style="color: #C9D1D9"> VIRTUAL </span><span style="color: #FF7B72">TABLE</span><span style="color: #C9D1D9"> node_entries </span><span style="color: #FF7B72">USING</span><span style="color: #C9D1D9"> fts5 (</span></span>
<span class="line"><span style="color: #C9D1D9">    body,</span></span>
<span class="line"><span style="color: #C9D1D9">    content</span><span style="color: #FF7B72">=</span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    content_rowid</span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9">id</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">-- Triggers to keep entries and fts5 index in sync.</span></span>
<span class="line"><span style="color: #FF7B72">CREATE</span><span style="color: #C9D1D9"> TRIGGER nodes_insert </span><span style="color: #FF7B72">AFTER</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">INSERT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">BEGIN</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">INSERT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">INTO</span><span style="color: #C9D1D9"> node_entries(rowid, body) </span><span style="color: #FF7B72">VALUES</span><span style="color: #C9D1D9"> (</span><span style="color: #79C0FF">new</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">id</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">new</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">body</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">END</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">CREATE</span><span style="color: #C9D1D9"> TRIGGER nodes_delete </span><span style="color: #FF7B72">AFTER</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">DELETE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">BEGIN</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">INSERT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">INTO</span><span style="color: #C9D1D9"> node_entries(node_entries, rowid, body) </span><span style="color: #FF7B72">VALUES</span><span style="color: #C9D1D9"> (</span><span style="color: #A5D6FF">'delete'</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">old</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">id</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">old</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">body</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">END</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">CREATE</span><span style="color: #C9D1D9"> TRIGGER nodes_update </span><span style="color: #FF7B72">AFTER</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">UPDATE</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">BEGIN</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">INSERT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">INTO</span><span style="color: #C9D1D9"> node_entries(node_entries, rowid, body) </span><span style="color: #FF7B72">VALUES</span><span style="color: #C9D1D9"> (</span><span style="color: #A5D6FF">'delete'</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">new</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">id</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">new</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">body</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">INSERT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">INTO</span><span style="color: #C9D1D9"> node_entries(rowid, body) </span><span style="color: #FF7B72">VALUES</span><span style="color: #C9D1D9"> (</span><span style="color: #79C0FF">new</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">id</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">new</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">body</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">END</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">-- Full text search query.</span></span>
<span class="line"><span style="color: #C9D1D9">searchNode: </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> r.</span><span style="color: #FF7B72">**</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> node_entries</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">INNER JOIN</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> r </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">r</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">id</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">node_entries</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">rowid</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">WHERE</span><span style="color: #C9D1D9"> node_entries MATCH :query</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">ORDER BY</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">rank</span><span style="color: #C9D1D9">;</span></span></code></pre>
<blockquote>
<p>Here we are using the <a href="https://www.sqlite.org/fts5.html">fts5</a> extension to create a full text search index. This is a very powerful feature that allows us to search for nodes by their body text.</p>
</blockquote>
<h4 id="-17"><a aria-hidden="true" tabindex="-1" href="#-17"><span class="icon icon-link"></span></a>Traverse Inbound</h4>
<p>Create a new file at <strong>lib/database/sql/traverse-inbound.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">traverseInbound(:source </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">): </span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">WITH</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">RECURSIVE</span><span style="color: #C9D1D9"> traverse(id) </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> (</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> :source</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">UNION</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> source </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">JOIN</span><span style="color: #C9D1D9"> traverse </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> id</span></span>
<span class="line"><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> traverse;</span></span></code></pre>
<h4 id="-18"><a aria-hidden="true" tabindex="-1" href="#-18"><span class="icon icon-link"></span></a>Traverse Outbound</h4>
<p>Create a new file at <strong>lib/database/sql/traverse-outbound.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">traverseOutbound(:source </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">): </span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">WITH</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">RECURSIVE</span><span style="color: #C9D1D9"> traverse(id) </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> (</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> :source</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">UNION</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">JOIN</span><span style="color: #C9D1D9"> traverse </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> source </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> id</span></span>
<span class="line"><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> traverse;</span></span></code></pre>
<h4 id="-19"><a aria-hidden="true" tabindex="-1" href="#-19"><span class="icon icon-link"></span></a>Traverse Bodies Inbound</h4>
<p>Create a new file at <strong>lib/database/sql/traverse-with-bodies-inbound.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">traverseWithBodiesInbound(:source </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">): </span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">WITH</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">RECURSIVE</span><span style="color: #C9D1D9"> traverse(x, y, obj) </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> (</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> :source, </span><span style="color: #A5D6FF">'()'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">'{}'</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">UNION</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> id, </span><span style="color: #A5D6FF">'()'</span><span style="color: #C9D1D9">, body </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">JOIN</span><span style="color: #C9D1D9"> traverse </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> x</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">UNION</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> source, </span><span style="color: #A5D6FF">'&#x3C;-'</span><span style="color: #C9D1D9">, properties </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">JOIN</span><span style="color: #C9D1D9"> traverse </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> x</span></span>
<span class="line"><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> x, y, obj </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> traverse;</span></span></code></pre>
<h4 id="-20"><a aria-hidden="true" tabindex="-1" href="#-20"><span class="icon icon-link"></span></a>Traverse Bodies Outbound</h4>
<p>Create a new file at <strong>lib/database/sql/traverse-with-bodies-outbound.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">traverseWithBodiesOutbound(:source </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">): </span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">WITH</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">RECURSIVE</span><span style="color: #C9D1D9"> traverse(x, y, obj) </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> (</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> :source, </span><span style="color: #A5D6FF">'()'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">'{}'</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">UNION</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> id, </span><span style="color: #A5D6FF">'()'</span><span style="color: #C9D1D9">, body </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">JOIN</span><span style="color: #C9D1D9"> traverse </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> x</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">UNION</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">'->'</span><span style="color: #C9D1D9">, properties </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">JOIN</span><span style="color: #C9D1D9"> traverse </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> source </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> x</span></span>
<span class="line"><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> x, y, obj </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> traverse;</span></span></code></pre>
<h4 id="-21"><a aria-hidden="true" tabindex="-1" href="#-21"><span class="icon icon-link"></span></a>Traverse Bodies</h4>
<p>Create a new file at <strong>lib/database/sql/traverse-bodies.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">traverseWithBodies(:source </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">): </span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">WITH</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">RECURSIVE</span><span style="color: #C9D1D9"> traverse(x, y, obj) </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> (</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> :source, </span><span style="color: #A5D6FF">'()'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">'{}'</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">UNION</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> id, </span><span style="color: #A5D6FF">'()'</span><span style="color: #C9D1D9">, body </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">JOIN</span><span style="color: #C9D1D9"> traverse </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> x</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">UNION</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> source, </span><span style="color: #A5D6FF">'&#x3C;-'</span><span style="color: #C9D1D9">, properties </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">JOIN</span><span style="color: #C9D1D9"> traverse </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> x</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">UNION</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">'->'</span><span style="color: #C9D1D9">, properties </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">JOIN</span><span style="color: #C9D1D9"> traverse </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> source </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> x</span></span>
<span class="line"><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> x, y, obj </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> traverse;</span></span></code></pre>
<h4 id="-22"><a aria-hidden="true" tabindex="-1" href="#-22"><span class="icon icon-link"></span></a>Traverse</h4>
<p>Create a new file at <strong>lib/database/sql/traverse.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">traverse(:source </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">TEXT</span><span style="color: #C9D1D9">): </span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">WITH</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">RECURSIVE</span><span style="color: #C9D1D9"> traverse(id) </span><span style="color: #FF7B72">AS</span><span style="color: #C9D1D9"> (</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> :source</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">UNION</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> source </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">JOIN</span><span style="color: #C9D1D9"> traverse </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> id</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">UNION</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">target</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">JOIN</span><span style="color: #C9D1D9"> traverse </span><span style="color: #FF7B72">ON</span><span style="color: #C9D1D9"> source </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> id</span></span>
<span class="line"><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">SELECT</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">FROM</span><span style="color: #C9D1D9"> traverse;</span></span></code></pre>
<h4 id="-23"><a aria-hidden="true" tabindex="-1" href="#-23"><span class="icon icon-link"></span></a>Update Node</h4>
<p>Create a new file at <strong>lib/database/sql/update-node.drift</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">import </span><span style="color: #A5D6FF">'schema.drift'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">updateNode: </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">UPDATE</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">nodes</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">SET</span><span style="color: #C9D1D9"> body </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">json</span><span style="color: #C9D1D9">(?) </span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">WHERE</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> ?;</span></span></code></pre>
<h3 id="-24"><a aria-hidden="true" tabindex="-1" href="#-24"><span class="icon icon-link"></span></a>Database Setup</h3>
<p>Create a new file at <strong>lib/database/database.dart</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dart:convert'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:drift/drift.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:flutter/foundation.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'connection/connection.dart'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> impl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">part</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'database.g.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">@DriftDatabase</span><span style="color: #C9D1D9">(include</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/schema.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/queries.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/delete-edge.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/delete-node.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/insert-edge.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/insert-node.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/search-edges-inbound.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/search-edges-outbound.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/search-edges.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/search-node-by-id.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/search-node.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/traverse-inbound.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/traverse-outbound.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/traverse-with-bodies-inbound.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/traverse-with-bodies-outbound.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/traverse-with-bodies.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/traverse.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #A5D6FF">'sql/update-node.drift'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">})</span></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">GraphDatabase</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">extends</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">_$GraphDatabase</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">GraphDatabase</span><span style="color: #C9D1D9">({</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9"> dbName </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'graph_db.db'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">DatabaseConnection</span><span style="color: #FF7B72">?</span><span style="color: #C9D1D9"> connection,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> useWebWorker </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> logStatements </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  }) </span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">super</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">connect</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">          connection </span><span style="color: #FF7B72">??</span></span>
<span class="line"><span style="color: #C9D1D9">              impl.</span><span style="color: #D2A8FF">connect</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">                dbName,</span></span>
<span class="line"><span style="color: #C9D1D9">                useWebWorker</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> useWebWorker,</span></span>
<span class="line"><span style="color: #C9D1D9">                logStatements</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> logStatements,</span></span>
<span class="line"><span style="color: #C9D1D9">              ),</span></span>
<span class="line"><span style="color: #C9D1D9">        );</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">int</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">get</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">schemaVersion</span><span style="color: #C9D1D9"> => </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #8B949E">/// Helper method to add graph data from json</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Future</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">addGraphData</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">Map</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">dynamic</span><span style="color: #C9D1D9">> data, {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> shouldBatch </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  }) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">transaction</span><span style="color: #C9D1D9">(() </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">try</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> localNodes </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> data[</span><span style="color: #A5D6FF">'nodes'</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">List</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">dynamic</span><span style="color: #C9D1D9">>;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> localEdges </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> data[</span><span style="color: #A5D6FF">'edges'</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">List</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">dynamic</span><span style="color: #C9D1D9">>;</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">// Update nodes</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> node </span><span style="color: #FF7B72">in</span><span style="color: #C9D1D9"> localNodes) {</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> id </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> node[</span><span style="color: #A5D6FF">'id'</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">String</span><span style="color: #FF7B72">?</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (id </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> current </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">searchNodeById</span><span style="color: #C9D1D9">(id).</span><span style="color: #D2A8FF">getSingleOrNull</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> body </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">jsonEncode</span><span style="color: #C9D1D9">(node);</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (current </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">              </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">updateNode</span><span style="color: #C9D1D9">(id, body);</span></span>
<span class="line"><span style="color: #C9D1D9">            } </span><span style="color: #FF7B72">else</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">              </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">insertNode</span><span style="color: #C9D1D9">(body);</span></span>
<span class="line"><span style="color: #C9D1D9">            }</span></span>
<span class="line"><span style="color: #C9D1D9">          }</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #8B949E">// Update edges</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> edge </span><span style="color: #FF7B72">in</span><span style="color: #C9D1D9"> localEdges) {</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> source </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> edge[</span><span style="color: #A5D6FF">'from'</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">??</span><span style="color: #C9D1D9"> edge[</span><span style="color: #A5D6FF">'source'</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">String</span><span style="color: #FF7B72">?</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> target </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> edge[</span><span style="color: #A5D6FF">'to'</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">??</span><span style="color: #C9D1D9"> edge[</span><span style="color: #A5D6FF">'target'</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">String</span><span style="color: #FF7B72">?</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (source </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x26;&#x26;</span><span style="color: #C9D1D9"> target </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> body </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">jsonEncode</span><span style="color: #C9D1D9">(edge);</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">insertEdge</span><span style="color: #C9D1D9">(source, target, body);</span></span>
<span class="line"><span style="color: #C9D1D9">          }</span></span>
<span class="line"><span style="color: #C9D1D9">        }</span></span>
<span class="line"><span style="color: #C9D1D9">      } </span><span style="color: #FF7B72">catch</span><span style="color: #C9D1D9"> (e) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">debugPrint</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Error adding graph data: $</span><span style="color: #79C0FF">e</span><span style="color: #A5D6FF">'</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">      }</span></span>
<span class="line"><span style="color: #C9D1D9">    });</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Future</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">deleteAll</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">transaction</span><span style="color: #C9D1D9">(() </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">try</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">deleteAllEdges</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">deleteAllNodes</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">      } </span><span style="color: #FF7B72">catch</span><span style="color: #C9D1D9"> (e) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #D2A8FF">debugPrint</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Error clearing graph data: $</span><span style="color: #79C0FF">e</span><span style="color: #A5D6FF">'</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">      }</span></span>
<span class="line"><span style="color: #C9D1D9">    });</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Future</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">deleteAllEdges</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">transaction</span><span style="color: #C9D1D9">(() </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getAllEdges</span><span style="color: #C9D1D9">().</span><span style="color: #FF7B72">get</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> edge </span><span style="color: #FF7B72">in</span><span style="color: #C9D1D9"> edges) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">deleteEdge</span><span style="color: #C9D1D9">(edge.source, edge.target);</span></span>
<span class="line"><span style="color: #C9D1D9">      }</span></span>
<span class="line"><span style="color: #C9D1D9">    });</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Future</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">deleteAllNodes</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">transaction</span><span style="color: #C9D1D9">(() </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> nodes </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">getAllNodes</span><span style="color: #C9D1D9">().</span><span style="color: #FF7B72">get</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> node </span><span style="color: #FF7B72">in</span><span style="color: #C9D1D9"> nodes) {</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">deleteNode</span><span style="color: #C9D1D9">(node.id);</span></span>
<span class="line"><span style="color: #C9D1D9">      }</span></span>
<span class="line"><span style="color: #C9D1D9">    });</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span></code></pre>
<p>Create a new file at <strong>build.yaml</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #7EE787">targets</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #7EE787">$default</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">sources</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">      - </span><span style="color: #A5D6FF">lib/**</span></span>
<span class="line"><span style="color: #C9D1D9">      - </span><span style="color: #A5D6FF">web/**</span></span>
<span class="line"><span style="color: #C9D1D9">      - </span><span style="color: #A5D6FF">"tool/**"</span></span>
<span class="line"><span style="color: #C9D1D9">      - </span><span style="color: #A5D6FF">pubspec.yaml</span></span>
<span class="line"><span style="color: #C9D1D9">      - </span><span style="color: #A5D6FF">lib/$lib$</span></span>
<span class="line"><span style="color: #C9D1D9">      - </span><span style="color: #A5D6FF">$package$</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #7EE787">builders</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #7EE787">drift_dev</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #7EE787">options</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #7EE787">sql</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #7EE787">dialect</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">sqlite</span></span>
<span class="line"><span style="color: #C9D1D9">            </span><span style="color: #7EE787">options</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">              </span><span style="color: #7EE787">version</span><span style="color: #C9D1D9">: </span><span style="color: #A5D6FF">"3.38"</span></span>
<span class="line"><span style="color: #C9D1D9">              </span><span style="color: #7EE787">modules</span><span style="color: #C9D1D9">:</span></span>
<span class="line"><span style="color: #C9D1D9">                - </span><span style="color: #A5D6FF">json1</span></span>
<span class="line"><span style="color: #C9D1D9">                - </span><span style="color: #A5D6FF">fts5</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #7EE787">generate_connect_constructor</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">true</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #7EE787">apply_converters_on_variables</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">true</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #7EE787">generate_values_in_copy_with</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">true</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #7EE787">scoped_dart_components</span><span style="color: #C9D1D9">: </span><span style="color: #79C0FF">true</span></span></code></pre>
<p>Now run the following command to generate the database files:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">flutter pub run build_runner build --delete-conflicting-outputs</span></span></code></pre>
<h2 id="-25"><a aria-hidden="true" tabindex="-1" href="#-25"><span class="icon icon-link"></span></a>Connecting to the Database</h2>
<p>Add a new dependency to your <strong>pubspec.yaml</strong> file:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">flutter pub add graphview</span></span></code></pre>
<p>This will be used for the graph visualization.</p>
<p>Create a new file at <strong>lib/main.dart</strong> and update it with the following:</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dart:convert'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:flutter/material.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:flutter_graph_database/flutter_graph_database.dart'</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> db;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'package:graphview/GraphView.dart'</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">main</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">runApp</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">MyApp</span><span style="color: #C9D1D9">());</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">MyApp</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">extends</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">StatelessWidget</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">MyApp</span><span style="color: #C9D1D9">({</span><span style="color: #79C0FF">super</span><span style="color: #C9D1D9">.key});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Widget</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">build</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">BuildContext</span><span style="color: #C9D1D9"> context) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">MaterialApp</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">      title</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'Flutter Graph Database'</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      debugShowCheckedModeBanner</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      theme</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ThemeData</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">dark</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">      home</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Example</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">    );</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Example</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">extends</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">StatefulWidget</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Example</span><span style="color: #C9D1D9">({</span><span style="color: #79C0FF">Key</span><span style="color: #FF7B72">?</span><span style="color: #C9D1D9"> key}) </span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">super</span><span style="color: #C9D1D9">(key</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> key);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">State</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">Example</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">createState</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">_ExampleState</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">_ExampleState</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">extends</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">State</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">Example</span><span style="color: #C9D1D9">> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> database </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> db.</span><span style="color: #79C0FF">GraphDatabase</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Graph</span><span style="color: #C9D1D9"> graph </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Graph</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Algorithm</span><span style="color: #C9D1D9"> builder </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">FruchtermanReingoldAlgorithm</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> nodes </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9">, db.</span><span style="color: #79C0FF">Node</span><span style="color: #FF7B72">></span><span style="color: #C9D1D9">{};</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> loaded </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">initState</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">super</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">initState</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">WidgetsBinding</span><span style="color: #C9D1D9">.instance.</span><span style="color: #D2A8FF">addPostFrameCallback</span><span style="color: #C9D1D9">((_) </span><span style="color: #FF7B72">=></span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">loadData</span><span style="color: #C9D1D9">());</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">reassemble</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">super</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">reassemble</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Needed to reset graph on hot reload</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">loadData</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">setLoadedState</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">bool</span><span style="color: #C9D1D9"> value) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (mounted) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #D2A8FF">setState</span><span style="color: #C9D1D9">(() {</span></span>
<span class="line"><span style="color: #C9D1D9">        loaded </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> value;</span></span>
<span class="line"><span style="color: #C9D1D9">      });</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Future</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">addDummyData</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Load example data</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">try</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #8B949E">// Optionally reset data</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> database.</span><span style="color: #D2A8FF">deleteAll</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #8B949E">// Add example data to database</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> database.</span><span style="color: #D2A8FF">addGraphData</span><span style="color: #C9D1D9">({</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"nodes"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> [</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"id"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'1'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"label"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'circle'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"id"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'2'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"label"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'ellipse'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"id"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'3'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"label"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'database'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"id"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'4'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"label"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'box'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"id"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'5'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"label"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'diamond'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"id"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'6'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"label"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'dot'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"id"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'7'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"label"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'square'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"id"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'8'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"label"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'triangle'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"id"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'9'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"label"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">"star"</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">        ],</span></span>
<span class="line"><span style="color: #C9D1D9">        </span><span style="color: #A5D6FF">"edges"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> [</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'1'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'2'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'2'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'3'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'2'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'4'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'2'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'5'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'5'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'6'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'5'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'7'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'6'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'8'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'2'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'8'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'1'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'8'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'1'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'7'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'1'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'6'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'1'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'5'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'1'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'4'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'1'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'3'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'1'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'9'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'9'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'8'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'9'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'5'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">          {</span><span style="color: #A5D6FF">"from"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'9'</span><span style="color: #C9D1D9">, </span><span style="color: #A5D6FF">"to"</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'3'</span><span style="color: #C9D1D9">},</span></span>
<span class="line"><span style="color: #C9D1D9">        ]</span></span>
<span class="line"><span style="color: #C9D1D9">      });</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #D2A8FF">loadData</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    } </span><span style="color: #FF7B72">catch</span><span style="color: #C9D1D9"> (e) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #D2A8FF">debugPrint</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Error loading example data: $</span><span style="color: #79C0FF">e</span><span style="color: #A5D6FF">'</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Future</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #FF7B72">void</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">loadData</span><span style="color: #C9D1D9">() </span><span style="color: #FF7B72">async</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">setLoadedState</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> nodeMap </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">Node</span><span style="color: #FF7B72">></span><span style="color: #C9D1D9">{};</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.nodes.</span><span style="color: #D2A8FF">clear</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    graph </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Graph</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    builder </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">FruchtermanReingoldAlgorithm</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// Load graph data</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> nodes </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> database.</span><span style="color: #D2A8FF">getAllNodes</span><span style="color: #C9D1D9">().</span><span style="color: #FF7B72">get</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> edges </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">await</span><span style="color: #C9D1D9"> database.</span><span style="color: #D2A8FF">getAllEdges</span><span style="color: #C9D1D9">().</span><span style="color: #FF7B72">get</span><span style="color: #C9D1D9">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> node </span><span style="color: #FF7B72">in</span><span style="color: #C9D1D9"> nodes) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> newNode </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Node</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">Id</span><span style="color: #C9D1D9">(node.id);</span></span>
<span class="line"><span style="color: #C9D1D9">      nodeMap[node.id] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> newNode;</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">.nodes[node.id] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> node;</span></span>
<span class="line"><span style="color: #C9D1D9">      graph.</span><span style="color: #D2A8FF">addNode</span><span style="color: #C9D1D9">(newNode);</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> edge </span><span style="color: #FF7B72">in</span><span style="color: #C9D1D9"> edges) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> source </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> nodeMap[edge.source];</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> target </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> nodeMap[edge.target];</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (source </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x26;&#x26;</span><span style="color: #C9D1D9"> target </span><span style="color: #FF7B72">!=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">null</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">        graph.</span><span style="color: #D2A8FF">addEdge</span><span style="color: #C9D1D9">(source, target);</span></span>
<span class="line"><span style="color: #C9D1D9">      }</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">setLoadedState</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Widget</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">buildNode</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Node</span><span style="color: #C9D1D9"> node) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> dbNode </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> nodes[node.key</span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">.value];</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> data </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">jsonDecode</span><span style="color: #C9D1D9">(dbNode</span><span style="color: #FF7B72">?</span><span style="color: #C9D1D9">.body </span><span style="color: #FF7B72">??</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">'{}'</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">as</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Map</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #79C0FF">String</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">dynamic</span><span style="color: #C9D1D9">>;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">final</span><span style="color: #C9D1D9"> label </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> data[</span><span style="color: #A5D6FF">'label'</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">??</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">''</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">SizedBox</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">      width</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">80</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      height</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">80</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">      child</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Center</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        child</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Text</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">          label,</span></span>
<span class="line"><span style="color: #C9D1D9">          textAlign</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">TextAlign</span><span style="color: #C9D1D9">.center,</span></span>
<span class="line"><span style="color: #C9D1D9">        ),</span></span>
<span class="line"><span style="color: #C9D1D9">      ),</span></span>
<span class="line"><span style="color: #C9D1D9">    );</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">@override</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #79C0FF">Widget</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">build</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">BuildContext</span><span style="color: #C9D1D9"> context) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Scaffold</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">      appBar</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">AppBar</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">        title</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Text</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'Flutter Graph Database'</span><span style="color: #C9D1D9">),</span></span>
<span class="line"><span style="color: #C9D1D9">        actions</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> [</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #79C0FF">IconButton</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">            icon</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Icon</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Icons</span><span style="color: #C9D1D9">.restore),</span></span>
<span class="line"><span style="color: #C9D1D9">            onPressed</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> addDummyData,</span></span>
<span class="line"><span style="color: #C9D1D9">          ),</span></span>
<span class="line"><span style="color: #C9D1D9">        ],</span></span>
<span class="line"><span style="color: #C9D1D9">      ),</span></span>
<span class="line"><span style="color: #C9D1D9">      body</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">!</span><span style="color: #C9D1D9">loaded</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #FF7B72">?</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Center</span><span style="color: #C9D1D9">(child</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">CircularProgressIndicator</span><span style="color: #C9D1D9">())</span></span>
<span class="line"><span style="color: #C9D1D9">          </span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> nodes.isEmpty</span></span>
<span class="line"><span style="color: #C9D1D9">              </span><span style="color: #FF7B72">?</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Center</span><span style="color: #C9D1D9">(child</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Text</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">'No Data Loaded'</span><span style="color: #C9D1D9">))</span></span>
<span class="line"><span style="color: #C9D1D9">              </span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">LayoutBuilder</span><span style="color: #C9D1D9">(builder</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> (context, dimens) {</span></span>
<span class="line"><span style="color: #C9D1D9">                  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">SizedBox</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">expand</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">                    child</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">InteractiveViewer</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">                      constrained</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">                      boundaryMargin</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">EdgeInsets</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">symmetric</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">                        horizontal</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> dimens.maxWidth </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0.75</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">                        vertical</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> dimens.maxHeight </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0.75</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">                      ),</span></span>
<span class="line"><span style="color: #C9D1D9">                      minScale</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0.01</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">                      maxScale</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">5.6</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">                      child</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">GraphView</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">                        key</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">UniqueKey</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">                        graph</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> graph,</span></span>
<span class="line"><span style="color: #C9D1D9">                        algorithm</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> builder,</span></span>
<span class="line"><span style="color: #C9D1D9">                        paint</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Paint</span><span style="color: #C9D1D9">()</span></span>
<span class="line"><span style="color: #C9D1D9">                          ..color </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Colors</span><span style="color: #C9D1D9">.green</span></span>
<span class="line"><span style="color: #C9D1D9">                          ..strokeWidth </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span></span>
<span class="line"><span style="color: #C9D1D9">                          ..style </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">PaintingStyle</span><span style="color: #C9D1D9">.stroke,</span></span>
<span class="line"><span style="color: #C9D1D9">                        builder</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> buildNode,</span></span>
<span class="line"><span style="color: #C9D1D9">                      ),</span></span>
<span class="line"><span style="color: #C9D1D9">                    ),</span></span>
<span class="line"><span style="color: #C9D1D9">                  );</span></span>
<span class="line"><span style="color: #C9D1D9">                }),</span></span>
<span class="line"><span style="color: #C9D1D9">    );</span></span>
<span class="line"><span style="color: #C9D1D9">  }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>When you run the flutter app you should see the following:</p>
<p><img src="/img/graph-db/thumbnail.png" alt="Preview"></p>
<h2 id="-26"><a aria-hidden="true" tabindex="-1" href="#-26"><span class="icon icon-link"></span></a>Conclusion</h2>
<p>If you want to learn more about building a graph database in Flutter, check out the <a href="https://github.com/rodydavis/flutter_graph_database">source code</a>.</p>
    </article>
    <aside class="astro-BVZIHDZO">
      <nav class="astro-XVRFUPWN">
  <h2 class="astro-XVRFUPWN">Table of Contents</h2>
  <ul class="astro-XVRFUPWN">
    <li class="astro-XVRFUPWN">
          <a href="#" class="heading-depth-2 astro-XVRFUPWN">
            Prerequisites
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-1" class="heading-depth-2 astro-XVRFUPWN">
            Overview
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-2" class="heading-depth-2 astro-XVRFUPWN">
            Getting Started
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-3" class="heading-depth-2 astro-XVRFUPWN">
            Creating the Database
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-4" class="heading-depth-3 astro-XVRFUPWN">
            Database Connection
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-5" class="heading-depth-3 astro-XVRFUPWN">
            Database SQL Files
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-6" class="heading-depth-4 astro-XVRFUPWN">
            Schema
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-7" class="heading-depth-4 astro-XVRFUPWN">
            Queries
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-8" class="heading-depth-4 astro-XVRFUPWN">
            Delete Edge
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-9" class="heading-depth-4 astro-XVRFUPWN">
            Delete Node
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-10" class="heading-depth-4 astro-XVRFUPWN">
            Insert Edge
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-11" class="heading-depth-4 astro-XVRFUPWN">
            Insert Node
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-12" class="heading-depth-4 astro-XVRFUPWN">
            Search Edges Inbound
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-13" class="heading-depth-4 astro-XVRFUPWN">
            Search Edges Outbound
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-14" class="heading-depth-4 astro-XVRFUPWN">
            Search Edges
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-15" class="heading-depth-4 astro-XVRFUPWN">
            Search Node By ID
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-16" class="heading-depth-4 astro-XVRFUPWN">
            Search Node
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-17" class="heading-depth-4 astro-XVRFUPWN">
            Traverse Inbound
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-18" class="heading-depth-4 astro-XVRFUPWN">
            Traverse Outbound
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-19" class="heading-depth-4 astro-XVRFUPWN">
            Traverse Bodies Inbound
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-20" class="heading-depth-4 astro-XVRFUPWN">
            Traverse Bodies Outbound
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-21" class="heading-depth-4 astro-XVRFUPWN">
            Traverse Bodies
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-22" class="heading-depth-4 astro-XVRFUPWN">
            Traverse
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-23" class="heading-depth-4 astro-XVRFUPWN">
            Update Node
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-24" class="heading-depth-3 astro-XVRFUPWN">
            Database Setup
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-25" class="heading-depth-2 astro-XVRFUPWN">
            Connecting to the Database
          </a>
        </li><li class="astro-XVRFUPWN">
          <a href="#-26" class="heading-depth-2 astro-XVRFUPWN">
            Conclusion
          </a>
        </li>
  </ul>
</nav>
    </aside>
  </main>
    </main>
    <footer class="astro-SZ7XMLTE">
  <div class="links astro-AUSHCPD5">
  <a class="social-icon astro-AUSHCPD5" href="https://github.com/rodydavis" target="_blank" rel="noopener">
            <img src="/social/github.svg" alt="github" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://twitter.com/rodydavis" target="_blank" rel="noopener">
            <img src="/social/twitter.svg" alt="twitter" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://facebook.com/rodydavisjr" target="_blank" rel="noopener">
            <img src="/social/facebook.svg" alt="facebook" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://instagram.com/rodydavisjr" target="_blank" rel="noopener">
            <img src="/social/instagram.svg" alt="instagram" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://youtube.com/rodydavis" target="_blank" rel="noopener">
            <img src="/social/youtube.svg" alt="youtube" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://tiktok.com/@rodydavisjr" target="_blank" rel="noopener">
            <img src="/social/tiktok.svg" alt="tiktok" class="astro-AUSHCPD5">
          </a><a class="social-icon astro-AUSHCPD5" href="https://linkedin.com/in/rodydavis" target="_blank" rel="noopener">
            <img src="/social/linkedin.svg" alt="linkedin" class="astro-AUSHCPD5">
          </a>
</div>

  <div class="copyright astro-SZ7XMLTE">
    &copy; 2023
    Rody Davis. All rights reserved.
  </div>
</footer>
  </body></html>