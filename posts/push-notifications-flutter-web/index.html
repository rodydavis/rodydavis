<!DOCTYPE html><html domain=rodydavis.com ga-id=G-JQNPVBL9DR lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href="/img/favicon/favicon-32x32.png?hash=3df5885280" rel=icon type=image/png><meta content=#f9c412 name=theme-color><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name=robots><title>How To Send Push Notifications on Flutter Web (FCM)</title><meta content="How To Send Push Notifications on Flutter Web (FCM)" property=og:title><meta content="If you are using Firebase then you are probably familiar with Firebase Cloud Messaging. The setup on Flutter web is very different than..." name=description><meta content="If you are using Firebase then you are probably familiar with Firebase Cloud Messaging. The setup on Flutter web is very different than..." property=og:description><meta content=summary_large_image name=twitter:card><meta content=@rodydavis name=twitter:site><meta content=@rodydavis name=twitter:creator><meta content=https://rodydavis.com/img/remote/Z1D401D.jpeg property=og:image><link href=https://rodydavis.com/posts/push-notifications-flutter-web/ rel=canonical><meta content=no-referrer-when-downgrade name=referrer><link href=/feed/feed.xml rel=alternate type=application/atom+xml title="Rody Davis"><link href=/ rel=preconnect crossorigin=""><script src="/js/min.js?hash=c372ec6a84" async defer></script><script src="/js/cached.js?hash=9030142fbb" async defer></script><script csp-hash="">if (/Mac OS X/.test(navigator.userAgent)) 
        document
          .documentElement
          .classList
          .add('apple')</script><script type=text/javascript>function getCode(repo, path, branch) {
        const url = `https://raw.githubusercontent.com/rodydavis/${repo}/${branch}/${path}`;
        return fetch(url).then((res) => res.text());
      }
      async function addFiles(tag, path, branch = "main") {
          const ide = document.querySelector('playground-ide');
          const ui = await getCode(tag, 'index.html', branch);
          const code = await getCode(tag, `src/${path}`, branch);
          const name = path.split('.ts').join('.js');
          const config = { files: {} };
          config.files['index.html'] = { content:  ui.split(`/src/${path}`).join(`./${name}`) };
          config.files[path] = { content: code };
          ide.config = config;
          ide.id = 'playground';
          ide.className = 'playground-theme-tomorrow-night-eighties'
      }</script><script src=https://unpkg.com/playground-elements@0.10.0/playground-ide.js?module type=module></script><style>playground-ide {
        height: 500px;
        width: 100%;
        --playground-preview-width: 40%;
        --playground-code-background: var(--background);
        --playground-tab-bar-background: var(--background);
        --playground-tab-bar-foreground-color: var(--on-background);
        --playground-border: var(--on-background);
        --playground-preview-toolbar-background: var(--background);
        --playground-preview-toolbar-foreground-color: var(--on-background);
        --playground-highlight-color: var(--primary);
        --playground-code-default-color: var(--primary);
        --playground-code-font-family: var(--default-font);
      }</style><style>@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css);@import url(https://unpkg.com/playground-elements@0.10.0/themes/tomorrow-night-eighties.css);:root{--primary: #f9c412;--on-primary: #181818;--secondary: #e7bf60;--background: #181818;--on-background: #eee}.tags{display:wrap}.click{cursor:pointer;text-decoration:none}.chip{display:inline-block;padding:0 15px;border-radius:25px;margin:4px;background-color:var(--primary);color:var(--on-primary)}main img{content-visibility:auto}article *{scroll-margin-top:50px}header nav{z-index:1;position:fixed;top:0;left:0;width:100vw;padding:.375em 1.5em;background:rgba(255,255,255,.9);font-weight:200;text-align:right}:root{--main-width: calc(100vw - 3em)}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}dialog,share-widget{position:fixed;opacity:.9}share-widget{right:20px;bottom:20px}share-widget div{width:30px;height:30px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center}.apple share-widget div{background-image:url(/img/share-apple.svg)}body,share-widget button{margin:0}share-widget button:active{transform:scale(1.2)}dialog{background-color:#8dff80;z-index:1000}header aside{font-style:italic}#nav{z-index:2;position:relative}#reading-progress{z-index:1;background-color:var(--primary);width:100vw;position:absolute;left:0;top:0;bottom:0;transform:translate(-100vw,0);will-change:transform;pointer-events:none}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:100;src:url(/fonts/Inter-Thin.woff2) format("woff2"),url(/fonts/Inter-Thin.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:100;src:url(/fonts/Inter-ThinItalic.woff2) format("woff2"),url(/fonts/Inter-ThinItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:200;src:url(/fonts/Inter-ExtraLight.woff2) format("woff2"),url(/fonts/Inter-ExtraLight.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:200;src:url(/fonts/Inter-ExtraLightItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraLightItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:300;src:url(/fonts/Inter-Light.woff2) format("woff2"),url(/fonts/Inter-Light.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:300;src:url(/fonts/Inter-LightItalic.woff2) format("woff2"),url(/fonts/Inter-LightItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:400;src:url(/fonts/Inter-Regular.woff2) format("woff2"),url(/fonts/Inter-Regular.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:400;src:url(/fonts/Inter-Italic.woff2) format("woff2"),url(/fonts/Inter-Italic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:500;src:url(/fonts/Inter-Medium.woff2) format("woff2"),url(/fonts/Inter-Medium.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:500;src:url(/fonts/Inter-MediumItalic.woff2) format("woff2"),url(/fonts/Inter-MediumItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:600;src:url(/fonts/Inter-SemiBold.woff2) format("woff2"),url(/fonts/Inter-SemiBold.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:600;src:url(/fonts/Inter-SemiBoldItalic.woff2) format("woff2"),url(/fonts/Inter-SemiBoldItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:700;src:url(/fonts/Inter-Bold.woff2) format("woff2"),url(/fonts/Inter-Bold.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:700;src:url(/fonts/Inter-BoldItalic.woff2) format("woff2"),url(/fonts/Inter-BoldItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:800;src:url(/fonts/Inter-ExtraBold.woff2) format("woff2"),url(/fonts/Inter-ExtraBold.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:800;src:url(/fonts/Inter-ExtraBoldItalic.woff2) format("woff2"),url(/fonts/Inter-ExtraBoldItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:normal;font-weight:900;src:url(/fonts/Inter-Black.woff2) format("woff2"),url(/fonts/Inter-Black.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI";font-style:italic;font-weight:900;src:url(/fonts/Inter-BlackItalic.woff2) format("woff2"),url(/fonts/Inter-BlackItalic.woff) format("woff")}@font-face{font-display:optional;font-family:"Inter UI var alt";font-weight:100 900;font-style:normal;font-named-instance:"Regular";src:url(/fonts/Inter-roman.var.woff2) format("woff2")}@font-face{font-display:optional;font-family:"Inter UI var alt";font-weight:100 900;font-style:italic;font-named-instance:"Italic";src:url(/fonts/Inter-italic.var.woff2) format("woff2")}button,html{line-height:1.15}html{-webkit-text-size-adjust:100%;font-family:Inter UI,sans-serif;--font-family: Inter UI, sans-serif}h1{font-size:3em;line-height:1.25;margin:.67em 0 .5em;font-size:2.074rem}a{background-color:transparent;color:#f9c412;text-decoration:none;color:var(--primary)}b{font-weight:700}img{border-style:none;max-width:100%;height:auto;margin:0 auto}button{font-family:inherit;font-size:100%;overflow:visible;text-transform:none}[type=button],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}h2{font-size:2.5em;line-height:1.2;margin-bottom:.6em}body,p,pre,ul{font-size:1em}p,pre,ul{margin-bottom:1.5em}h1,h2{line-height:2.4rem;margin-bottom:1.36rem}h2{font-size:1.728rem}body,p,pre,ul{font-size:1rem;line-height:1.6}p,pre,ul{margin-bottom:1.36rem}@media (min-width:600px){h1{font-size:4.3978rem;line-height:4.4rem}h2{font-size:3.1097rem;line-height:3.52rem}body,p,pre,ul{font-size:1.1rem;line-height:1.6}h1,h2,p,pre,ul{margin-bottom:1.496rem}}@media (min-width:1200px){h1{font-size:6.0756rem;line-height:6.72rem}h2{font-size:4.05rem;line-height:4.8rem}body,p,pre,ul{font-size:1.2rem;line-height:1.6}h1,h2,p,pre,ul{margin-bottom:1.632rem}}code,pre{overflow-x:auto}pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace}pre code:not([class]){padding:1.5em;overflow-x:scroll}button,code{border-radius:.3em}code{color:#e2777a;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:90%;background:#2d2d2d;padding:0}h1,h2{font-family:var(--font-family)}h2{font-style:italic}a:hover{text-decoration:underline}dt{font-weight:600;padding-top:.75em;padding-left:.75em}@supports (font-variation-settings:normal){html{font-family:Inter UI var alt,sans-serif;--font-family: Inter UI var alt, sans-serif}}button{max-width:100%;background:#f2f2f2;color:#191919;cursor:pointer;display:inline-block;padding:.75em 1.5em;text-align:center;margin:0 .75em 1.5em 0}button:hover{background:#d9d9d9;color:var(--surface)}button:not([disabled]){background:#f9c412;color:#181818;background:var(--primary)}button:not([disabled]):hover{background:#ba9005;color:#000;background:var(--secondary)}*{border:0;box-sizing:border-box}body,header nav a{font-family:var(--font-family)}body{background:var(--background);color:var(--on-background)}header{padding:4.5em 1.5em 3em;width:37.5em;margin:0 auto;text-align:center;max-width:100%;display:flex;align-items:center;flex-direction:column}header p,ul{margin-top:0}header nav h1{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav a{font-weight:700;text-decoration:none;color:#181818;margin-left:1.5em}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}main{max-width:70rem;margin:0 auto;border-top:.5px solid #ccc}footer{background:var(--background);color:var(--on-background);text-align:center;padding:2em 2em 100px}footer>*{margin:.6em}footer nav a img{vertical-align:middle}footer nav,footer p{font-size:90%}article{max-width:100%;padding:1.5em;width:37.5em;margin:0 auto}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;background:#2d2d2d}.token.comment{color:#999}.token.punctuation{color:#ccc}.token.tag{color:#e2777a}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.property{color:#f8c555}.token.important,.token.keyword{color:#cc99cd}.token.string{color:#7ec699}.token.operator,.token.url{color:#67cdcc}.token.important{font-weight:700}.token.inserted{color:green}</style><header><nav><div id=nav><h1><a href=/ title=Homepage>Rody Davis</a></h1><a href=/about/ >About</a> <a href=/talks/ >Talks</a> <a href=/apps/ >Apps</a></div><div id=reading-progress aria-hidden=true></div></nav><h1>How To Send Push Notifications on Flutter Web (FCM)</h1><aside>3 min read.</aside><dialog id=message></dialog><noscript><img src="/.netlify/functions/ga?v=1&_v=j83&t=pageview&dr=https%3A%2F%2Fno-script.com&_s=1&dh=rodydavis.com&dp=%2Fposts%2Fpush-notifications-flutter-web%2F&ul=en-us&de=UTF-8&dt=How%20To%20Send%20Push%20Notifications%20on%20Flutter%20Web%20(FCM)&tid=G-JQNPVBL9DR" style=display:none width=1 alt="" height=1></noscript></header><main><article><div class=tags><a href=/tags/flutter class=click><div class=chip>flutter</div></a><a href=/tags/web class=click><div class=chip>web</div></a></div><p>If you are using Firebase then you are probably familiar with Firebase Cloud Messaging. The setup on Flutter web is very different than mobile and other plugins you are probably used to.</p><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/firebase/banner-1920w.avif 1920w, /img/firebase/banner-1280w.avif 1280w, /img/firebase/banner-640w.avif 640w, /img/firebase/banner-320w.avif 320w" type=image/avif><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/firebase/banner-1920w.webp 1920w, /img/firebase/banner-1280w.webp 1280w, /img/firebase/banner-640w.webp 640w, /img/firebase/banner-320w.webp 320w" type=image/webp><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/firebase/banner-1920w.jpg 1920w, /img/firebase/banner-1280w.jpg 1280w, /img/firebase/banner-640w.jpg 640w, /img/firebase/banner-320w.jpg 320w" type=image/jpeg><img src=/img/firebase/banner-1920w.jpg style="background-size:cover;background-image:url(&#34;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 800 400'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' preserveAspectRatio='none' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAFCAIAAAAcxIEBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAn0lEQVQI12Ngnv2UafYzhtmvgSTjrKcss58yz3nKOucpy5ynQCkgYmCc/Zxv9h3T2bs45z4RXAhVxDDzCRAxzQKrYJj91nD2nm9b5KI2brPd/DVu35vofe/8dr6J2/9OcfkLkFKGWS9E514v39ivsugc+9xXskufyy59Ib/sBVCae94zoDEMzLOfMM1+zjDjPeOsF4yzgIZDrWCYAbUFALUKV0KEf8UiAAAAAElFTkSuQmCC'%3E%3C/image%3E%3C/svg%3E&#34;)" width=100% decoding=async loading=lazy></picture><h2 id=setting-up>Setting Up <a href=#setting-up class=direct-link>#</a></h2><p>Open your web/index.html and look for the following script. If you do not have one you can add it now in the tag.<pre class=language-js><code class=language-js><span class="token operator">&lt;</span>script<span class="token operator">></span><br><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"serviceWorker"</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"load"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">"/flutter_service_worker.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>We need to modify it to support the FCM service worker. The important thing we need to do is comment out the flutter_service_worker.js so that we will not get 404 errors when registering the FCM service worker.<pre class=language-js><code class=language-js><span class="token operator">&lt;</span>script<span class="token operator">></span><br><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"serviceWorker"</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"load"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// navigator.serviceWorker.register("/flutter_service_worker.js");</span><br>    navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">"/firebase-messaging-sw.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>Now create a new file called firebase-messaging-sw.js in the web folder with the following contents:<pre class=language-js><code class=language-js><span class="token function">importScripts</span><span class="token punctuation">(</span><span class="token string">"https://www.gstatic.com/firebasejs/7.5.0/firebase-app.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">importScripts</span><span class="token punctuation">(</span><span class="token string">"https://www.gstatic.com/firebasejs/7.5.0/firebase-messaging.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>firebase<span class="token punctuation">.</span><span class="token function">initializeApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>    apiKey<span class="token operator">:</span> <span class="token string">"API_KEY"</span><span class="token punctuation">,</span><br>    authDomain<span class="token operator">:</span> <span class="token string">"AUTH_DOMAIN"</span><span class="token punctuation">,</span><br>    databaseURL<span class="token operator">:</span> <span class="token string">"DATABASE_URL"</span><span class="token punctuation">,</span><br>    projectId<span class="token operator">:</span> <span class="token string">"PROJECT_ID"</span><span class="token punctuation">,</span><br>    storageBucket<span class="token operator">:</span> <span class="token string">"STORAGE_BUCKET"</span><span class="token punctuation">,</span><br>    messagingSenderId<span class="token operator">:</span> <span class="token string">"MESSAGING_SENDER_ID"</span><span class="token punctuation">,</span><br>    appId<span class="token operator">:</span> <span class="token string">"APP_ID"</span><span class="token punctuation">,</span><br>    measurementId<span class="token operator">:</span> <span class="token string">"MEASUREMENT_ID"</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> messaging <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">messaging</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>messaging<span class="token punctuation">.</span><span class="token function">setBackgroundMessageHandler</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> promiseChain <span class="token operator">=</span> clients<br>        <span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>            type<span class="token operator">:</span> <span class="token string">"window"</span><span class="token punctuation">,</span><br>            includeUncontrolled<span class="token operator">:</span> <span class="token boolean">true</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">windowClients</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> windowClients<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token keyword">const</span> windowClient <span class="token operator">=</span> windowClients<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><br>                windowClient<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>            <span class="token keyword">return</span> registration<span class="token punctuation">.</span><span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token string">"New Message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> promiseChain<span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'notificationclick'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'notification received: '</span><span class="token punctuation">,</span> event<span class="token punctuation">)</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Make sure to replace the config keys with your firebase keys.<h2 id=helper-methods>Helper Methods <a href=#helper-methods class=direct-link>#</a></h2><p>Create a new dart file wherever you like named firebase_messaging.dart with the following:<pre class=language-dart><code class=language-dart><span class="token keyword">import</span> <span class="token string">'dart:async'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token string">'package:firebase/firebase.dart'</span> <span class="token operator">as</span> firebase<span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">FBMessaging</span> <span class="token punctuation">{</span><br>  FBMessaging<span class="token punctuation">.</span><span class="token function">_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">static</span> FBMessaging _instance <span class="token operator">=</span> FBMessaging<span class="token punctuation">.</span><span class="token function">_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">static</span> FBMessaging <span class="token keyword">get</span> instance <span class="token operator">=</span><span class="token operator">></span> _instance<span class="token punctuation">;</span><br>  firebase<span class="token punctuation">.</span>Messaging _mc<span class="token punctuation">;</span><br>  String _token<span class="token punctuation">;</span><br><br>  <span class="token keyword">final</span> _controller <span class="token operator">=</span> StreamController<span class="token operator">&lt;</span>Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token operator">>></span><span class="token punctuation">.</span><span class="token function">broadcast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  Stream<span class="token operator">&lt;</span>Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token operator">>></span> <span class="token keyword">get</span> stream <span class="token operator">=</span><span class="token operator">></span> _controller<span class="token punctuation">.</span>stream<span class="token punctuation">;</span><br><br>  <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    _controller<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  Future<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span><br>    _mc <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token function">messaging</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    _mc<span class="token punctuation">.</span><span class="token function">usePublicVapidKey</span><span class="token punctuation">(</span><span class="token string">'FCM_SERVER_KEY'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    _mc<span class="token punctuation">.</span>onMessage<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      _controller<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>event<span class="token operator">?</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  Future <span class="token function">requestPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> _mc<span class="token punctuation">.</span><span class="token function">requestPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  Future<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">[</span>bool force <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>force <span class="token operator">||</span> _token <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">await</span> <span class="token function">requestPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      _token <span class="token operator">=</span> <span class="token keyword">await</span> _mc<span class="token punctuation">.</span><span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">return</span> _token<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>Create a button in the app that will be used to request permissions. While it is possible to request for permission when the app launches this is usually bad practice as the user is unlikely to accept and there is no trust built yet. You can request permissions with the following:<pre class=language-dart><code class=language-dart><span class="token keyword">final</span> _messaging <span class="token operator">=</span> FBMessaging<span class="token punctuation">.</span>instance<span class="token punctuation">;</span><br>_messaging<span class="token punctuation">.</span><span class="token function">requestPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span><br>  <span class="token keyword">final</span> _token <span class="token operator">=</span> <span class="token keyword">await</span> _messaging<span class="token punctuation">.</span><span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'Token: $_token'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>You can listen to messages with the following:<pre class=language-dart><code class=language-dart><span class="token keyword">final</span> _messaging <span class="token operator">=</span> FBMessaging<span class="token punctuation">.</span>instance<span class="token punctuation">;</span><br>_messaging<span class="token punctuation">.</span>stream<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'New Message: ${event}'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id=testing>Testing <a href=#testing class=direct-link>#</a></h2><p>Now when you run your application and request permissions you will get a token back. With this token you can open the firebase console and sent a test message to the token.</p><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/firebase/notification-1920w.avif 1920w, /img/firebase/notification-1280w.avif 1280w, /img/firebase/notification-640w.avif 640w, /img/firebase/notification-320w.avif 320w" type=image/avif><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/firebase/notification-1920w.webp 1920w, /img/firebase/notification-1280w.webp 1280w, /img/firebase/notification-640w.webp 640w, /img/firebase/notification-320w.webp 320w" type=image/webp><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/firebase/notification-1920w.jpg 1920w, /img/firebase/notification-1280w.jpg 1280w, /img/firebase/notification-640w.jpg 640w, /img/firebase/notification-320w.jpg 320w" type=image/jpeg><img src=/img/firebase/notification-1920w.jpg style="background-size:cover;background-image:url(&#34;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 700 185'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' preserveAspectRatio='none' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAECAYAAABREWWJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAq0lEQVQI12OwtLASVFNSDdLSNQ5xcnIM1tHRCdHW1g4xMjIKMTU1xYaDgTjC2NhYkUFZR8stKSL4f3qU///A4ND/7u7u/z09Pf/b2tr+NzMz+29hYfHf3NwcAwMNqGBQ19J2DYoN/J8Q7fPf3z/wv4eHOxB74NP8F6q5jMHawpJPQVrRQ0lNz8vGxtpTQ0PTU1NT09PAwMDTxMTEE+g8FAz0jgeQ9jU0NJQBAC/fSzMXsmNAAAAAAElFTkSuQmCC'%3E%3C/image%3E%3C/svg%3E&#34;)" width=100% decoding=async loading=lazy></picture><h2 id=conclusion>Conclusion <a href=#conclusion class=direct-link>#</a></h2><p>Now you can send push notifications to Flutter apps! You still need to use conditional imports to support the mobile side as well but stay tuned for an example with that. Let me know your questions and any feedback you may have.<h1>üôèüôèüôè</h1><p>Since you've made it this far, <a href=https://rodydavis.com/posts/push-notifications-flutter-web/ on-click=share>sharing</a> this article on your favorite social media network would be highly appreciated üíñ! For feedback, please <a href=https://twitter.com/rodydavis rel=noopener target=_blank>ping me on Twitter.</a></p><share-widget><button aria-label=Share href=https://rodydavis.com/posts/push-notifications-flutter-web/ on-click=share><div></div></button></share-widget><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","headline":"How To Send Push Notifications on Flutter Web (FCM)","image":["https://rodydavis.com/img/firebase/banner-1920w.jpg","https://rodydavis.com/img/firebase/notification-1920w.jpg"],"author":"Rody Davis","genre":"https://schema.org/Code","publisher":{"@type":"Organization","name":"Rody Davis","logo":{"@type":"ImageObject","url":"/img/favicon/favicon-32x32.png?hash=3df5885280"}},"url":"https://rodydavis.com/posts/push-notifications-flutter-web/","mainEntityOfPage":"https://rodydavis.com/posts/push-notifications-flutter-web/","datePublished":"2020-05-01","dateModified":"2021-07-08","description":"If you are using Firebase then you are probably familiar with Firebase Cloud Messaging. The setup on Flutter web is very different than..."}</script><p>Published <time datetime=2020-05-01>01 May 2020</time></article></main><footer><a href=https://twitter.com/rodydavis class="fab fa-twitter" rel="noopener noreferrer" target=_blank></a> <a href=https://facebook.com/rodydavisjr class="fab fa-facebook" rel="noopener noreferrer" target=_blank></a> <a href=https://www.linkedin.com/in/rodydavis class="fab fa-linkedin" rel="noopener noreferrer" target=_blank></a> <a href=https://www.youtube.com/rodydavis class="fab fa-youtube" rel="noopener noreferrer" target=_blank></a> <a href=https://www.instagram.com/rodydavisjr class="fab fa-instagram" rel="noopener noreferrer" target=_blank></a> <a href=https://www.github.com/rodydavis class="fab fa-github" rel="noopener noreferrer" target=_blank></a> <a href=https://www.tiktok.com/@rodydavisjr class="fab fa-tiktok" rel="noopener noreferrer" target=_blank></a></footer><script src="https://www.googletagmanager.com/gtag/js?id=G-JQNPVBL9DR" async></script><script>window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'G-JQNPVBL9DR');</script>