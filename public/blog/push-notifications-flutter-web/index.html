
  <!DOCTYPE html>
  <html lang="en">
    <head>
      <base href="/">
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>How To Send Push Notifications on Flutter Web (FCM)</title>
      <link rel="stylesheet" type="text/css" href="/index.css" />
      <link rel="stylesheet" type="text/css" href="/article.css" />
      <link
        href="https://fonts.googleapis.com/css?family=Material+Icons&display=block"
        rel="stylesheet"
      />
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/default.min.css">
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
    </head>
    <body>
      <nav-wrapper title="How To Send Push Notifications on Flutter Web (FCM)">
        <article>
         <h2 id="how-to-send-push-notifications-on-flutter-web-fcm">How To Send Push Notifications on Flutter Web (FCM)</h2>
<p>If you are using Firebase then you are probably familiar with Firebase Cloud Messaging. The setup on Flutter web is very different than mobile and other plugins you are probably used to.</p>
<p><img src="https://cdn-images-1.medium.com/max/3200/1*B0Av_NnFrCKsyC7gN94ytg.png" alt="" /></p>
<h3 id="setting-up">Setting Up</h3>
<p>Open your web/index.html and look for the following script. If you do not have one you can add it now in the <body> tag.</p>
<pre><code>&lt;script&gt;
if ("serviceWorker" in navigator) {
  window.addEventListener("load", function () {
    navigator.serviceWorker.register("/flutter_service_worker.js");
  });
}
&lt;/script&gt;</code></pre>
<p>We need to modify it to support the FCM service worker. The important thing we need to do is comment out the flutter_service_worker.js so that we will not get 404 errors when registering the FCM service worker.</p>
<pre><code>&lt;script&gt;
if ("serviceWorker" in navigator) {
  window.addEventListener("load", function () {
    // navigator.serviceWorker.register("/flutter_service_worker.js");
    navigator.serviceWorker.register("/firebase-messaging-sw.js");
  });
}
&lt;/script&gt;</code></pre>
<p>Now create a new file called firebase-messaging-sw.js in the web folder with the following contents:</p>
<iframe src="https://medium.com/media/455c7a3a979544d73c10a03369d054b4" frameborder=0></iframe>
<p>Make sure to replace the config keys with your firebase keys.</p>
<h3 id="helper-methods">Helper Methods</h3>
<p>Create a new dart file wherever you like named firebase_messaging.dart with the following:</p>
<iframe src="https://medium.com/media/cc60e06d906b5b5d7be89e9479fa37e7" frameborder=0></iframe>
<p>Create a button in the app that will be used to request permissions. While it is possible to request for permission when the app launches this is usually bad practice as the user is unlikely to accept and there is no trust built yet. You can request permissions with the following:</p>
<pre><code>final _messaging = FBMessaging.instance;

_messaging.requestPermission().then((_) async {

final _token = await _messaging.getToken();

print('Token: $_token');

});</code></pre>
<p>You can listen to messages with the following:</p>
<pre><code>final _messaging = FBMessaging.instance;

_messaging.stream.listen((event) {

print('New Message: ${event}');

});</code></pre>
<h3 id="testing">Testing</h3>
<p>Now when you run your application and request permissions you will get a token back. With this token you can open the firebase console and sent a test message to the token.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*ZzoPP7kRHOR-yDN6Sv9XjQ.png" alt="" /></p>
<h3 id="conclusion">Conclusion</h3>
<p>Now you can send push notifications to Flutter apps! You still need to use conditional imports to support the mobile side as well but stay tuned for an example with that. Let me know your questions and any feedback you may have.</p>
        </article>
      </nav-wrapper>
      <noscript>You need to enable JavaScript to run this app.</noscript>
      <script type="module" src="/dist/components/nav-wrapper.js"></script>
      <script>hljs.initHighlightingOnLoad();</script>
  
  <script
    src="https://utteranc.es/client.js"
    repo="rodydavis/rodydavis"
    issue-term="pathname"
    theme="github-light"
    crossorigin="anonymous"
    async
  ></script>
  
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-analytics.js"></script>
    <script>
      // window.addEventListener('load', () => {
      //   navigator.serviceWorker.register('/sw.js');
      // });

      const firebaseConfig = {
        apiKey: 'AIzaSyCfbxrJWY2QgbSJrCnS3jZ8mfBwvQrqII0',
        authDomain: 'development-267918.firebaseapp.com',
        databaseURL: 'https://development-267918.firebaseio.com',
        projectId: 'development-267918',
        storageBucket: 'development-267918.appspot.com',
        messagingSenderId: '700791912456',
        appId: '1:700791912456:web:0b4947c995cec6c38bb9bd',
        measurementId: 'G-JQNPVBL9DR',
      };
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();
    </script>
    
    </body>
  </html>